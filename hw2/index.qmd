---
title: "Assignment 2: Halve Money"
author: "Hubert Baechli"
---

my first attempt at an agent model with the information from the lesson

```{r}
HalveMoney <- function(nAgent,maxExchange,Money_mean=1000,Money_sd=300) {
  df <- data.frame(ID=seq(1,nAgent),nE=0,M=rnorm(nAgent, mean = Money_mean, sd = Money_sd))
  iE <- 1
  hist(df$M, main="Start",xlab="Money", col="steelblue", xlim=c(0,Money_mean+4*Money_sd), ylim=c(0,Money_mean/4))
  while (iE <= maxExchange) {
    rdf <- sample(df[df$nE < iE,"ID"], size=2)
    df[(df$ID == rdf[1] | df$ID == rdf[2]),"nE"] <- df[(df$ID == rdf[1] | df$ID == rdf[2]),"nE"]+1
    df[(df$ID == rdf[1] | df$ID == rdf[2]),"M"] <- sum(df[(df$ID == rdf[1] | df$ID == rdf[2]),"M"])/2
    if (NROW(df[df$nE < iE,"ID"]) < 2) {
      hist(df$M, main=paste("After",iE,"halvings"), xlab="Money", col="steelblue", xlim=c(0,Money_mean+4*Money_sd),, ylim=c(0,Money_mean/4))
      iE <- iE+1
      }
  }
  return(df)
}
```

```{r}
df <- HalveMoney(1000,15)
hist(df$M, xlab="Money", col="steelblue", xlim=c(0,1000+4*250),, ylim=c(0,1000/4))

```
