---
title: "Beta Distribution"
author: "Hubert Baechli"

execute: 
  cache: false
---

Loading some Packages

```{r}

library(tidyverse)
library(fitdistrplus)

# set.seed(1)
```

# Generating Betakurve Parameter

```{r}
beta_par <- function(mu, sigma) {
  mu <- max(mu, 1E-6)
  sigma <- max(sigma, 1E-6)
  a_b <- mu * (1 - mu) / sigma^2 - 1  # calc alpha + beta
  a_b <- max(a_b,1E-6)
  #a_b <- abs(a_b)
  a <- mu * a_b
  b <- (1 - mu) * a_b
  return(list(alpha = a, beta = b))
}

beta_par(mu = 0.5, sigma = 0.1)
```

# Generating random values

```{r}
gen_rbeta <- function(n = n,
                      mu = mu, 
                      sigma = sigma
                      ) {
  par <- beta_par(mu = mu, sigma = sigma)
  data <- rbeta(n = 1000, 
                shape1 = par$alpha, 
                shape2 = par$beta)
  data <- sort(data)

  return(data)
}

data <- gen_rbeta(mu = 0.1, sigma = 0.05)
beta_par(mu = 0.1, sigma = 0.05)

```

```{r}
summary(data)
```

```{r}
hist(data)
```

```{r}
plot(data)
```

```{r}
fit <- fitdist(data, "beta", start = list(shape1 = 1, shape2 = 1))
fit
```
