{
  "hash": "d056727cb6da047380b3d2595cbfcbbc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Notebook(Final)\"\nauthor: \"Hubert Baechli\"\n---\n\n\n\n**Final Version**\n\nLoading some Packages for Better Presentation of Results\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttache Paket: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDie folgenden Objekte sind maskiert von 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDie folgenden Objekte sind maskiert von 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n:::\n\n\n\n# Definitions\n\n## Initial Population\n\n### Norm Population\n\nInitial Populations In line with the paper, a population is generated where the money is normally distributed with a mean of 100.\n\nTo save computation time, the number of agents is reduced from 5000 to 2500. Additionally, the population is sorted and assigned an ID to track them. Agents with small IDs receive the least money, while agents with large IDs have a lot of money.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnA = 2500         # number of Agents\nID = seq_len(nA)  # ID of the Agents\nM0pop = 100       # Mean amount of Money in the Start-Population\n\nPopNorm <- data.frame( ID = ID,\n                       Money= sort(rnorm(nA, mean = M0pop, sd = 0.2 * M0pop))\n                      )\n```\n:::\n\n\n\n### Equal Population\n\nAlso in line with the paper, a second population is generated where all agents start with the same amount of money.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPopEqual <- data.frame( ID = ID,\n                       Money = rep(M0pop, times = nA)\n                      )\n```\n:::\n\n\n\n# Functions\n\n## Gini-Faktor\n\nTo describe the distribution of money in the population, a function is defined to calculate the Gini coefficient.\n\n#### Needs\n\n1.  Vector with Money distribution\n\n#### Output\n\n1.  Gini-Factor\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngini <- function(VM) {\n  VM <- sort(VM)\n  n <- NROW(VM)\n  numer <- 0\n  for (i in 1:n) {\n    numer <- numer + 2 * i * VM[i]\n  }\n  denom = n * sum(VM)\n  return((numer / denom) - (n + 1) / n)\n}\n```\n:::\n\n\n\n### Timeline\n\nThe same is also implemented as a time function.\n\n#### Needs\n\n1.  Matrix with Money distribution as vector per time\n\n#### Output\n\n1.  Vector with Gini-Factor per time\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngini_t <- function(MM) {\n  n <- NCOL(MM)\n  GT <- c(0)\n  for (i in 1:n) {\n    GT[i] <-  gini(MM[,i])\n  }\n  return(GT)\n  }\n```\n:::\n\n\n\n## Transaction rule\n\nIn line with the paper, a random distribution of money between two agents is defined.\n\n#### Needs\n\n1.  Nothing\n\n#### Output\n\n1.  Vector with a random number and 1minus this number\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsplitpair <- function(){\n  rn <- runif(1)\n  c(rn,1-rn)\n}\nsplitpair()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4922818 0.5077182\n```\n\n\n:::\n:::\n\n\n\n## Probabilities\n\nSince it was suspected in the sketchbook that the reason for the outcome is the decreasing probability of meeting an agent with more or a lot of money, a function is defined here to calculate various probabilities:\n\n-   Probability of winning money (probwin)\n\n-   Probability of having more money than the current median in the population after the exchange (probmed)\n\n-   Probability of having more money than the mean in the population after the exchange (probmean)\n\n#### Needs\n\n1.  Vector with Money distribution\n\n#### Output\n\n1.  Summary (Sum) with minimum, maximum, median and mean for the given Money and the mention probabilities\n\n2.  Distribution (Dist) for the same values\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalc_p <- function(VM) {\n  Dist <- data.frame(Money = VM,\n                     probwin = 0,\n                     probmed = 0,\n                     probmean = 0\n                     )\n  Sum <- data.frame(Money = c(min(Dist$Money),\n                              max(Dist$Money),\n                              median(Dist$Money),\n                              mean(Dist$Money)\n                              ),\n                    probwin = 0,\n                    probmed = 0,\n                    probmean = 0\n                    )\n  rownames(Sum) <- c(\"min\", \"max\", \"med\", \"mean\")\n  M_Med <- Sum[\"med\", \"Money\"]\n  M_Mean <- Sum[\"mean\", \"Money\"]\n  for(i in 1:nrow(Dist)) {\n    M_A <- Dist[i,\"Money\"]\n    M_oA <- Dist[c(-i),\"Money\"]\n    pwin <- M_oA*0\n    pmed <- M_oA*0\n    pmean <- M_oA*0\n    for(ii in 1:NROW(M_oA)) {\n      Pot <- max(M_A + M_oA[ii], 10e-8)\n      pwin[ii] <- 1-min(1, M_A/Pot)\n      pmed[ii] <- 1-min(1, M_Med/Pot)\n      pmean[ii] <- 1-min(1, M_Mean/Pot)\n    }\n    Dist[i,\"probwin\"] <- mean(pwin)\n    Dist[i,\"probmed\"] <- mean(pmed)\n    Dist[i,\"probmean\"] <- mean(pmean)\n  }\n  for (i in c(\"probwin\",\"probmed\",\"probmean\")) {\n    Sum[[i]] = c(min(Dist[[i]]),\n                    max(Dist[[i]]),\n                    median(Dist[[i]]),\n                    mean(Dist[[i]])\n    )\n  }\n\n  Output <- list(Sum = Sum, Dist = Dist)\n  return(Output)\n}\n```\n:::\n\n\n\nThe same Function with matrix calculations, what is much faster!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalc_p <- function(VM) {\n  n <- length(VM)\n  MM <- matrix(rep(VM,times=n),n,n)\n  S <- (VM+t(MM))\n  S[S==0] <- 10e-8\n  pwin <- (1-t(MM)/S)\n  diag(pwin) <- 0\n  pmed <- 1-(median(VM)/S)\n  pmed[pmed<0] <- 0\n  diag(pmed) <- 0\n  pmean <- 1-(mean(VM)/S)\n  pmean[pmean<0] <- 0\n  diag(pmean) <- 0\n\n  Dist <- data.frame(Money = VM,\n                     probwin = colSums(pwin)/(n-1),\n                     probmed = colSums(pmed)/(n-1),\n                     probmean = colSums(pmean)/(n-1)\n                     )\n\n  Sum <- data.frame(Money = c(min(Dist$Money),\n                              max(Dist$Money),\n                              median(Dist$Money),\n                              mean(Dist$Money)),\n                    probwin = c(min(Dist$probwin),\n                                max(Dist$probwin),\n                                median(Dist$probwin),\n                                mean(Dist$probwin)),\n                    probmed = c(min(Dist$probmed),\n                                max(Dist$probmed),\n                                median(Dist$probmed),\n                                mean(Dist$probmed)),\n                    probmean = c(min(Dist$probmean),\n                                max(Dist$probmean),\n                                median(Dist$probmean),\n                                mean(Dist$probmean))\n                    )\n\n  rownames(Sum) <- c(\"min\", \"max\", \"med\", \"mean\")\n  Output <- list(Sum = Sum, Dist = Dist)\n  return(Output)\n}\n```\n:::\n\n\n\n### Timeline\n\nThe same is also implemented as a time function.\n\n#### Needs\n\n1.  Matrix with Money distribution as vector per time ( as reported from ecosim\\$timeline)\n\n#### Output\n\n1.  Matrix probability-values per time in colones (long form)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalc_p_t <- function(MM) {\n  pnt <- calc_p(MM[,1])\n  tx <- as.numeric(gsub(\"n\", \"\",colnames(MM)[1]))\n  pnts <- data.frame(Time = rep(tx, times = 4),\n                     Res = colnames(pnt$Sum),\n                     t(pnt$Sum)\n                     )\n  for(i in 2:ncol(MM)) {\n    pnt <- calc_p(MM[,i])\n    tx <- as.numeric(gsub(\"n\", \"\",colnames(MM)[i]))\n    pnti <- data.frame(Time = rep(tx, times = 4),\n                       Res = colnames(pnt$Sum),\n                       t(pnt$Sum)\n                       )\n    pnts <- rbind(pnts,pnti)\n  }\n  rownames(pnts) <- NULL\n  return(pnts)\n}\n```\n:::\n\n\n\n## **Economic Simulation**\n\nFinally, a simulation is created that simulates a certain number of money exchanges.\n\n#### Needs\n\n1.  Number of exchanges\n\n2.  Startdistribition of Money\n\n3.  Steps for the timeline (optional)\n\n#### Output\n\n1.  Summary (Sum) with ID, number of exchanges, Money at beginning and Money at the End\n\n2.  Matrix with Money distribution(Timeline) for given time steps as vectors (if steps \\> 0)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\necosim <- function( n, VM, TL = 0 ) {\n  df <- data.frame(ID=seq(1,NROW(VM)),\n                   nE=0,\n                   MT_S=VM,\n                   MT_E=VM\n                   )\n  if (TL > 0) {\n    M_TL <- data.frame(n0 = df$MT_S)\n  }\n  for(i in 1:n) {\n    rdf <- sample(df$ID, size=2)\n    rds <- splitpair()\n    df[rdf,\"nE\"] <- df[rdf,\"nE\"] + 1\n    df[rdf,\"MT_E\"] <- sum( df[rdf,\"MT_E\"]) * rds\n    if ( TL > 0 ) {\n      if ( i %% TL == 0) {\n        M_TL [[paste0(\"n\",i)]]<- df$MT_E\n      }\n    }\n  }\n  Output <- list(\"Sum\" = df)\n  if ( TL > 0 ) {\n    rownames(M_TL) <- df$ID\n    Output$Timeline <- M_TL\n  }\n  return(Output)\n}\n```\n:::\n\n\n\n## Plot functions\n\n### Histogram\n\n#### Needs\n\n1.  Summary of a economic Simulation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfigHist <- function(Sim_Sum) {\n  Fig <- pivot_longer(data.frame(Sim_Sum),\n                      cols = starts_with(\"MT\"),\n                      names_to = \"Distribution\",\n                      values_to = \"Money\"\n                      )\n  Fig$Distribution <-recode(Fig$Distribution,\n                            \"MT_S\" = \"at Begining\",\n                            \"MT_E\" = \"at the End\"\n                            )\n  Figp <- ggplot(Fig, aes(x = Money, fill = Distribution)) +\n    geom_histogram(position = \"identity\", alpha = 0.5, bins = 50) +\n    ylab(\"Frequency\") +\n    scale_fill_manual(name = NULL, values = c(4,3)) +\n    scale_color_manual(name = NULL, values = c(4, 3)) +\n    theme_minimal() +\n    theme(legend.position = \"top\")\n  return(Figp)\n}\n```\n:::\n\n\n\n### Probabilities in the Population\n\n#### Needs\n\n1.  Probability distribution from calc_p\n\n2.  Title for the figure\n\n3.  Maximum for the x axis (Money)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfigProb <- function(Prob, Title, xmax) {\n  Figd <- pivot_longer(data.frame(Prob$Dist),\n                       cols = starts_with(\"p\"),\n                       names_to = \"Outcome\",\n                       values_to = \"Probability\"\n                       )\n  Figs <- Prob$Sum\n\n  Figp <- ggplot(data = Figd,\n                 aes(x = Money,\n                     y = Probability,\n                     color = Outcome\n                     )\n                 ) +\n    geom_point( alpha = 0.5, size = 1.5) +\n    scale_color_manual(name = \"Probability to\",\n                       values = c(2, 3, 4),\n                       labels = c(\"gain more than the Mean\",\n                                  \"gain more than the Median\",\n                                  \"gain\")\n                       ) +\n    ylim(0, 1) +\n    xlim(0, xmax) +\n\n    geom_vline(xintercept = Figs[\"med\",\"Money\"],\n               linetype = \"solid\", color = 1) +\n    annotate(\"text\",\n             x = Figs[\"med\",\"Money\"] * 0.95,\n             y = 0,\n             hjust = 1,\n             vjust = 0,\n             label = paste(\"Median\\n=\",\n                           round(Figs[\"med\",\"Money\"], 0)),\n             color = 1) +\n\n    geom_vline(xintercept = Figs[\"mean\",\"Money\"],\n               linetype = \"dashed\", color = 1) +\n    annotate(\"text\",\n             x = Figs[\"mean\",\"Money\"] * 1.05,\n             y = 0,\n             hjust = 0,\n             vjust = 0,\n             label = paste(\"Mean\\n=\",\n                           round(Figs[\"mean\",\"Money\"], 0)),\n             color = 1) +\n\n    geom_hline(yintercept = Figs[\"mean\",\"probmed\"],\n             linetype = \"solid\", color = 3) +\n    annotate(\"text\",\n             x = xmax,\n             y = Figs[\"mean\",\"probmed\"] * 1.05,\n             hjust = 1,\n             vjust = 0,\n             label = paste(\"Mean =\",\n                           round(Figs[\"mean\",\"probmed\"], 2)),\n             color = 3) +\n\n    geom_hline(yintercept = Figs[\"mean\",\"probmean\"],\n               linetype = \"solid\", color = 2) +\n    annotate(\"text\",\n             x = xmax,\n             y = Figs[\"mean\",\"probmean\"]*0.95,\n             hjust = 1,\n             vjust = 1,\n             label = paste(\"Mean =\",\n                           round(Figs[\"mean\",\"probmean\"], 2)),\n             color = 2) +\n\n    labs(title = Title) +\n    theme_light() +\n    theme(legend.position = \"top\",\n          legend.justification = c(0, 1))\n  return(Figp)\n}\n```\n:::\n\n\n\n### Probabilities over Time\n\n#### Needs\n\n1.  Probability distribution from calc_p_t\n\n2.  Title for the figure\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfigProb_t <- function(Prob, Title) {\n  Fig <- Prob[Prob$Res!=\"Money\",c(\"Time\",\"Res\",\"mean\")]\n\n  Figp <- ggplot(data = Fig, aes(x = Time, y = mean, color = Res)) +\n    geom_line(linewidth = 1) +\n    scale_color_manual(name = NULL, values = c(2, 3, 4),\n                      labels = c(\"gain more than the Mean\",\n                                 \"gain more than the Median\",\n                                 \"gain\")) +\n    ggtitle(Title) +\n    xlab(\"number of exchanges\") +\n    ylab(\"Mean-Probability in the Population\") +\n    ylim(0.30, 0.6) +\n    theme_light() +\n    theme(legend.position = \"top\",\n         legend.justification = c(0, 1))\n  return(Figp)\n}\n```\n:::\n\n\n\n# Simulation for...\n\n## Normal Population\n\nSimulation for 100000 exchanges with output after every 500th exchange.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsNorm <- ecosim(100000, PopNorm$Money, TL = 500)\n```\n:::\n\n\n\n### Presentation of the end results\n\nAt the beginning, the distribution of money in the population looks like this. After simulating 100,000 money exchanges, the following distribution emerges.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig01 <- figHist(sNorm$Sum)\nFig01\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n### Representation of Money over time\n\nIt seems that every agent has the chance to have a lot of money in the end. This can be shown by tracking individual agents and their money. Below, nine agents are shown: three with little, three with 100, and three with the most money at the beginning.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMTime <- data.frame(ID,sNorm$Timeline)\n\nsID <- c(1,2,3,nA/2-1,nA/2,nA/2+1,nA-2,nA-1,nA)\nsMTime <- MTime[sID,]\n\nFig02 <- pivot_longer(data.frame(sMTime),\n                      cols = !matches(\"ID\"),\n                      names_to = \"Time\",\n                      names_prefix = \"n\",\n                      names_transform = list(Time = as.integer),\n                      values_to = \"Money\"\n)\n\nFig02$ID <- sprintf(\"%04d\", Fig02$ID)\n\nggplot(data = Fig02, aes(x = Time, y = Money, color = ID)) +\n  geom_line() +\n  ggtitle(\"Timeline for some Agents\") +\n  xlab(\"number of exchanges\") +\n  labs(color = \"Agents ID\") +\n  scale_color_manual(values = c(2,2,2, 1,1, 1,3,3,3)) +\n  theme_light() +\n  theme(legend.position = \"right\",\n        legend.justification = c(0, 1))\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n### Probabilities for specific Timesteps\n\nThis can also be shown with the calculated probabilities for the next meeting for each agent.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig03 <- figProb(calc_p(sNorm$Timeline[,1]), \n                \"Probability at Beginning\", 850)\nFig04 <- figProb(calc_p(sNorm$Timeline[,2]), \n                \"Probability after 500 exchanges\", 850)\nFig05 <- figProb(calc_p(sNorm$Timeline[,3]), \n                \"Probability after 1000 exchanges\", 850)\nFig06 <- figProb(calc_p(sNorm$Timeline[,NCOL(sNorm$Timeline)]), \n                \"Probability at the End\", 850)\n```\n:::\n\n\n\nInitially, it seems to be a fairly fair trade, so agents with little money have a higher probability of winning money in the next exchange. However, they also have a lower probability of ending up above the median or the mean. At the beginning, all probabilities in the population are about 0.5 on average.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig03\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\nHowever, after a few meetings, this changes. The probability of ending up above the median or the mean decreases.\n\nThe reason for this is that with each exchange, a rich and a poor agent are created, which decreases the probability of meeting a rich agent in the future. As a result, the median amount of money decreases.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig04\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\nThis effect intensifies over time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig05\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\nAfter 100,000 meetings, the distribution of probabilities in the population looks like this.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig06\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\nIt seems that the probability of ending up above the median rises back to 0.5. However, the probability of ending up above the mean remains low.\n\n### Probabilities over Time\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nProbNormt <- calc_p_t(sNorm$Timeline)\n```\n:::\n\n\n\nThis can be seen even better when looking at the said probabilities over time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig07 <-figProb_t(ProbNormt, \"Probability to ... of Money - Timeline\")\nFig07\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n## Equal Population\n\nSimulation for 100000 exchanges with output after every 500th exchange.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\neNorm <- ecosim(100000, PopEqual$Money, TL = 500)\n```\n:::\n\n\n\n### Presentation of the end results\n\nAt first glance, it seems illogical that a population where everyone starts with the same amount of money would result in a similar final distribution of money. However, the simulation proves this.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig08 <- figHist(eNorm$Sum)\nFig08\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\n### Probabilities for specific Timesteps\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig09 <- figProb(calc_p(eNorm$Timeline[,1]), \n                \"Probability at Beginning\", 850)\nFig10 <- figProb(calc_p(eNorm$Timeline[,2]), \n                \"Probability after 500 exchanges\", 850)\nFig11 <- figProb(calc_p(eNorm$Timeline[,3]), \n                \"Probability after 1000 exchanges\", 850)\nFig12 <- figProb(calc_p(eNorm$Timeline[,NCOL(eNorm$Timeline)]), \n                \"Probability at the End\", 850)\n```\n:::\n\n\n\nAt the beginning, all probabilities are exactly 0.5.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig09\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\nHowever, the same mechanism applies here. With each exchange, a rich and a poor agent are created.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig10\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\nTherefore, the probability of meeting a rich agent in the future also decreases here. As a result, the probability of ending up above the median or the mean decreases here as well.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig11\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\nAfter 100,000 meetings, the distribution of probabilities in this population looks almost identical.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig12\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\n### Probabilities over Time\n\nThis is even more evident over time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nProbEqualt <- calc_p_t(eNorm$Timeline)\n```\n:::\n\n\n\nHowever, it seems that the median amount of money remains stable a bit longer.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig13 <- figProb_t(ProbEqualt, \"Probability to ... of Money - Timeline\")\nFig13\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n# Comparison\n\nTo better compare the two populations, two new simulations are conducted. The number is restricted to the interesting initial range, and the time resolution is increased.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsNorms <- ecosim(10000, PopNorm$Money, TL = 100)\nProbNormts <- calc_p_t(sNorms$Timeline)\neNorms <- ecosim(10000, PopEqual$Money, TL = 100)\nProbEqualts <- calc_p_t(eNorms$Timeline)\n```\n:::\n\n\n\n### Probabilities over Time\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig14 <- figProb_t(ProbNormts, \n          \"Probability to ... of Money\\nTimeline for the Norm Population\")\nFig15 <- figProb_t(ProbEqualts, \n          \"Probability to ... of Money\\nTimeline for a equal Population\")\n```\n:::\n\n\n\nIt actually shows that in the population with the normal distribution, the probabilities for the median and the mean separate earlier.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig14\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n\nIn the population with the same initial amount of money, the two lines remain very close together, meaning that the median and mean amounts of money remain almost identical.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig15\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n\nThis makes sense because the meetings are random, and therefore some agents keep their starting balance of 100 longer. After 2500 meetings, or about two meetings per agent, this becomes increasingly unlikely.\n\n# Exploration\n\nSince I have not yet used the Gini coefficient described in the article, it is now plotted over time for the two populations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig16 <- data.frame( Time = ProbNormts[ProbNormts$Res == \"Money\",c(\"Time\")],\n                    Norm = gini_t(sNorms$Timeline),\n                    Equal = gini_t(eNorms$Timeline)\n                   )\nFig16 <- pivot_longer(data.frame(Fig16),\n                      cols = !matches(\"Time\"),\n                      names_to = \"Pop\",\n                      values_to = \"Gini\"\n                      )\n                    \nFig16p <- ggplot(data = Fig16, aes(x = Time, y = Gini, color = Pop)) +\n  geom_line(linewidth = 1) +\n  scale_color_manual(name = \"Start Population\", values = c(2, 1)) +\n  ggtitle(\"Gini-Faktor - Timeline\") +\n  xlab(\"number of exchanges\") +\n  ylab(\"Gini\") +\n  theme_light() +\n  theme(legend.position = \"top\",\n        legend.justification = c(0, 1))\n\nFig16p\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n\nIt seems that the course is quite similar to the course of the probability of ending up above the mean of the distribution. A closer look shows that the reciprocal of the Gini coefficient matches quite well with the probability of ending up above the mean of the distribution.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig17 <- data.frame( Time = ProbNormts[ProbNormts$Res == \"Money\",c(\"Time\")],\n                    GNorm = (1-Fig16[Fig16$Pop == \"Norm\",\"Gini\"]),\n                    PNorm = ProbNormts[ProbNormts$Res == \"probmean\",c(\"mean\")],\n                    GEqual = 1-Fig16[Fig16$Pop == \"Equal\",\"Gini\"],\n                    PEqual = ProbEqualts[ProbEqualts$Res == \"probmean\",c(\"mean\")]\n                   )\ncolnames(Fig17) <- c(\"Time\", \"GNorm\", \"PNorm\", \"GEqual\", \"PEqual\")\n\nFig17$Faktn <- Fig17$GNorm/Fig17$PNorm\nFig17$Fakte <- Fig17$GEqual/Fig17$PEqual\n\nFig17 <- pivot_longer(data.frame(Fig17),\n                      cols = starts_with(\"F\"),\n                      names_to = \"Pop\",\n                      values_to = \"Fakt\"\n                      )\n\nFig17p <- ggplot(data = Fig17, \n  aes(x = Time, y = Fakt, color = Pop, linetype = Pop)) +\n  geom_line(linewidth = 1) +\n  scale_color_manual(name = \"Start Population\", \n                     values = c(2, 1),\n                     labels = c(\"Equal\", \"Norm\")) +\n  scale_linetype_manual(\"Start Population\",\n                        values = c(\"solid\", \"dashed\"),\n                        labels = c(\"Equal\", \"Norm\")) +\n  ggtitle(\"Relation between\\n \n          Probability to gain more than the Mean\\n\n          and (1-Gini) - Timeline\") +\n  xlab(\"number of exchanges\") +\n  ylab(\"Faktor\") +\n  theme_light() +\n  theme(legend.position = \"top\",\n        legend.justification = c(0, 1))\n\nFig17p\n```\n\n::: {.cell-output-display}\n![](notebook_final_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\n\n***This could potentially allow for the development of a mathematical model for this mechanism. However, this exceeds my abilities and will be left to more capable individuals.***\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}