{
  "hash": "675861c661b6f4f09fbf15a24a30ed43",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Notebook\"\nauthor: \"Hubert Baechli\"\n---\n\n\n\n\n# Final Version\n\n## Definitions\n\nAt beginning I load some packets for nicer plots.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(dplyr)\n```\n:::\n\n\n\n\nStart Population from the paper (PopNorm) with less Agents to spend calculationtime\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnA = 1000         # number of Agents\nID = seq_len(nA)  # ID of the Agents\nM0pop = 100       # Mean amount of Money in the Start-Population\n\n# generating Start-Population\n\nPopNorm <- data.frame( ID = ID,\n                       Money= sort(rnorm(nA, mean = M0pop, sd = 0.2 * M0pop))\n                      )\n```\n:::\n\n\n\n\nPlot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(PopNorm, aes(x = Money)) +\n  geom_histogram(position = \"identity\", alpha = 0.5, bins = 50, fill = 4) +\n  ylab(\"Frequency\") +\n  scale_fill_manual(values = 4) +\n  theme_minimal() +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](notebook_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsplitpair <- function(){\n  rn <- runif(1)\n  c(rn,1-rn)\n}\nsplitpair()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6352625 0.3647375\n```\n\n\n:::\n:::\n\n\n\n\ncalculating the Probability for the next exchange\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalc_p <- function(M_dist) {\n  Dist <- data.frame(Money = M_dist,\n                     probwin = 0,\n                     probmed = 0,\n                     probmean = 0\n                     )\n  Sum <- data.frame(Money = c(min(Dist$Money),\n                              max(Dist$Money),\n                              median(Dist$Money),\n                              mean(Dist$Money)\n                              ),\n                    probwin = 0,\n                    probmed = 0,\n                    probmean = 0\n                    )\n  rownames(Sum) <- c(\"min\", \"max\", \"med\", \"mean\")\n  M_Med <- Sum[\"med\", \"Money\"]\n  M_Mean <- Sum[\"mean\", \"Money\"]\n  for(i in 1:nrow(Dist)) {\n    M_A <- Dist[i,\"Money\"]\n    M_oA <- Dist[c(-i),\"Money\"]\n    pwin <- M_oA*0\n    pmed <- M_oA*0\n    pmean <- M_oA*0\n    for(ii in 1:NROW(M_oA)) {\n      Pot <- max(M_A + M_oA[ii], 10e-8)\n      pwin[ii] <- 1-min(1, M_A/Pot)\n      pmed[ii] <- 1-min(1, M_Med/Pot)\n      pmean[ii] <- 1-min(1, M_Mean/Pot)\n    }\n    Dist[i,\"probwin\"] <- mean(pwin)\n    Dist[i,\"probmed\"] <- mean(pmed)\n    Dist[i,\"probmean\"] <- mean(pmean)\n  }\n  for (i in c(\"probwin\",\"probmed\",\"probmean\")) {\n    Sum[[i]] = c(min(Dist[[i]]),\n                    max(Dist[[i]]),\n                    median(Dist[[i]]),\n                    mean(Dist[[i]])\n    )\n  }\n\n  Output <- list(Sum = Sum, Dist = Dist)\n  return(Output)\n}\n```\n:::\n\n\n\n\nCalculating for Normpopulation\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprobNorm <- calc_p(PopNorm$Money)\n```\n:::\n\n\n\n\nplot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFig01 <- pivot_longer(data.frame(probNorm$Dist),\n                      cols = starts_with(\"p\"),\n                      names_to = \"Outcome\",\n                      values_to = \"Probability\"\n)\n\nggplot(data = Fig01, aes(x = Money, y = Probability, color = Outcome)) +\n  geom_line(linewidth = 1.1) +\n  ylim(0, 1) +\n  ggtitle(\"Probability for the Norm-Population\") +\n  theme_light() +\n  theme()\n```\n\n::: {.cell-output-display}\n![](notebook_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}