{
  "hash": "dee998aba10b974af2a1bde83a8fdbcd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 2: Economic Simulation\"\nauthor: \"Hubert Baechli\"\n---\n\n\n\n\nMy first attempt at an agent model with the information from the lesson\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSplitHalve <- function(nAgent,maxExchange,Money_mean=1000,Money_sd=300) {\n  df <- data.frame(ID=seq(1,nAgent),\n                   nE=0,\n                   Ms=rnorm(nAgent, mean = Money_mean, sd = Money_sd),\n                   MT=0,Me=0)\n  df$Me <- df$Ms\n  iE <- 1\n  while (iE <= maxExchange) {\n    df$MT <- df$Me\n    rdf <- sample(df[df$nE < iE,\"ID\"], size=2)\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"] <-\n      df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"]+1\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"Me\"] <-\n      sum(df[(df$ID == rdf[1] | df$ID == rdf[2]),\"MT\"])/2\n    if (NROW(df[df$nE < iE,\"ID\"]) < 2) {\n      iE <- iE+1\n      }\n  }\n  return(df)\n}\n```\n:::\n\n\n\n\nPresentation of the results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- SplitHalve(1000,30)\n\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       ID               nE           Ms               MT             Me      \n Min.   :   1.0   Min.   :30   Min.   : -35.7   Min.   :1011   Min.   :1011  \n 1st Qu.: 250.8   1st Qu.:30   1st Qu.: 807.4   1st Qu.:1011   1st Qu.:1011  \n Median : 500.5   Median :30   Median :1017.2   Median :1011   Median :1011  \n Mean   : 500.5   Mean   :30   Mean   :1011.1   Mean   :1011   Mean   :1011  \n 3rd Qu.: 750.2   3rd Qu.:30   3rd Qu.:1216.8   3rd Qu.:1011   3rd Qu.:1011  \n Max.   :1000.0   Max.   :30   Max.   :2005.2   Max.   :1011   Max.   :1011  \n```\n\n\n:::\n\n```{.r .cell-code}\nhist(df$Ms, xlab=\"Money\",main=\"Histogram for split-halve\",\n     col=rgb(0,0,1,0.2),\n     xlim=c(0,max(c(df$Me,df$Ms)))*1.1,ylim=c(0,nrow(df)/2))\nhist(df$Me, col=rgb(0,1,0,0.2),\n     add=TRUE)\nlegend('topright', c('Money befor', 'Money after'),\n       fill=c(rgb(0,0,1,0.5), rgb(0,1,0,0.2)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(df$ID,df$nE,main=\"Number of Changes\",\n     xlab=\"ID\",ylab=\"Number of Changes\",\n     col=rgb(1,0,0,0.2))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n\n\nAfter looking at the code on <https://github.com/norvig/pytudes/blob/main/ipynb/Economics.ipynb#js-repo-pjax-container> there are some differences between my idea and the paper!\n\nThese will now be adapted step by step. First of all, the restriction that everyone finds an exchange partner at the same time will be lifted. In addition, the number and order of changes will also be removed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSplitHalve2 <- function(nAgent,maxExchange,Money_mean=1000,Money_sd=300) {\n  df <- data.frame(ID=seq(1,nAgent),\n                   nE=0,\n                   Ms=rnorm(nAgent, mean = Money_mean, sd = Money_sd),\n                   MT=0,Me=0)\n  df$Me <- df$Ms\n  iE <- 1\n  while (iE <= maxExchange) {\n    df$MT <- df$Me\n    rdf <- sample(df$ID, size=2)\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"] <-\n      df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"]+1\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"Me\"] <-\n      sum(df[(df$ID == rdf[1] | df$ID == rdf[2]),\"MT\"])/2\n    iE <- iE+1\n  }\n  return(df)\n}\n```\n:::\n\n\n\n\nPresentation of the results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- SplitHalve2(1000,15000)\n\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       ID               nE              Ms                MT      \n Min.   :   1.0   Min.   :15.00   Min.   : -30.55   Min.   :1011  \n 1st Qu.: 250.8   1st Qu.:26.75   1st Qu.: 813.34   1st Qu.:1011  \n Median : 500.5   Median :30.00   Median :1018.55   Median :1012  \n Mean   : 500.5   Mean   :30.00   Mean   :1011.52   Mean   :1012  \n 3rd Qu.: 750.2   3rd Qu.:34.00   3rd Qu.:1215.90   3rd Qu.:1012  \n Max.   :1000.0   Max.   :44.00   Max.   :1965.63   Max.   :1015  \n       Me      \n Min.   :1011  \n 1st Qu.:1011  \n Median :1012  \n Mean   :1012  \n 3rd Qu.:1012  \n Max.   :1015  \n```\n\n\n:::\n\n```{.r .cell-code}\nhist(df$Ms, xlab=\"Money\",main=\"Histogram for split-halve\",\n     col=rgb(0,0,1,0.2),\n     xlim=c(0,max(c(df$Me,df$Ms)))*1.1,ylim=c(0,nrow(df)/2))\nhist(df$Me, col=rgb(0,1,0,0.2),\n     add=TRUE)\nlegend('topright', c('Money befor', 'Money after'),\n       fill=c(rgb(0,0,1,0.5), rgb(0,1,0,0.2)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(df$ID,df$nE,main=\"Number of Changes\",\n     xlab=\"ID\",ylab=\"Number of Changes\",\n     col=rgb(1,0,0,0.2))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\n\n\nThe next step is to change from a half-split to a random-split. In the hope that this can reflect the results of the paper\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSplitRandom <- function(nAgent,maxExchange,Money_mean=1000,Money_sd=300) {\n  df <- data.frame(ID=seq(1,nAgent),\n                   nE=0,\n                   Ms=rnorm(nAgent, mean = Money_mean, sd = Money_sd),\n                   MT=0,Me=0)\n  df$Me <- df$Ms\n  iE <- 1\n  while (iE <= maxExchange) {\n    df$MT <- df$Me\n    rdf <- sample(df$ID, size=2)\n    rds <- sample(0:100, size=1)/100\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"] <-\n      df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"]+1\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"Me\"] <-\n      sum(df[(df$ID == rdf[1] | df$ID == rdf[2]),\"MT\"])*c(rds,1-rds)\n    iE <- iE+1\n  }\n  return(df)\n}\n```\n:::\n\n\n\n\n**I am very surprised!** here are the results for the random-split\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- SplitRandom(1000,15000)\n\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       ID               nE           Ms                MT        \n Min.   :   1.0   Min.   :13   Min.   : -54.73   Min.   :   0.0  \n 1st Qu.: 250.8   1st Qu.:26   1st Qu.: 789.51   1st Qu.: 254.5  \n Median : 500.5   Median :30   Median :1000.84   Median : 628.2  \n Mean   : 500.5   Mean   :30   Mean   : 998.07   Mean   : 998.1  \n 3rd Qu.: 750.2   3rd Qu.:34   3rd Qu.:1206.97   3rd Qu.:1364.8  \n Max.   :1000.0   Max.   :48   Max.   :1944.15   Max.   :6632.3  \n       Me        \n Min.   :   0.0  \n 1st Qu.: 253.7  \n Median : 628.2  \n Mean   : 998.1  \n 3rd Qu.:1364.8  \n Max.   :6632.3  \n```\n\n\n:::\n\n```{.r .cell-code}\nhist(df$Ms, xlab=\"Money\",main=\"Histogram for split-random\",\n     col=rgb(0,0,1,0.2),\n     xlim=c(0,max(c(df$Me,df$Ms)))*1.1,ylim=c(0,nrow(df)/2))\nhist(df$Me, col=rgb(0,1,0,0.2),\n     add=TRUE)\nlegend('topright', c('Money befor', 'Money after'),\n       fill=c(rgb(0,0,1,0.5), rgb(0,1,0,0.2)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(df$ID,df$nE,main=\"Number of Changes\",\n     xlab=\"ID\",ylab=\"Number of Changes\",\n     col=rgb(1,0,0,0.2))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}