{
  "hash": "00760a8e4b5ebde8b41857f457be4a26",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 2: Economic Simulation\"\nauthor: \"Hubert Baechli\"\n---\n\n\n\n\nMy first attempt at an agent model with the information from the lesson\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSplitHalve <- function(nAgent,maxExchange,Money_mean=1000,Money_sd=300) {\n  df <- data.frame(ID=seq(1,nAgent),\n                   nE=0,\n                   Ms=rnorm(nAgent, mean = Money_mean, sd = Money_sd),\n                   MT=0,Me=0)\n  df$Me <- df$Ms\n  iE <- 1\n  while (iE <= maxExchange) {\n    df$MT <- df$Me\n    rdf <- sample(df[df$nE < iE,\"ID\"], size=2)\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"] <-\n      df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"]+1\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"Me\"] <-\n      sum(df[(df$ID == rdf[1] | df$ID == rdf[2]),\"MT\"])/2\n    if (NROW(df[df$nE < iE,\"ID\"]) < 2) {\n      iE <- iE+1\n      }\n  }\n  return(df)\n}\n```\n:::\n\n\n\n\nPresentation of the results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- SplitHalve(1000,10)\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       ID               nE           Ms               MT        \n Min.   :   1.0   Min.   :10   Min.   :  94.1   Min.   : 963.1  \n 1st Qu.: 250.8   1st Qu.:10   1st Qu.: 785.6   1st Qu.: 978.4  \n Median : 500.5   Median :10   Median : 992.2   Median : 984.5  \n Mean   : 500.5   Mean   :10   Mean   : 984.3   Mean   : 984.3  \n 3rd Qu.: 750.2   3rd Qu.:10   3rd Qu.:1181.8   3rd Qu.: 989.7  \n Max.   :1000.0   Max.   :10   Max.   :1924.1   Max.   :1011.6  \n       Me        \n Min.   : 963.1  \n 1st Qu.: 978.4  \n Median : 984.5  \n Mean   : 984.3  \n 3rd Qu.: 989.7  \n Max.   :1011.6  \n```\n\n\n:::\n\n```{.r .cell-code}\nhist(df$Ms, xlab=\"Money\",main=\"Histogram for split-halve\",\n     col=rgb(0,0,1,0.2),\n     xlim=c(0,max(c(df$Me,df$Ms)))*1.1,ylim=c(0,nrow(df)/2))\nhist(df$Me, col=rgb(0,1,0,0.2),\n     add=TRUE)\nlegend('topright', c('Money befor', 'Money after'),\n       fill=c(rgb(0,0,1,0.5), rgb(0,1,0,0.2)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(df$nE, xlab=\"Money\",main=\"Number of Exchanges\",\n     col=rgb(0,0,1,0.2),\n     xlim=c(0,max(df$nE))*1.1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n\n\nAfter looking at the code on <https://github.com/norvig/pytudes/blob/main/ipynb/Economics.ipynb#js-repo-pjax-container> there are some differences between my idea and the paper!\n\nThese will now be adapted step by step. First of all, the restriction that everyone finds an exchange partner at the same time will be lifted. In addition, the number and order of changes will also be removed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSplitHalve2 <- function(nAgent,maxExchange,Money_mean=1000,Money_sd=300) {\n  df <- data.frame(ID=seq(1,nAgent),\n                   nE=0,\n                   Ms=rnorm(nAgent, mean = Money_mean, sd = Money_sd),\n                   MT=0,Me=0)\n  df$Me <- df$Ms\n  iE <- 0\n  while (iE <= maxExchange) {\n    df$MT <- df$Me\n    rdf <- sample(df$ID, size=2)\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"] <-\n      df[(df$ID == rdf[1] | df$ID == rdf[2]),\"nE\"]+1\n    df[(df$ID == rdf[1] | df$ID == rdf[2]),\"Me\"] <-\n      sum(df[(df$ID == rdf[1] | df$ID == rdf[2]),\"MT\"])/2\n    iE <- iE+1\n  }\n  return(df)\n}\n```\n:::\n\n\n\n\nPresentation of the results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- SplitHalve2(1000,10000)\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       ID               nE           Ms                MT        \n Min.   :   1.0   Min.   : 8   Min.   : -30.55   Min.   : 999.1  \n 1st Qu.: 250.8   1st Qu.:17   1st Qu.: 813.34   1st Qu.:1010.6  \n Median : 500.5   Median :20   Median :1018.55   Median :1011.5  \n Mean   : 500.5   Mean   :20   Mean   :1011.52   Mean   :1011.5  \n 3rd Qu.: 750.2   3rd Qu.:23   3rd Qu.:1215.90   3rd Qu.:1012.4  \n Max.   :1000.0   Max.   :35   Max.   :1965.63   Max.   :1029.7  \n       Me        \n Min.   : 999.1  \n 1st Qu.:1010.6  \n Median :1011.5  \n Mean   :1011.5  \n 3rd Qu.:1012.4  \n Max.   :1029.7  \n```\n\n\n:::\n\n```{.r .cell-code}\nhist(df$Ms, xlab=\"Money\",main=\"Histogram for split-halve\",\n     col=rgb(0,0,1,0.2),\n     xlim=c(0,max(c(df$Me,df$Ms)))*1.1,ylim=c(0,nrow(df)/2))\nhist(df$Me, col=rgb(0,1,0,0.2),\n     add=TRUE)\nlegend('topright', c('Money befor', 'Money after'),\n       fill=c(rgb(0,0,1,0.5), rgb(0,1,0,0.2)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(df$nE, xlab=\"Money\",main=\"Number of Exchanges\",\n     col=rgb(0,0,1,0.2),\n     xlim=c(0,max(df$nE))*1.1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}