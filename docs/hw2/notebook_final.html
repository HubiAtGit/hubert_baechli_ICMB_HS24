<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hubert Baechli">
<title>Notebook(Final) – Hubert Baechli: ICMB portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Hubert Baechli: ICMB portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Notebook(Final)</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">hubert_baechli_ICMB_HS24</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1: <br>Hello World</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../hw2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2: <br>Economic Simulation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2/sketchbook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sketchbook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2/notebook_final3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook(Final)</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../Snippets/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Snippets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Snippets/BetaDistribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beta Distribution</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../Project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How knowledge is distributed <br> in the population?<br> Mayby!!</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Project/sketchbook00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Learning kurve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Project/sketchbook01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">with updated Learn rate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Project/sketchbook02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Meetings</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#definitions" id="toc-definitions" class="nav-link active" data-scroll-target="#definitions">Definitions</a>
  <ul class="collapse">
<li>
<a href="#initial-population" id="toc-initial-population" class="nav-link" data-scroll-target="#initial-population">Initial Population</a>
  <ul class="collapse">
<li><a href="#norm-population" id="toc-norm-population" class="nav-link" data-scroll-target="#norm-population">Norm Population</a></li>
  <li><a href="#equal-population" id="toc-equal-population" class="nav-link" data-scroll-target="#equal-population">Equal Population</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a>
  <ul class="collapse">
<li>
<a href="#gini-faktor" id="toc-gini-faktor" class="nav-link" data-scroll-target="#gini-faktor">Gini-Faktor</a>
  <ul class="collapse">
<li><a href="#timeline" id="toc-timeline" class="nav-link" data-scroll-target="#timeline">Timeline</a></li>
  </ul>
</li>
  <li><a href="#transaction-rule" id="toc-transaction-rule" class="nav-link" data-scroll-target="#transaction-rule">Transaction rule</a></li>
  <li>
<a href="#probabilities" id="toc-probabilities" class="nav-link" data-scroll-target="#probabilities">Probabilities</a>
  <ul class="collapse">
<li><a href="#timeline-1" id="toc-timeline-1" class="nav-link" data-scroll-target="#timeline-1">Timeline</a></li>
  </ul>
</li>
  <li><a href="#economic-simulation" id="toc-economic-simulation" class="nav-link" data-scroll-target="#economic-simulation"><strong>Economic Simulation</strong></a></li>
  <li>
<a href="#plot-functions" id="toc-plot-functions" class="nav-link" data-scroll-target="#plot-functions">Plot functions</a>
  <ul class="collapse">
<li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram">Histogram</a></li>
  <li><a href="#probabilities-in-the-population" id="toc-probabilities-in-the-population" class="nav-link" data-scroll-target="#probabilities-in-the-population">Probabilities in the Population</a></li>
  <li><a href="#probabilities-over-time" id="toc-probabilities-over-time" class="nav-link" data-scroll-target="#probabilities-over-time">Probabilities over Time</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#simulation-for" id="toc-simulation-for" class="nav-link" data-scroll-target="#simulation-for">Simulation for…</a>
  <ul class="collapse">
<li>
<a href="#normal-population" id="toc-normal-population" class="nav-link" data-scroll-target="#normal-population">Normal Population</a>
  <ul class="collapse">
<li><a href="#presentation-of-the-end-results" id="toc-presentation-of-the-end-results" class="nav-link" data-scroll-target="#presentation-of-the-end-results">Presentation of the end results</a></li>
  <li><a href="#representation-of-money-over-time" id="toc-representation-of-money-over-time" class="nav-link" data-scroll-target="#representation-of-money-over-time">Representation of Money over time</a></li>
  <li><a href="#probabilities-for-specific-timesteps" id="toc-probabilities-for-specific-timesteps" class="nav-link" data-scroll-target="#probabilities-for-specific-timesteps">Probabilities for specific Timesteps</a></li>
  <li><a href="#probabilities-over-time-1" id="toc-probabilities-over-time-1" class="nav-link" data-scroll-target="#probabilities-over-time-1">Probabilities over Time</a></li>
  </ul>
</li>
  <li>
<a href="#equal-population-1" id="toc-equal-population-1" class="nav-link" data-scroll-target="#equal-population-1">Equal Population</a>
  <ul class="collapse">
<li><a href="#presentation-of-the-end-results-1" id="toc-presentation-of-the-end-results-1" class="nav-link" data-scroll-target="#presentation-of-the-end-results-1">Presentation of the end results</a></li>
  <li><a href="#probabilities-for-specific-timesteps-1" id="toc-probabilities-for-specific-timesteps-1" class="nav-link" data-scroll-target="#probabilities-for-specific-timesteps-1">Probabilities for specific Timesteps</a></li>
  <li><a href="#probabilities-over-time-2" id="toc-probabilities-over-time-2" class="nav-link" data-scroll-target="#probabilities-over-time-2">Probabilities over Time</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#comparison" id="toc-comparison" class="nav-link" data-scroll-target="#comparison">Comparison</a>
  <ul class="collapse">
<li><a href="#probabilities-over-time-3" id="toc-probabilities-over-time-3" class="nav-link" data-scroll-target="#probabilities-over-time-3">Probabilities over Time</a></li>
  </ul>
</li>
  <li><a href="#exploration" id="toc-exploration" class="nav-link" data-scroll-target="#exploration">Exploration</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Notebook(Final)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hubert Baechli </p>
          </div>
  </div>
    
  
    
  </div>
  


</header><p><strong>Final Version</strong></p>
<p>Loading some Packages for Better Presentation of Results</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="definitions" class="level1"><h1>Definitions</h1>
<section id="initial-population" class="level2"><h2 class="anchored" data-anchor-id="initial-population">Initial Population</h2>
<section id="norm-population" class="level3"><h3 class="anchored" data-anchor-id="norm-population">Norm Population</h3>
<p>Initial Populations In line with the paper, a population is generated where the money is normally distributed with a mean of 100.</p>
<p>To save computation time, the number of agents is reduced from 5000 to 1500. Additionally, the population is sorted and assigned an ID to track them. Agents with small IDs receive the least money, while agents with large IDs have a lot of money.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nA</span> <span class="op">=</span> <span class="fl">1500</span>         <span class="co"># number of Agents</span></span>
<span><span class="va">ID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">nA</span><span class="op">)</span>  <span class="co"># ID of the Agents</span></span>
<span><span class="va">M0pop</span> <span class="op">=</span> <span class="fl">100</span>       <span class="co"># Mean amount of Money in the Start-Population</span></span>
<span></span>
<span><span class="va">PopNorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> ID <span class="op">=</span> <span class="va">ID</span>,</span>
<span>                       Money<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nA</span>, mean <span class="op">=</span> <span class="va">M0pop</span>, sd <span class="op">=</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">M0pop</span><span class="op">)</span><span class="op">)</span></span>
<span>                      <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="equal-population" class="level3"><h3 class="anchored" data-anchor-id="equal-population">Equal Population</h3>
<p>Also in line with the paper, a second population is generated where all agents start with the same amount of money.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PopEqual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> ID <span class="op">=</span> <span class="va">ID</span>,</span>
<span>                       Money <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">M0pop</span>, times <span class="op">=</span> <span class="va">nA</span><span class="op">)</span></span>
<span>                      <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="functions" class="level1"><h1>Functions</h1>
<section id="gini-faktor" class="level2"><h2 class="anchored" data-anchor-id="gini-faktor">Gini-Faktor</h2>
<p>To describe the distribution of money in the population, a function is defined to calculate the Gini coefficient.</p>
<section id="needs" class="level4"><h4 class="anchored" data-anchor-id="needs">Needs</h4>
<ol type="1">
<li>Vector with Money distribution</li>
</ol></section><section id="output" class="level4"><h4 class="anchored" data-anchor-id="output">Output</h4>
<ol type="1">
<li>Gini-Factor</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gini</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">VM</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">VM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">VM</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">VM</span><span class="op">)</span></span>
<span>  <span class="va">numer</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">numer</span> <span class="op">&lt;-</span> <span class="va">numer</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">i</span> <span class="op">*</span> <span class="va">VM</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">denom</span> <span class="op">=</span> <span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">VM</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">(</span><span class="va">numer</span> <span class="op">/</span> <span class="va">denom</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="timeline" class="level3"><h3 class="anchored" data-anchor-id="timeline">Timeline</h3>
<p>The same is also implemented as a time function.</p>
<section id="needs-1" class="level4"><h4 class="anchored" data-anchor-id="needs-1">Needs</h4>
<ol type="1">
<li>Matrix with Money distribution as vector per time</li>
</ol></section><section id="output-1" class="level4"><h4 class="anchored" data-anchor-id="output-1">Output</h4>
<ol type="1">
<li>Vector with Gini-Factor per time</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gini_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">MM</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">MM</span><span class="op">)</span></span>
<span>  <span class="va">GT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">GT</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fu">gini</span><span class="op">(</span><span class="va">MM</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">GT</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="transaction-rule" class="level2"><h2 class="anchored" data-anchor-id="transaction-rule">Transaction rule</h2>
<p>In line with the paper, a random distribution of money between two agents is defined.</p>
<section id="needs-2" class="level4"><h4 class="anchored" data-anchor-id="needs-2">Needs</h4>
<ol type="1">
<li>Nothing</li>
</ol></section><section id="output-2" class="level4"><h4 class="anchored" data-anchor-id="output-2">Output</h4>
<ol type="1">
<li>Vector with a random number and 1minus this number</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">splitpair</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rn</span>,<span class="fl">1</span><span class="op">-</span><span class="va">rn</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">splitpair</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4922818 0.5077182</code></pre>
</div>
</div>
</section></section><section id="probabilities" class="level2"><h2 class="anchored" data-anchor-id="probabilities">Probabilities</h2>
<p>Since it was suspected in the sketchbook that the reason for the outcome is the decreasing probability of meeting an agent with more or a lot of money, a function is defined here to calculate various probabilities:</p>
<ul>
<li><p>Probability of winning money (probwin)</p></li>
<li><p>Probability of having more money than the current median in the population after the exchange (probmed)</p></li>
<li><p>Probability of having more money than the mean in the population after the exchange (probmean)</p></li>
</ul>
<section id="needs-3" class="level4"><h4 class="anchored" data-anchor-id="needs-3">Needs</h4>
<ol type="1">
<li>Vector with Money distribution</li>
</ol></section><section id="output-3" class="level4"><h4 class="anchored" data-anchor-id="output-3">Output</h4>
<ol type="1">
<li><p>Summary (Sum) with minimum, maximum, median and mean for the given Money and the mention probabilities</p></li>
<li><p>Distribution (Dist) for the same values</p></li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">calc_p_s</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">VM</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Money <span class="op">=</span> <span class="va">VM</span>,</span>
<span>                     probwin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                     probmed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                     probmean <span class="op">=</span> <span class="fl">0</span></span>
<span>                     <span class="op">)</span></span>
<span>  <span class="va">Sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Money <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span></span>
<span>                              <span class="op">)</span>,</span>
<span>                    probwin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                    probmed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                    probmean <span class="op">=</span> <span class="fl">0</span></span>
<span>                    <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">Sum</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"med"</span>, <span class="st">"mean"</span><span class="op">)</span></span>
<span>  <span class="va">M_Med</span> <span class="op">&lt;-</span> <span class="va">Sum</span><span class="op">[</span><span class="st">"med"</span>, <span class="st">"Money"</span><span class="op">]</span></span>
<span>  <span class="va">M_Mean</span> <span class="op">&lt;-</span> <span class="va">Sum</span><span class="op">[</span><span class="st">"mean"</span>, <span class="st">"Money"</span><span class="op">]</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">M_A</span> <span class="op">&lt;-</span> <span class="va">Dist</span><span class="op">[</span><span class="va">i</span>,<span class="st">"Money"</span><span class="op">]</span></span>
<span>    <span class="va">M_oA</span> <span class="op">&lt;-</span> <span class="va">Dist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span><span class="op">)</span>,<span class="st">"Money"</span><span class="op">]</span></span>
<span>    <span class="va">pwin</span> <span class="op">&lt;-</span> <span class="va">M_oA</span><span class="op">*</span><span class="fl">0</span></span>
<span>    <span class="va">pmed</span> <span class="op">&lt;-</span> <span class="va">M_oA</span><span class="op">*</span><span class="fl">0</span></span>
<span>    <span class="va">pmean</span> <span class="op">&lt;-</span> <span class="va">M_oA</span><span class="op">*</span><span class="fl">0</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">M_oA</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">Pot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">M_A</span> <span class="op">+</span> <span class="va">M_oA</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span>, <span class="fl">10e-8</span><span class="op">)</span></span>
<span>      <span class="va">pwin</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">M_A</span><span class="op">/</span><span class="va">Pot</span><span class="op">)</span></span>
<span>      <span class="va">pmed</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">M_Med</span><span class="op">/</span><span class="va">Pot</span><span class="op">)</span></span>
<span>      <span class="va">pmean</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">M_Mean</span><span class="op">/</span><span class="va">Pot</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">Dist</span><span class="op">[</span><span class="va">i</span>,<span class="st">"probwin"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pwin</span><span class="op">)</span></span>
<span>    <span class="va">Dist</span><span class="op">[</span><span class="va">i</span>,<span class="st">"probmed"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pmed</span><span class="op">)</span></span>
<span>    <span class="va">Dist</span><span class="op">[</span><span class="va">i</span>,<span class="st">"probmean"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pmean</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"probwin"</span>,<span class="st">"probmed"</span>,<span class="st">"probmean"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Sum</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Sum <span class="op">=</span> <span class="va">Sum</span>, Dist <span class="op">=</span> <span class="va">Dist</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The same Function with matrix calculations, what is much faster!</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">calc_p</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">VM</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VM</span><span class="op">)</span></span>
<span>  <span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">VM</span>,times<span class="op">=</span><span class="va">n</span><span class="op">)</span>,<span class="va">n</span>,<span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">S</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">VM</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">MM</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">S</span><span class="op">[</span><span class="va">S</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10e-8</span></span>
<span>  <span class="va">pwin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">MM</span><span class="op">)</span><span class="op">/</span><span class="va">S</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">pwin</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">pmed</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">VM</span><span class="op">)</span><span class="op">/</span><span class="va">S</span><span class="op">)</span></span>
<span>  <span class="va">pmed</span><span class="op">[</span><span class="va">pmed</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">pmed</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">pmean</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">VM</span><span class="op">)</span><span class="op">/</span><span class="va">S</span><span class="op">)</span></span>
<span>  <span class="va">pmean</span><span class="op">[</span><span class="va">pmean</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">pmean</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span>  <span class="va">Dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Money <span class="op">=</span> <span class="va">VM</span>,</span>
<span>                     probwin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">pwin</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                     probmed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">pmed</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                     probmean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">pmean</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>                     <span class="op">)</span></span>
<span></span>
<span>  <span class="va">Sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Money <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">Money</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    probwin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probwin</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probwin</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probwin</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probwin</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    probmed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmed</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmed</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmed</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmed</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    probmean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmean</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmean</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmean</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dist</span><span class="op">$</span><span class="va">probmean</span><span class="op">)</span><span class="op">)</span></span>
<span>                    <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">Sum</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"med"</span>, <span class="st">"mean"</span><span class="op">)</span></span>
<span>  <span class="va">Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Sum <span class="op">=</span> <span class="va">Sum</span>, Dist <span class="op">=</span> <span class="va">Dist</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="timeline-1" class="level3"><h3 class="anchored" data-anchor-id="timeline-1">Timeline</h3>
<p>The same is also implemented as a time function.</p>
<section id="needs-4" class="level4"><h4 class="anchored" data-anchor-id="needs-4">Needs</h4>
<ol type="1">
<li>Matrix with Money distribution as vector per time ( as reported from ecosim$timeline)</li>
</ol></section><section id="output-4" class="level4"><h4 class="anchored" data-anchor-id="output-4">Output</h4>
<ol type="1">
<li>Matrix probability-values per time in colones (long form)</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">calc_p_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">MM</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pnt</span> <span class="op">&lt;-</span> <span class="fu">calc_p</span><span class="op">(</span><span class="va">MM</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">""</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">MM</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">pnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">tx</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>                     Res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">pnt</span><span class="op">$</span><span class="va">Sum</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">pnt</span><span class="op">$</span><span class="va">Sum</span><span class="op">)</span></span>
<span>                     <span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">MM</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pnt</span> <span class="op">&lt;-</span> <span class="fu">calc_p</span><span class="op">(</span><span class="va">MM</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">""</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">MM</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">pnti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">tx</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>                       Res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">pnt</span><span class="op">$</span><span class="va">Sum</span><span class="op">)</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">pnt</span><span class="op">$</span><span class="va">Sum</span><span class="op">)</span></span>
<span>                       <span class="op">)</span></span>
<span>    <span class="va">pnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">pnts</span>,<span class="va">pnti</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">pnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pnts</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="economic-simulation" class="level2"><h2 class="anchored" data-anchor-id="economic-simulation"><strong>Economic Simulation</strong></h2>
<p>Finally, a simulation is created that simulates a certain number of money exchanges.</p>
<section id="needs-5" class="level4"><h4 class="anchored" data-anchor-id="needs-5">Needs</h4>
<ol type="1">
<li><p>Number of exchanges</p></li>
<li><p>Startdistribition of Money</p></li>
<li><p>Steps for the timeline (optional)</p></li>
</ol></section><section id="output-5" class="level4"><h4 class="anchored" data-anchor-id="output-5">Output</h4>
<ol type="1">
<li><p>Summary (Sum) with ID, number of exchanges, Money at beginning and Money at the End</p></li>
<li><p>Matrix with Money distribution(Timeline) for given time steps as vectors (if steps &gt; 0)</p></li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ecosim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">n</span>, <span class="va">VM</span>, <span class="va">TL</span> <span class="op">=</span> <span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">VM</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   nE<span class="op">=</span><span class="fl">0</span>,</span>
<span>                   MT_S<span class="op">=</span><span class="va">VM</span>,</span>
<span>                   MT_E<span class="op">=</span><span class="va">VM</span></span>
<span>                   <span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">TL</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">M_TL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>n0 <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">MT_S</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">rdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">rds</span> <span class="op">&lt;-</span> <span class="fu">splitpair</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="va">rdf</span>,<span class="st">"nE"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">rdf</span>,<span class="st">"nE"</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="va">rdf</span>,<span class="st">"MT_E"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">df</span><span class="op">[</span><span class="va">rdf</span>,<span class="st">"MT_E"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">rds</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="va">TL</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span> <span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="va">TL</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">M_TL</span> <span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"n"</span>,<span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">MT_E</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Sum"</span> <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span> <span class="va">TL</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">M_TL</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span></span>
<span>    <span class="va">Output</span><span class="op">$</span><span class="va">Timeline</span> <span class="op">&lt;-</span> <span class="va">M_TL</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="plot-functions" class="level2"><h2 class="anchored" data-anchor-id="plot-functions">Plot functions</h2>
<section id="histogram" class="level3"><h3 class="anchored" data-anchor-id="histogram">Histogram</h3>
<section id="needs-6" class="level4"><h4 class="anchored" data-anchor-id="needs-6">Needs</h4>
<ol type="1">
<li>Summary of a economic Simulation</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">figHist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Sim_Sum</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Fig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Sim_Sum</span><span class="op">)</span>,</span>
<span>                      cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"MT"</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Distribution"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Money"</span></span>
<span>                      <span class="op">)</span></span>
<span>  <span class="va">Fig</span><span class="op">$</span><span class="va">Distribution</span> <span class="op">&lt;-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">Fig</span><span class="op">$</span><span class="va">Distribution</span>,</span>
<span>                            <span class="st">"MT_S"</span> <span class="op">=</span> <span class="st">"at Begining"</span>,</span>
<span>                            <span class="st">"MT_E"</span> <span class="op">=</span> <span class="st">"at the End"</span></span>
<span>                            <span class="op">)</span></span>
<span>  <span class="va">Figp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">Fig</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Money</span>, fill <span class="op">=</span> <span class="va">Distribution</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Figp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="probabilities-in-the-population" class="level3"><h3 class="anchored" data-anchor-id="probabilities-in-the-population">Probabilities in the Population</h3>
<section id="needs-7" class="level4"><h4 class="anchored" data-anchor-id="needs-7">Needs</h4>
<ol type="1">
<li><p>Probability distribution from calc_p</p></li>
<li><p>Title for the figure</p></li>
<li><p>Maximum for the x axis (Money)</p></li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">figProb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Prob</span>, <span class="va">Title</span>, <span class="va">xmax</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Figd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Prob</span><span class="op">$</span><span class="va">Dist</span><span class="op">)</span>,</span>
<span>                       cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span>,</span>
<span>                       names_to <span class="op">=</span> <span class="st">"Outcome"</span>,</span>
<span>                       values_to <span class="op">=</span> <span class="st">"Probability"</span></span>
<span>                       <span class="op">)</span></span>
<span>  <span class="va">Figs</span> <span class="op">&lt;-</span> <span class="va">Prob</span><span class="op">$</span><span class="va">Sum</span></span>
<span></span>
<span>  <span class="va">Figp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Figd</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Money</span>,</span>
<span>                     y <span class="op">=</span> <span class="va">Probability</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">Outcome</span></span>
<span>                     <span class="op">)</span></span>
<span>                 <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span> alpha <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Probability to"</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gain more than the Mean"</span>,</span>
<span>                                  <span class="st">"gain more than the Median"</span>,</span>
<span>                                  <span class="st">"gain"</span><span class="op">)</span></span>
<span>                       <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">xmax</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"med"</span>,<span class="st">"Money"</span><span class="op">]</span>,</span>
<span>               linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>             x <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"med"</span>,<span class="st">"Money"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.95</span>,</span>
<span>             y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             vjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Median\n="</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Figs</span><span class="op">[</span><span class="st">"med"</span>,<span class="st">"Money"</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"Money"</span><span class="op">]</span>,</span>
<span>               linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>             x <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"Money"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>             y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             vjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Mean\n="</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"Money"</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"probmed"</span><span class="op">]</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>             x <span class="op">=</span> <span class="va">xmax</span>,</span>
<span>             y <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"probmed"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>             hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             vjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Mean ="</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"probmed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"probmean"</span><span class="op">]</span>,</span>
<span>               linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>             x <span class="op">=</span> <span class="va">xmax</span>,</span>
<span>             y <span class="op">=</span> <span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"probmean"</span><span class="op">]</span><span class="op">*</span><span class="fl">0.95</span>,</span>
<span>             hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             vjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Mean ="</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Figs</span><span class="op">[</span><span class="st">"mean"</span>,<span class="st">"probmean"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">Title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>          legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Figp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="probabilities-over-time" class="level3"><h3 class="anchored" data-anchor-id="probabilities-over-time">Probabilities over Time</h3>
<section id="needs-8" class="level4"><h4 class="anchored" data-anchor-id="needs-8">Needs</h4>
<ol type="1">
<li><p>Probability distribution from calc_p_t</p></li>
<li><p>Title for the figure</p></li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">figProb_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Prob</span>, <span class="va">Title</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Fig</span> <span class="op">&lt;-</span> <span class="va">Prob</span><span class="op">[</span><span class="va">Prob</span><span class="op">$</span><span class="va">Res</span><span class="op">!=</span><span class="st">"Money"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>,<span class="st">"Res"</span>,<span class="st">"mean"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">Figp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Fig</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">mean</span>, color <span class="op">=</span> <span class="va">Res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gain more than the Mean"</span>,</span>
<span>                                 <span class="st">"gain more than the Median"</span>,</span>
<span>                                 <span class="st">"gain"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="va">Title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"number of exchanges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Mean-Probability in the Population"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>         legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Figp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section></section><section id="simulation-for" class="level1"><h1>Simulation for…</h1>
<section id="normal-population" class="level2"><h2 class="anchored" data-anchor-id="normal-population">Normal Population</h2>
<p>Simulation for 50000 exchanges with output after every 500th exchange.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sNorm</span> <span class="op">&lt;-</span> <span class="fu">ecosim</span><span class="op">(</span><span class="fl">50000</span>, <span class="va">PopNorm</span><span class="op">$</span><span class="va">Money</span>, TL <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="presentation-of-the-end-results" class="level3"><h3 class="anchored" data-anchor-id="presentation-of-the-end-results">Presentation of the end results</h3>
<p>At the beginning, the distribution of money in the population looks like this. After simulating 50000 money exchanges, the following distribution emerges.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig01</span> <span class="op">&lt;-</span> <span class="fu">figHist</span><span class="op">(</span><span class="va">sNorm</span><span class="op">$</span><span class="va">Sum</span><span class="op">)</span></span>
<span><span class="va">Fig01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="representation-of-money-over-time" class="level3"><h3 class="anchored" data-anchor-id="representation-of-money-over-time">Representation of Money over time</h3>
<p>It seems that every agent has the chance to have a lot of money in the end. This can be shown by tracking individual agents and their money. Below, nine agents are shown: three with little, three with 100, and three with the most money at the beginning.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MTime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">sNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="va">nA</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span>,<span class="va">nA</span><span class="op">/</span><span class="fl">2</span>,<span class="va">nA</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="fl">1</span>,<span class="va">nA</span><span class="op">-</span><span class="fl">2</span>,<span class="va">nA</span><span class="op">-</span><span class="fl">1</span>,<span class="va">nA</span><span class="op">)</span></span>
<span><span class="va">sMTime</span> <span class="op">&lt;-</span> <span class="va">MTime</span><span class="op">[</span><span class="va">sID</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">Fig02</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sMTime</span><span class="op">)</span>,</span>
<span>                      cols <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>                      names_prefix <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>                      names_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="va">as.integer</span><span class="op">)</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Money"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Fig02</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%04d"</span>, <span class="va">Fig02</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Fig02</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Money</span>, color <span class="op">=</span> <span class="va">ID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Timeline for some Agents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"number of exchanges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Agents ID"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>, <span class="fl">1</span>,<span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="probabilities-for-specific-timesteps" class="level3"><h3 class="anchored" data-anchor-id="probabilities-for-specific-timesteps">Probabilities for specific Timesteps</h3>
<p>This can also be shown with the calculated probabilities for the next meeting for each agent.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig03</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">sNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability at Beginning"</span>, <span class="fl">850</span><span class="op">)</span></span>
<span><span class="va">Fig04</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">sNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability after 500 exchanges"</span>, <span class="fl">850</span><span class="op">)</span></span>
<span><span class="va">Fig05</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">sNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability after 1000 exchanges"</span>, <span class="fl">850</span><span class="op">)</span></span>
<span><span class="va">Fig06</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">sNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">sNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability at the End"</span>, <span class="fl">850</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Initially, it seems to be a fairly fair trade, so agents with little money have a higher probability of winning money in the next exchange. However, they also have a lower probability of ending up above the median or the mean. At the beginning, all probabilities in the population are about 0.5 on average.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig03</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>However, after a few meetings, this changes. The probability of ending up above the median or the mean decreases.</p>
<p>The reason for this is that with each exchange, a rich and a poor agent are created, which decreases the probability of meeting a rich agent in the future. As a result, the median amount of money decreases.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig04</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This effect intensifies over time.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>After 50000 meetings, the distribution of probabilities in the population looks like this.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig06</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It seems that the probability of ending up above the median rises back to 0.5. However, the probability of ending up above the mean remains low.</p>
</section><section id="probabilities-over-time-1" class="level3"><h3 class="anchored" data-anchor-id="probabilities-over-time-1">Probabilities over Time</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ProbNormt</span> <span class="op">&lt;-</span> <span class="fu">calc_p_t</span><span class="op">(</span><span class="va">sNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This can be seen even better when looking at the said probabilities over time.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig07</span> <span class="op">&lt;-</span><span class="fu">figProb_t</span><span class="op">(</span><span class="va">ProbNormt</span>, <span class="st">"Probability to ... of Money - Timeline"</span><span class="op">)</span></span>
<span><span class="va">Fig07</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="equal-population-1" class="level2"><h2 class="anchored" data-anchor-id="equal-population-1">Equal Population</h2>
<p>Simulation for 50000 exchanges with output after every 250th exchange.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eNorm</span> <span class="op">&lt;-</span> <span class="fu">ecosim</span><span class="op">(</span><span class="fl">50000</span>, <span class="va">PopEqual</span><span class="op">$</span><span class="va">Money</span>, TL <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="presentation-of-the-end-results-1" class="level3"><h3 class="anchored" data-anchor-id="presentation-of-the-end-results-1">Presentation of the end results</h3>
<p>At first glance, it seems illogical that a population where everyone starts with the same amount of money would result in a similar final distribution of money. However, the simulation proves this.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig08</span> <span class="op">&lt;-</span> <span class="fu">figHist</span><span class="op">(</span><span class="va">eNorm</span><span class="op">$</span><span class="va">Sum</span><span class="op">)</span></span>
<span><span class="va">Fig08</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="probabilities-for-specific-timesteps-1" class="level3"><h3 class="anchored" data-anchor-id="probabilities-for-specific-timesteps-1">Probabilities for specific Timesteps</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig09</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">eNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability at Beginning"</span>, <span class="fl">850</span><span class="op">)</span></span>
<span><span class="va">Fig10</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">eNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability after 500 exchanges"</span>, <span class="fl">850</span><span class="op">)</span></span>
<span><span class="va">Fig11</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">eNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability after 1000 exchanges"</span>, <span class="fl">850</span><span class="op">)</span></span>
<span><span class="va">Fig12</span> <span class="op">&lt;-</span> <span class="fu">figProb</span><span class="op">(</span><span class="fu">calc_p</span><span class="op">(</span><span class="va">eNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">eNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                <span class="st">"Probability at the End"</span>, <span class="fl">850</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>At the beginning, all probabilities are exactly 0.5.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig09</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>However, the same mechanism applies here. With each exchange, a rich and a poor agent are created.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Therefore, the probability of meeting a rich agent in the future also decreases here. As a result, the probability of ending up above the median or the mean decreases here as well.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>After 50000 meetings, the distribution of probabilities in this population looks almost identical.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="probabilities-over-time-2" class="level3"><h3 class="anchored" data-anchor-id="probabilities-over-time-2">Probabilities over Time</h3>
<p>This is even more evident over time.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ProbEqualt</span> <span class="op">&lt;-</span> <span class="fu">calc_p_t</span><span class="op">(</span><span class="va">eNorm</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>However, it seems that the median amount of money remains stable a bit longer.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig13</span> <span class="op">&lt;-</span> <span class="fu">figProb_t</span><span class="op">(</span><span class="va">ProbEqualt</span>, <span class="st">"Probability to ... of Money - Timeline"</span><span class="op">)</span></span>
<span><span class="va">Fig13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="comparison" class="level1"><h1>Comparison</h1>
<p>To better compare the two populations, two new simulations are conducted. The number is restricted to the interesting initial range, and the time resolution is increased.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sNorms</span> <span class="op">&lt;-</span> <span class="fu">ecosim</span><span class="op">(</span><span class="fl">8000</span>, <span class="va">PopNorm</span><span class="op">$</span><span class="va">Money</span>, TL <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">ProbNormts</span> <span class="op">&lt;-</span> <span class="fu">calc_p_t</span><span class="op">(</span><span class="va">sNorms</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span></span>
<span><span class="va">eNorms</span> <span class="op">&lt;-</span> <span class="fu">ecosim</span><span class="op">(</span><span class="fl">8000</span>, <span class="va">PopEqual</span><span class="op">$</span><span class="va">Money</span>, TL <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">ProbEqualts</span> <span class="op">&lt;-</span> <span class="fu">calc_p_t</span><span class="op">(</span><span class="va">eNorms</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="probabilities-over-time-3" class="level3"><h3 class="anchored" data-anchor-id="probabilities-over-time-3">Probabilities over Time</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig14</span> <span class="op">&lt;-</span> <span class="fu">figProb_t</span><span class="op">(</span><span class="va">ProbNormts</span>, </span>
<span>          <span class="st">"Probability to ... of Money\nTimeline for the Norm Population"</span><span class="op">)</span></span>
<span><span class="va">Fig15</span> <span class="op">&lt;-</span> <span class="fu">figProb_t</span><span class="op">(</span><span class="va">ProbEqualts</span>, </span>
<span>          <span class="st">"Probability to ... of Money\nTimeline for a equal Population"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It actually shows that in the population with the normal distribution, the probabilities for the median and the mean separate earlier.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the population with the same initial amount of money, the two lines remain very close together, meaning that the median and mean amounts of money remain almost identical.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This makes sense because the meetings are random, and therefore some agents keep their starting balance of 100 longer. After 2500 meetings, or about two meetings per agent, this becomes increasingly unlikely.</p>
</section></section><section id="exploration" class="level1"><h1>Exploration</h1>
<p>Since I have not yet used the Gini coefficient described in the article, it is now plotted over time for the two populations.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig16</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> Time <span class="op">=</span> <span class="va">ProbNormts</span><span class="op">[</span><span class="va">ProbNormts</span><span class="op">$</span><span class="va">Res</span> <span class="op">==</span> <span class="st">"Money"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                    Norm <span class="op">=</span> <span class="fu">gini_t</span><span class="op">(</span><span class="va">sNorms</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span>,</span>
<span>                    Equal <span class="op">=</span> <span class="fu">gini_t</span><span class="op">(</span><span class="va">eNorms</span><span class="op">$</span><span class="va">Timeline</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="va">Fig16</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Fig16</span><span class="op">)</span>,</span>
<span>                      cols <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Pop"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Gini"</span></span>
<span>                      <span class="op">)</span></span>
<span>                    </span>
<span><span class="va">Fig16p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Fig16</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Gini</span>, color <span class="op">=</span> <span class="va">Pop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Start Population"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Gini-Faktor - Timeline"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"number of exchanges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Gini"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Fig16p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It seems that the course is quite similar to the course of the probability of ending up above the mean of the distribution. A closer look shows that the reciprocal of the Gini coefficient matches quite well with the probability of ending up above the mean of the distribution.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Fig17</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> Time <span class="op">=</span> <span class="va">ProbNormts</span><span class="op">[</span><span class="va">ProbNormts</span><span class="op">$</span><span class="va">Res</span> <span class="op">==</span> <span class="st">"Money"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                    GNorm <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">Fig16</span><span class="op">[</span><span class="va">Fig16</span><span class="op">$</span><span class="va">Pop</span> <span class="op">==</span> <span class="st">"Norm"</span>,<span class="st">"Gini"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    PNorm <span class="op">=</span> <span class="va">ProbNormts</span><span class="op">[</span><span class="va">ProbNormts</span><span class="op">$</span><span class="va">Res</span> <span class="op">==</span> <span class="st">"probmean"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                    GEqual <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">Fig16</span><span class="op">[</span><span class="va">Fig16</span><span class="op">$</span><span class="va">Pop</span> <span class="op">==</span> <span class="st">"Equal"</span>,<span class="st">"Gini"</span><span class="op">]</span>,</span>
<span>                    PEqual <span class="op">=</span> <span class="va">ProbEqualts</span><span class="op">[</span><span class="va">ProbEqualts</span><span class="op">$</span><span class="va">Res</span> <span class="op">==</span> <span class="st">"probmean"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span><span class="op">]</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">Fig17</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"GNorm"</span>, <span class="st">"PNorm"</span>, <span class="st">"GEqual"</span>, <span class="st">"PEqual"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Fig17</span><span class="op">$</span><span class="va">Faktn</span> <span class="op">&lt;-</span> <span class="va">Fig17</span><span class="op">$</span><span class="va">GNorm</span><span class="op">/</span><span class="va">Fig17</span><span class="op">$</span><span class="va">PNorm</span></span>
<span><span class="va">Fig17</span><span class="op">$</span><span class="va">Fakte</span> <span class="op">&lt;-</span> <span class="va">Fig17</span><span class="op">$</span><span class="va">GEqual</span><span class="op">/</span><span class="va">Fig17</span><span class="op">$</span><span class="va">PEqual</span></span>
<span></span>
<span><span class="va">Fig17</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Fig17</span><span class="op">)</span>,</span>
<span>                      cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"F"</span><span class="op">)</span>,</span>
<span>                      names_to <span class="op">=</span> <span class="st">"Pop"</span>,</span>
<span>                      values_to <span class="op">=</span> <span class="st">"Fakt"</span></span>
<span>                      <span class="op">)</span></span>
<span></span>
<span><span class="va">Fig17p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Fig17</span>, </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Fakt</span>, color <span class="op">=</span> <span class="va">Pop</span>, linetype <span class="op">=</span> <span class="va">Pop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Start Population"</span>, </span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Equal"</span>, <span class="st">"Norm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_linetype_manual</a></span><span class="op">(</span><span class="st">"Start Population"</span>,</span>
<span>                        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solid"</span>, <span class="st">"dashed"</span><span class="op">)</span>,</span>
<span>                        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Equal"</span>, <span class="st">"Norm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Relation between\n </span></span>
<span><span class="st">          Probability to gain more than the Mean\n</span></span>
<span><span class="st">          and (1-Gini) - Timeline"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"number of exchanges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Faktor"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Fig17p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notebook_final_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>This could potentially allow for the development of a mathematical model for this mechanism. However, this exceeds my abilities and will be left to more capable individuals.</em></strong></p>


<!-- -->

</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb40" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Notebook(Final)"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Hubert Baechli"</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>**Final Version**</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>Loading some Packages for Better Presentation of Results</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># Definitions</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Initial Population</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="fu">### Norm Population</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>Initial Populations In line with the paper, a population is generated where the money is normally distributed with a mean of 100.</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>To save computation time, the number of agents is reduced from 5000 to 1500. Additionally, the population is sorted and assigned an ID to track them. Agents with small IDs receive the least money, while agents with large IDs have a lot of money.</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>nA <span class="ot">=</span> <span class="dv">1500</span>         <span class="co"># number of Agents</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">=</span> <span class="fu">seq_len</span>(nA)  <span class="co"># ID of the Agents</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>M0pop <span class="ot">=</span> <span class="dv">100</span>       <span class="co"># Mean amount of Money in the Start-Population</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>PopNorm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">ID =</span> ID,</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Money=</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(nA, <span class="at">mean =</span> M0pop, <span class="at">sd =</span> <span class="fl">0.2</span> <span class="sc">*</span> M0pop))</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equal Population</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>Also in line with the paper, a second population is generated where all agents start with the same amount of money.</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>PopEqual <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">ID =</span> ID,</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Money =</span> <span class="fu">rep</span>(M0pop, <span class="at">times =</span> nA)</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a><span class="fu"># Functions</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gini-Faktor</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>To describe the distribution of money in the population, a function is defined to calculate the Gini coefficient.</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Vector with Money distribution</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Output</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Gini-Factor</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>gini <span class="ot">&lt;-</span> <span class="cf">function</span>(VM) {</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>  VM <span class="ot">&lt;-</span> <span class="fu">sort</span>(VM)</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">NROW</span>(VM)</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>  numer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>    numer <span class="ot">&lt;-</span> numer <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> i <span class="sc">*</span> VM[i]</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>  denom <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">sum</span>(VM)</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((numer <span class="sc">/</span> denom) <span class="sc">-</span> (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n)</span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a><span class="fu">### Timeline</span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>The same is also implemented as a time function.</span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Matrix with Money distribution as vector per time</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Output</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Vector with Gini-Factor per time</span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>gini_t <span class="ot">&lt;-</span> <span class="cf">function</span>(MM) {</span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">NCOL</span>(MM)</span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a>  GT <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a>    GT[i] <span class="ot">&lt;-</span>  <span class="fu">gini</span>(MM[,i])</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(GT)</span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Transaction rule</span></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>In line with the paper, a random distribution of money between two agents is defined.</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Nothing</span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Output</span></span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Vector with a random number and 1minus this number</span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a>splitpair <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a>  rn <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(rn,<span class="dv">1</span><span class="sc">-</span>rn)</span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a><span class="fu">splitpair</span>()</span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a><span class="fu">## Probabilities</span></span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a>Since it was suspected in the sketchbook that the reason for the outcome is the decreasing probability of meeting an agent with more or a lot of money, a function is defined here to calculate various probabilities:</span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Probability of winning money (probwin)</span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Probability of having more money than the current median in the population after the exchange (probmed)</span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Probability of having more money than the mean in the population after the exchange (probmean)</span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Vector with Money distribution</span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Output</span></span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Summary (Sum) with minimum, maximum, median and mean for the given Money and the mention probabilities</span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Distribution (Dist) for the same values</span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a>calc_p_s <span class="ot">&lt;-</span> <span class="cf">function</span>(VM) {</span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>  Dist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Money =</span> VM,</span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>                     <span class="at">probwin =</span> <span class="dv">0</span>,</span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>                     <span class="at">probmed =</span> <span class="dv">0</span>,</span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>                     <span class="at">probmean =</span> <span class="dv">0</span></span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>  Sum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Money =</span> <span class="fu">c</span>(<span class="fu">min</span>(Dist<span class="sc">$</span>Money),</span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">max</span>(Dist<span class="sc">$</span>Money),</span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">median</span>(Dist<span class="sc">$</span>Money),</span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(Dist<span class="sc">$</span>Money)</span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a>                              ),</span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a>                    <span class="at">probwin =</span> <span class="dv">0</span>,</span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>                    <span class="at">probmed =</span> <span class="dv">0</span>,</span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a>                    <span class="at">probmean =</span> <span class="dv">0</span></span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(Sum) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"med"</span>, <span class="st">"mean"</span>)</span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>  M_Med <span class="ot">&lt;-</span> Sum[<span class="st">"med"</span>, <span class="st">"Money"</span>]</span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>  M_Mean <span class="ot">&lt;-</span> Sum[<span class="st">"mean"</span>, <span class="st">"Money"</span>]</span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Dist)) {</span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a>    M_A <span class="ot">&lt;-</span> Dist[i,<span class="st">"Money"</span>]</span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a>    M_oA <span class="ot">&lt;-</span> Dist[<span class="fu">c</span>(<span class="sc">-</span>i),<span class="st">"Money"</span>]</span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a>    pwin <span class="ot">&lt;-</span> M_oA<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a>    pmed <span class="ot">&lt;-</span> M_oA<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a>    pmean <span class="ot">&lt;-</span> M_oA<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(ii <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(M_oA)) {</span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a>      Pot <span class="ot">&lt;-</span> <span class="fu">max</span>(M_A <span class="sc">+</span> M_oA[ii], <span class="fl">10e-8</span>)</span>
<span id="cb40-177"><a href="#cb40-177" aria-hidden="true" tabindex="-1"></a>      pwin[ii] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">min</span>(<span class="dv">1</span>, M_A<span class="sc">/</span>Pot)</span>
<span id="cb40-178"><a href="#cb40-178" aria-hidden="true" tabindex="-1"></a>      pmed[ii] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">min</span>(<span class="dv">1</span>, M_Med<span class="sc">/</span>Pot)</span>
<span id="cb40-179"><a href="#cb40-179" aria-hidden="true" tabindex="-1"></a>      pmean[ii] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">min</span>(<span class="dv">1</span>, M_Mean<span class="sc">/</span>Pot)</span>
<span id="cb40-180"><a href="#cb40-180" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a>    Dist[i,<span class="st">"probwin"</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pwin)</span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a>    Dist[i,<span class="st">"probmed"</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pmed)</span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a>    Dist[i,<span class="st">"probmean"</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pmean)</span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"probwin"</span>,<span class="st">"probmed"</span>,<span class="st">"probmean"</span>)) {</span>
<span id="cb40-186"><a href="#cb40-186" aria-hidden="true" tabindex="-1"></a>    Sum[[i]] <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">min</span>(Dist[[i]]),</span>
<span id="cb40-187"><a href="#cb40-187" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">max</span>(Dist[[i]]),</span>
<span id="cb40-188"><a href="#cb40-188" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">median</span>(Dist[[i]]),</span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mean</span>(Dist[[i]])</span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a>  Output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Sum =</span> Sum, <span class="at">Dist =</span> Dist)</span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Output)</span>
<span id="cb40-195"><a href="#cb40-195" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-196"><a href="#cb40-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a>The same Function with matrix calculations, what is much faster!</span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a>calc_p <span class="ot">&lt;-</span> <span class="cf">function</span>(VM) {</span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(VM)</span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a>  MM <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(VM,<span class="at">times=</span>n),n,n)</span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> (VM<span class="sc">+</span><span class="fu">t</span>(MM))</span>
<span id="cb40-207"><a href="#cb40-207" aria-hidden="true" tabindex="-1"></a>  S[S<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">10e-8</span></span>
<span id="cb40-208"><a href="#cb40-208" aria-hidden="true" tabindex="-1"></a>  pwin <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">t</span>(MM)<span class="sc">/</span>S)</span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>(pwin) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a>  pmed <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">median</span>(VM)<span class="sc">/</span>S)</span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a>  pmed[pmed<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>(pmed) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a>  pmean <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">mean</span>(VM)<span class="sc">/</span>S)</span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a>  pmean[pmean<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>(pmean) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a>  Dist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Money =</span> VM,</span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a>                     <span class="at">probwin =</span> <span class="fu">colSums</span>(pwin)<span class="sc">/</span>(n<span class="dv">-1</span>),</span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a>                     <span class="at">probmed =</span> <span class="fu">colSums</span>(pmed)<span class="sc">/</span>(n<span class="dv">-1</span>),</span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a>                     <span class="at">probmean =</span> <span class="fu">colSums</span>(pmean)<span class="sc">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a>  Sum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Money =</span> <span class="fu">c</span>(<span class="fu">min</span>(Dist<span class="sc">$</span>Money),</span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">max</span>(Dist<span class="sc">$</span>Money),</span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">median</span>(Dist<span class="sc">$</span>Money),</span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(Dist<span class="sc">$</span>Money)),</span>
<span id="cb40-227"><a href="#cb40-227" aria-hidden="true" tabindex="-1"></a>                    <span class="at">probwin =</span> <span class="fu">c</span>(<span class="fu">min</span>(Dist<span class="sc">$</span>probwin),</span>
<span id="cb40-228"><a href="#cb40-228" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">max</span>(Dist<span class="sc">$</span>probwin),</span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">median</span>(Dist<span class="sc">$</span>probwin),</span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">mean</span>(Dist<span class="sc">$</span>probwin)),</span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a>                    <span class="at">probmed =</span> <span class="fu">c</span>(<span class="fu">min</span>(Dist<span class="sc">$</span>probmed),</span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">max</span>(Dist<span class="sc">$</span>probmed),</span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">median</span>(Dist<span class="sc">$</span>probmed),</span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">mean</span>(Dist<span class="sc">$</span>probmed)),</span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a>                    <span class="at">probmean =</span> <span class="fu">c</span>(<span class="fu">min</span>(Dist<span class="sc">$</span>probmean),</span>
<span id="cb40-236"><a href="#cb40-236" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">max</span>(Dist<span class="sc">$</span>probmean),</span>
<span id="cb40-237"><a href="#cb40-237" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">median</span>(Dist<span class="sc">$</span>probmean),</span>
<span id="cb40-238"><a href="#cb40-238" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">mean</span>(Dist<span class="sc">$</span>probmean))</span>
<span id="cb40-239"><a href="#cb40-239" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb40-240"><a href="#cb40-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-241"><a href="#cb40-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(Sum) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"med"</span>, <span class="st">"mean"</span>)</span>
<span id="cb40-242"><a href="#cb40-242" aria-hidden="true" tabindex="-1"></a>  Output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Sum =</span> Sum, <span class="at">Dist =</span> Dist)</span>
<span id="cb40-243"><a href="#cb40-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Output)</span>
<span id="cb40-244"><a href="#cb40-244" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-245"><a href="#cb40-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-246"><a href="#cb40-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-247"><a href="#cb40-247" aria-hidden="true" tabindex="-1"></a><span class="fu">### Timeline</span></span>
<span id="cb40-248"><a href="#cb40-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-249"><a href="#cb40-249" aria-hidden="true" tabindex="-1"></a>The same is also implemented as a time function.</span>
<span id="cb40-250"><a href="#cb40-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-251"><a href="#cb40-251" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-252"><a href="#cb40-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-253"><a href="#cb40-253" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Matrix with Money distribution as vector per time ( as reported from ecosim\$timeline)</span>
<span id="cb40-254"><a href="#cb40-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-255"><a href="#cb40-255" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Output</span></span>
<span id="cb40-256"><a href="#cb40-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-257"><a href="#cb40-257" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Matrix probability-values per time in colones (long form)</span>
<span id="cb40-258"><a href="#cb40-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-261"><a href="#cb40-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-262"><a href="#cb40-262" aria-hidden="true" tabindex="-1"></a>calc_p_t <span class="ot">&lt;-</span> <span class="cf">function</span>(MM) {</span>
<span id="cb40-263"><a href="#cb40-263" aria-hidden="true" tabindex="-1"></a>  pnt <span class="ot">&lt;-</span> <span class="fu">calc_p</span>(MM[,<span class="dv">1</span>])</span>
<span id="cb40-264"><a href="#cb40-264" aria-hidden="true" tabindex="-1"></a>  tx <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"n"</span>, <span class="st">""</span>,<span class="fu">colnames</span>(MM)[<span class="dv">1</span>]))</span>
<span id="cb40-265"><a href="#cb40-265" aria-hidden="true" tabindex="-1"></a>  pnts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Time =</span> <span class="fu">rep</span>(tx, <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb40-266"><a href="#cb40-266" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Res =</span> <span class="fu">colnames</span>(pnt<span class="sc">$</span>Sum),</span>
<span id="cb40-267"><a href="#cb40-267" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">t</span>(pnt<span class="sc">$</span>Sum)</span>
<span id="cb40-268"><a href="#cb40-268" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb40-269"><a href="#cb40-269" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(MM)) {</span>
<span id="cb40-270"><a href="#cb40-270" aria-hidden="true" tabindex="-1"></a>    pnt <span class="ot">&lt;-</span> <span class="fu">calc_p</span>(MM[,i])</span>
<span id="cb40-271"><a href="#cb40-271" aria-hidden="true" tabindex="-1"></a>    tx <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"n"</span>, <span class="st">""</span>,<span class="fu">colnames</span>(MM)[i]))</span>
<span id="cb40-272"><a href="#cb40-272" aria-hidden="true" tabindex="-1"></a>    pnti <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Time =</span> <span class="fu">rep</span>(tx, <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb40-273"><a href="#cb40-273" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Res =</span> <span class="fu">colnames</span>(pnt<span class="sc">$</span>Sum),</span>
<span id="cb40-274"><a href="#cb40-274" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">t</span>(pnt<span class="sc">$</span>Sum)</span>
<span id="cb40-275"><a href="#cb40-275" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb40-276"><a href="#cb40-276" aria-hidden="true" tabindex="-1"></a>    pnts <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pnts,pnti)</span>
<span id="cb40-277"><a href="#cb40-277" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-278"><a href="#cb40-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(pnts) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb40-279"><a href="#cb40-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pnts)</span>
<span id="cb40-280"><a href="#cb40-280" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-281"><a href="#cb40-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-282"><a href="#cb40-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-283"><a href="#cb40-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Economic Simulation**</span></span>
<span id="cb40-284"><a href="#cb40-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-285"><a href="#cb40-285" aria-hidden="true" tabindex="-1"></a>Finally, a simulation is created that simulates a certain number of money exchanges.</span>
<span id="cb40-286"><a href="#cb40-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-287"><a href="#cb40-287" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-288"><a href="#cb40-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-289"><a href="#cb40-289" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Number of exchanges</span>
<span id="cb40-290"><a href="#cb40-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-291"><a href="#cb40-291" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Startdistribition of Money</span>
<span id="cb40-292"><a href="#cb40-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-293"><a href="#cb40-293" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Steps for the timeline (optional)</span>
<span id="cb40-294"><a href="#cb40-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-295"><a href="#cb40-295" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Output</span></span>
<span id="cb40-296"><a href="#cb40-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-297"><a href="#cb40-297" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Summary (Sum) with ID, number of exchanges, Money at beginning and Money at the End</span>
<span id="cb40-298"><a href="#cb40-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-299"><a href="#cb40-299" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Matrix with Money distribution(Timeline) for given time steps as vectors (if steps <span class="sc">\&gt;</span> 0)</span>
<span id="cb40-300"><a href="#cb40-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-303"><a href="#cb40-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-304"><a href="#cb40-304" aria-hidden="true" tabindex="-1"></a>ecosim <span class="ot">&lt;-</span> <span class="cf">function</span>( n, VM, <span class="at">TL =</span> <span class="dv">0</span> ) {</span>
<span id="cb40-305"><a href="#cb40-305" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">NROW</span>(VM)),</span>
<span id="cb40-306"><a href="#cb40-306" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nE=</span><span class="dv">0</span>,</span>
<span id="cb40-307"><a href="#cb40-307" aria-hidden="true" tabindex="-1"></a>                   <span class="at">MT_S=</span>VM,</span>
<span id="cb40-308"><a href="#cb40-308" aria-hidden="true" tabindex="-1"></a>                   <span class="at">MT_E=</span>VM</span>
<span id="cb40-309"><a href="#cb40-309" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb40-310"><a href="#cb40-310" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (TL <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb40-311"><a href="#cb40-311" aria-hidden="true" tabindex="-1"></a>    M_TL <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n0 =</span> df<span class="sc">$</span>MT_S)</span>
<span id="cb40-312"><a href="#cb40-312" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-313"><a href="#cb40-313" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb40-314"><a href="#cb40-314" aria-hidden="true" tabindex="-1"></a>    rdf <span class="ot">&lt;-</span> <span class="fu">sample</span>(df<span class="sc">$</span>ID, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb40-315"><a href="#cb40-315" aria-hidden="true" tabindex="-1"></a>    rds <span class="ot">&lt;-</span> <span class="fu">splitpair</span>()</span>
<span id="cb40-316"><a href="#cb40-316" aria-hidden="true" tabindex="-1"></a>    df[rdf,<span class="st">"nE"</span>] <span class="ot">&lt;-</span> df[rdf,<span class="st">"nE"</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb40-317"><a href="#cb40-317" aria-hidden="true" tabindex="-1"></a>    df[rdf,<span class="st">"MT_E"</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>( df[rdf,<span class="st">"MT_E"</span>]) <span class="sc">*</span> rds</span>
<span id="cb40-318"><a href="#cb40-318" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ( TL <span class="sc">&gt;</span> <span class="dv">0</span> ) {</span>
<span id="cb40-319"><a href="#cb40-319" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ( i <span class="sc">%%</span> TL <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb40-320"><a href="#cb40-320" aria-hidden="true" tabindex="-1"></a>        M_TL [[<span class="fu">paste0</span>(<span class="st">"n"</span>,i)]]<span class="ot">&lt;-</span> df<span class="sc">$</span>MT_E</span>
<span id="cb40-321"><a href="#cb40-321" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb40-322"><a href="#cb40-322" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-323"><a href="#cb40-323" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-324"><a href="#cb40-324" aria-hidden="true" tabindex="-1"></a>  Output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Sum"</span> <span class="ot">=</span> df)</span>
<span id="cb40-325"><a href="#cb40-325" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ( TL <span class="sc">&gt;</span> <span class="dv">0</span> ) {</span>
<span id="cb40-326"><a href="#cb40-326" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(M_TL) <span class="ot">&lt;-</span> df<span class="sc">$</span>ID</span>
<span id="cb40-327"><a href="#cb40-327" aria-hidden="true" tabindex="-1"></a>    Output<span class="sc">$</span>Timeline <span class="ot">&lt;-</span> M_TL</span>
<span id="cb40-328"><a href="#cb40-328" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-329"><a href="#cb40-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Output)</span>
<span id="cb40-330"><a href="#cb40-330" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-331"><a href="#cb40-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-332"><a href="#cb40-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-333"><a href="#cb40-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot functions</span></span>
<span id="cb40-334"><a href="#cb40-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-335"><a href="#cb40-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histogram</span></span>
<span id="cb40-336"><a href="#cb40-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-337"><a href="#cb40-337" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-338"><a href="#cb40-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-339"><a href="#cb40-339" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Summary of a economic Simulation</span>
<span id="cb40-340"><a href="#cb40-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-343"><a href="#cb40-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-344"><a href="#cb40-344" aria-hidden="true" tabindex="-1"></a>figHist <span class="ot">&lt;-</span> <span class="cf">function</span>(Sim_Sum) {</span>
<span id="cb40-345"><a href="#cb40-345" aria-hidden="true" tabindex="-1"></a>  Fig <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="fu">data.frame</span>(Sim_Sum),</span>
<span id="cb40-346"><a href="#cb40-346" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"MT"</span>),</span>
<span id="cb40-347"><a href="#cb40-347" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"Distribution"</span>,</span>
<span id="cb40-348"><a href="#cb40-348" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"Money"</span></span>
<span id="cb40-349"><a href="#cb40-349" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb40-350"><a href="#cb40-350" aria-hidden="true" tabindex="-1"></a>  Fig<span class="sc">$</span>Distribution <span class="ot">&lt;-</span><span class="fu">recode</span>(Fig<span class="sc">$</span>Distribution,</span>
<span id="cb40-351"><a href="#cb40-351" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"MT_S"</span> <span class="ot">=</span> <span class="st">"at Begining"</span>,</span>
<span id="cb40-352"><a href="#cb40-352" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"MT_E"</span> <span class="ot">=</span> <span class="st">"at the End"</span></span>
<span id="cb40-353"><a href="#cb40-353" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb40-354"><a href="#cb40-354" aria-hidden="true" tabindex="-1"></a>  Figp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Fig, <span class="fu">aes</span>(<span class="at">x =</span> Money, <span class="at">fill =</span> Distribution)) <span class="sc">+</span></span>
<span id="cb40-355"><a href="#cb40-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb40-356"><a href="#cb40-356" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb40-357"><a href="#cb40-357" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb40-358"><a href="#cb40-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb40-359"><a href="#cb40-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-360"><a href="#cb40-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb40-361"><a href="#cb40-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Figp)</span>
<span id="cb40-362"><a href="#cb40-362" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-363"><a href="#cb40-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-364"><a href="#cb40-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-365"><a href="#cb40-365" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilities in the Population</span></span>
<span id="cb40-366"><a href="#cb40-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-367"><a href="#cb40-367" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-368"><a href="#cb40-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-369"><a href="#cb40-369" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Probability distribution from calc_p</span>
<span id="cb40-370"><a href="#cb40-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-371"><a href="#cb40-371" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Title for the figure</span>
<span id="cb40-372"><a href="#cb40-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-373"><a href="#cb40-373" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Maximum for the x axis (Money)</span>
<span id="cb40-374"><a href="#cb40-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-377"><a href="#cb40-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-378"><a href="#cb40-378" aria-hidden="true" tabindex="-1"></a>figProb <span class="ot">&lt;-</span> <span class="cf">function</span>(Prob, Title, xmax) {</span>
<span id="cb40-379"><a href="#cb40-379" aria-hidden="true" tabindex="-1"></a>  Figd <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="fu">data.frame</span>(Prob<span class="sc">$</span>Dist),</span>
<span id="cb40-380"><a href="#cb40-380" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"p"</span>),</span>
<span id="cb40-381"><a href="#cb40-381" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names_to =</span> <span class="st">"Outcome"</span>,</span>
<span id="cb40-382"><a href="#cb40-382" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values_to =</span> <span class="st">"Probability"</span></span>
<span id="cb40-383"><a href="#cb40-383" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb40-384"><a href="#cb40-384" aria-hidden="true" tabindex="-1"></a>  Figs <span class="ot">&lt;-</span> Prob<span class="sc">$</span>Sum</span>
<span id="cb40-385"><a href="#cb40-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-386"><a href="#cb40-386" aria-hidden="true" tabindex="-1"></a>  Figp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> Figd,</span>
<span id="cb40-387"><a href="#cb40-387" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> Money,</span>
<span id="cb40-388"><a href="#cb40-388" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> Probability,</span>
<span id="cb40-389"><a href="#cb40-389" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> Outcome</span>
<span id="cb40-390"><a href="#cb40-390" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb40-391"><a href="#cb40-391" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">+</span></span>
<span id="cb40-392"><a href="#cb40-392" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>( <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb40-393"><a href="#cb40-393" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Probability to"</span>,</span>
<span id="cb40-394"><a href="#cb40-394" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb40-395"><a href="#cb40-395" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"gain more than the Mean"</span>,</span>
<span id="cb40-396"><a href="#cb40-396" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"gain more than the Median"</span>,</span>
<span id="cb40-397"><a href="#cb40-397" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"gain"</span>)</span>
<span id="cb40-398"><a href="#cb40-398" aria-hidden="true" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb40-399"><a href="#cb40-399" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-400"><a href="#cb40-400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">0</span>, xmax) <span class="sc">+</span></span>
<span id="cb40-401"><a href="#cb40-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-402"><a href="#cb40-402" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> Figs[<span class="st">"med"</span>,<span class="st">"Money"</span>],</span>
<span id="cb40-403"><a href="#cb40-403" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-404"><a href="#cb40-404" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb40-405"><a href="#cb40-405" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> Figs[<span class="st">"med"</span>,<span class="st">"Money"</span>] <span class="sc">*</span> <span class="fl">0.95</span>,</span>
<span id="cb40-406"><a href="#cb40-406" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb40-407"><a href="#cb40-407" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb40-408"><a href="#cb40-408" aria-hidden="true" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb40-409"><a href="#cb40-409" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Median</span><span class="sc">\n</span><span class="st">="</span>,</span>
<span id="cb40-410"><a href="#cb40-410" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">round</span>(Figs[<span class="st">"med"</span>,<span class="st">"Money"</span>], <span class="dv">0</span>)),</span>
<span id="cb40-411"><a href="#cb40-411" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-412"><a href="#cb40-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-413"><a href="#cb40-413" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> Figs[<span class="st">"mean"</span>,<span class="st">"Money"</span>],</span>
<span id="cb40-414"><a href="#cb40-414" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-415"><a href="#cb40-415" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb40-416"><a href="#cb40-416" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> Figs[<span class="st">"mean"</span>,<span class="st">"Money"</span>] <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb40-417"><a href="#cb40-417" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb40-418"><a href="#cb40-418" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb40-419"><a href="#cb40-419" aria-hidden="true" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb40-420"><a href="#cb40-420" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Mean</span><span class="sc">\n</span><span class="st">="</span>,</span>
<span id="cb40-421"><a href="#cb40-421" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">round</span>(Figs[<span class="st">"mean"</span>,<span class="st">"Money"</span>], <span class="dv">0</span>)),</span>
<span id="cb40-422"><a href="#cb40-422" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-423"><a href="#cb40-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-424"><a href="#cb40-424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> Figs[<span class="st">"mean"</span>,<span class="st">"probmed"</span>],</span>
<span id="cb40-425"><a href="#cb40-425" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb40-426"><a href="#cb40-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb40-427"><a href="#cb40-427" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> xmax,</span>
<span id="cb40-428"><a href="#cb40-428" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Figs[<span class="st">"mean"</span>,<span class="st">"probmed"</span>] <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb40-429"><a href="#cb40-429" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb40-430"><a href="#cb40-430" aria-hidden="true" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb40-431"><a href="#cb40-431" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Mean ="</span>,</span>
<span id="cb40-432"><a href="#cb40-432" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">round</span>(Figs[<span class="st">"mean"</span>,<span class="st">"probmed"</span>], <span class="dv">2</span>)),</span>
<span id="cb40-433"><a href="#cb40-433" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb40-434"><a href="#cb40-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-435"><a href="#cb40-435" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> Figs[<span class="st">"mean"</span>,<span class="st">"probmean"</span>],</span>
<span id="cb40-436"><a href="#cb40-436" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb40-437"><a href="#cb40-437" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb40-438"><a href="#cb40-438" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> xmax,</span>
<span id="cb40-439"><a href="#cb40-439" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Figs[<span class="st">"mean"</span>,<span class="st">"probmean"</span>]<span class="sc">*</span><span class="fl">0.95</span>,</span>
<span id="cb40-440"><a href="#cb40-440" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb40-441"><a href="#cb40-441" aria-hidden="true" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb40-442"><a href="#cb40-442" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Mean ="</span>,</span>
<span id="cb40-443"><a href="#cb40-443" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">round</span>(Figs[<span class="st">"mean"</span>,<span class="st">"probmean"</span>], <span class="dv">2</span>)),</span>
<span id="cb40-444"><a href="#cb40-444" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb40-445"><a href="#cb40-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-446"><a href="#cb40-446" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> Title) <span class="sc">+</span></span>
<span id="cb40-447"><a href="#cb40-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb40-448"><a href="#cb40-448" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb40-449"><a href="#cb40-449" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-450"><a href="#cb40-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Figp)</span>
<span id="cb40-451"><a href="#cb40-451" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-452"><a href="#cb40-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-453"><a href="#cb40-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-454"><a href="#cb40-454" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilities over Time</span></span>
<span id="cb40-455"><a href="#cb40-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-456"><a href="#cb40-456" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Needs</span></span>
<span id="cb40-457"><a href="#cb40-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-458"><a href="#cb40-458" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Probability distribution from calc_p_t</span>
<span id="cb40-459"><a href="#cb40-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-460"><a href="#cb40-460" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Title for the figure</span>
<span id="cb40-461"><a href="#cb40-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-464"><a href="#cb40-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-465"><a href="#cb40-465" aria-hidden="true" tabindex="-1"></a>figProb_t <span class="ot">&lt;-</span> <span class="cf">function</span>(Prob, Title) {</span>
<span id="cb40-466"><a href="#cb40-466" aria-hidden="true" tabindex="-1"></a>  Fig <span class="ot">&lt;-</span> Prob[Prob<span class="sc">$</span>Res<span class="sc">!=</span><span class="st">"Money"</span>,<span class="fu">c</span>(<span class="st">"Time"</span>,<span class="st">"Res"</span>,<span class="st">"mean"</span>)]</span>
<span id="cb40-467"><a href="#cb40-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-468"><a href="#cb40-468" aria-hidden="true" tabindex="-1"></a>  Figp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> Fig, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> mean, <span class="at">color =</span> Res)) <span class="sc">+</span></span>
<span id="cb40-469"><a href="#cb40-469" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-470"><a href="#cb40-470" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb40-471"><a href="#cb40-471" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"gain more than the Mean"</span>,</span>
<span id="cb40-472"><a href="#cb40-472" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"gain more than the Median"</span>,</span>
<span id="cb40-473"><a href="#cb40-473" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"gain"</span>)) <span class="sc">+</span></span>
<span id="cb40-474"><a href="#cb40-474" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(Title) <span class="sc">+</span></span>
<span id="cb40-475"><a href="#cb40-475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"number of exchanges"</span>) <span class="sc">+</span></span>
<span id="cb40-476"><a href="#cb40-476" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Mean-Probability in the Population"</span>) <span class="sc">+</span></span>
<span id="cb40-477"><a href="#cb40-477" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fl">0.30</span>, <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb40-478"><a href="#cb40-478" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb40-479"><a href="#cb40-479" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb40-480"><a href="#cb40-480" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-481"><a href="#cb40-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Figp)</span>
<span id="cb40-482"><a href="#cb40-482" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-483"><a href="#cb40-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-484"><a href="#cb40-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-485"><a href="#cb40-485" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simulation for...</span></span>
<span id="cb40-486"><a href="#cb40-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-487"><a href="#cb40-487" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normal Population</span></span>
<span id="cb40-488"><a href="#cb40-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-489"><a href="#cb40-489" aria-hidden="true" tabindex="-1"></a>Simulation for 50000 exchanges with output after every 500th exchange.</span>
<span id="cb40-490"><a href="#cb40-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-493"><a href="#cb40-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-494"><a href="#cb40-494" aria-hidden="true" tabindex="-1"></a>sNorm <span class="ot">&lt;-</span> <span class="fu">ecosim</span>(<span class="dv">50000</span>, PopNorm<span class="sc">$</span>Money, <span class="at">TL =</span> <span class="dv">250</span>)</span>
<span id="cb40-495"><a href="#cb40-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-496"><a href="#cb40-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-497"><a href="#cb40-497" aria-hidden="true" tabindex="-1"></a><span class="fu">### Presentation of the end results</span></span>
<span id="cb40-498"><a href="#cb40-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-499"><a href="#cb40-499" aria-hidden="true" tabindex="-1"></a>At the beginning, the distribution of money in the population looks like this. After simulating 50000 money exchanges, the following distribution emerges.</span>
<span id="cb40-500"><a href="#cb40-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-503"><a href="#cb40-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-504"><a href="#cb40-504" aria-hidden="true" tabindex="-1"></a>Fig01 <span class="ot">&lt;-</span> <span class="fu">figHist</span>(sNorm<span class="sc">$</span>Sum)</span>
<span id="cb40-505"><a href="#cb40-505" aria-hidden="true" tabindex="-1"></a>Fig01</span>
<span id="cb40-506"><a href="#cb40-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-507"><a href="#cb40-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-508"><a href="#cb40-508" aria-hidden="true" tabindex="-1"></a><span class="fu">### Representation of Money over time</span></span>
<span id="cb40-509"><a href="#cb40-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-510"><a href="#cb40-510" aria-hidden="true" tabindex="-1"></a>It seems that every agent has the chance to have a lot of money in the end. This can be shown by tracking individual agents and their money. Below, nine agents are shown: three with little, three with 100, and three with the most money at the beginning.</span>
<span id="cb40-511"><a href="#cb40-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-514"><a href="#cb40-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-515"><a href="#cb40-515" aria-hidden="true" tabindex="-1"></a>MTime <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ID,sNorm<span class="sc">$</span>Timeline)</span>
<span id="cb40-516"><a href="#cb40-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-517"><a href="#cb40-517" aria-hidden="true" tabindex="-1"></a>sID <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,nA<span class="sc">/</span><span class="dv">2-1</span>,nA<span class="sc">/</span><span class="dv">2</span>,nA<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>,nA<span class="dv">-2</span>,nA<span class="dv">-1</span>,nA)</span>
<span id="cb40-518"><a href="#cb40-518" aria-hidden="true" tabindex="-1"></a>sMTime <span class="ot">&lt;-</span> MTime[sID,]</span>
<span id="cb40-519"><a href="#cb40-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-520"><a href="#cb40-520" aria-hidden="true" tabindex="-1"></a>Fig02 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="fu">data.frame</span>(sMTime),</span>
<span id="cb40-521"><a href="#cb40-521" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cols =</span> <span class="sc">!</span><span class="fu">matches</span>(<span class="st">"ID"</span>),</span>
<span id="cb40-522"><a href="#cb40-522" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"Time"</span>,</span>
<span id="cb40-523"><a href="#cb40-523" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_prefix =</span> <span class="st">"n"</span>,</span>
<span id="cb40-524"><a href="#cb40-524" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">Time =</span> as.integer),</span>
<span id="cb40-525"><a href="#cb40-525" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"Money"</span></span>
<span id="cb40-526"><a href="#cb40-526" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-527"><a href="#cb40-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-528"><a href="#cb40-528" aria-hidden="true" tabindex="-1"></a>Fig02<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%04d"</span>, Fig02<span class="sc">$</span>ID)</span>
<span id="cb40-529"><a href="#cb40-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-530"><a href="#cb40-530" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Fig02, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Money, <span class="at">color =</span> ID)) <span class="sc">+</span></span>
<span id="cb40-531"><a href="#cb40-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb40-532"><a href="#cb40-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Timeline for some Agents"</span>) <span class="sc">+</span></span>
<span id="cb40-533"><a href="#cb40-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"number of exchanges"</span>) <span class="sc">+</span></span>
<span id="cb40-534"><a href="#cb40-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Agents ID"</span>) <span class="sc">+</span></span>
<span id="cb40-535"><a href="#cb40-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb40-536"><a href="#cb40-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb40-537"><a href="#cb40-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb40-538"><a href="#cb40-538" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-539"><a href="#cb40-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-540"><a href="#cb40-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-541"><a href="#cb40-541" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilities for specific Timesteps</span></span>
<span id="cb40-542"><a href="#cb40-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-543"><a href="#cb40-543" aria-hidden="true" tabindex="-1"></a>This can also be shown with the calculated probabilities for the next meeting for each agent.</span>
<span id="cb40-544"><a href="#cb40-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-547"><a href="#cb40-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-548"><a href="#cb40-548" aria-hidden="true" tabindex="-1"></a>Fig03 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(sNorm<span class="sc">$</span>Timeline[,<span class="dv">1</span>]), </span>
<span id="cb40-549"><a href="#cb40-549" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability at Beginning"</span>, <span class="dv">850</span>)</span>
<span id="cb40-550"><a href="#cb40-550" aria-hidden="true" tabindex="-1"></a>Fig04 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(sNorm<span class="sc">$</span>Timeline[,<span class="dv">3</span>]), </span>
<span id="cb40-551"><a href="#cb40-551" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability after 500 exchanges"</span>, <span class="dv">850</span>)</span>
<span id="cb40-552"><a href="#cb40-552" aria-hidden="true" tabindex="-1"></a>Fig05 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(sNorm<span class="sc">$</span>Timeline[,<span class="dv">5</span>]), </span>
<span id="cb40-553"><a href="#cb40-553" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability after 1000 exchanges"</span>, <span class="dv">850</span>)</span>
<span id="cb40-554"><a href="#cb40-554" aria-hidden="true" tabindex="-1"></a>Fig06 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(sNorm<span class="sc">$</span>Timeline[,<span class="fu">NCOL</span>(sNorm<span class="sc">$</span>Timeline)]), </span>
<span id="cb40-555"><a href="#cb40-555" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability at the End"</span>, <span class="dv">850</span>)</span>
<span id="cb40-556"><a href="#cb40-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-557"><a href="#cb40-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-558"><a href="#cb40-558" aria-hidden="true" tabindex="-1"></a>Initially, it seems to be a fairly fair trade, so agents with little money have a higher probability of winning money in the next exchange. However, they also have a lower probability of ending up above the median or the mean. At the beginning, all probabilities in the population are about 0.5 on average.</span>
<span id="cb40-559"><a href="#cb40-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-562"><a href="#cb40-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-563"><a href="#cb40-563" aria-hidden="true" tabindex="-1"></a>Fig03</span>
<span id="cb40-564"><a href="#cb40-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-565"><a href="#cb40-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-566"><a href="#cb40-566" aria-hidden="true" tabindex="-1"></a>However, after a few meetings, this changes. The probability of ending up above the median or the mean decreases.</span>
<span id="cb40-567"><a href="#cb40-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-568"><a href="#cb40-568" aria-hidden="true" tabindex="-1"></a>The reason for this is that with each exchange, a rich and a poor agent are created, which decreases the probability of meeting a rich agent in the future. As a result, the median amount of money decreases.</span>
<span id="cb40-569"><a href="#cb40-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-572"><a href="#cb40-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-573"><a href="#cb40-573" aria-hidden="true" tabindex="-1"></a>Fig04</span>
<span id="cb40-574"><a href="#cb40-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-575"><a href="#cb40-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-576"><a href="#cb40-576" aria-hidden="true" tabindex="-1"></a>This effect intensifies over time.</span>
<span id="cb40-577"><a href="#cb40-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-580"><a href="#cb40-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-581"><a href="#cb40-581" aria-hidden="true" tabindex="-1"></a>Fig05</span>
<span id="cb40-582"><a href="#cb40-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-583"><a href="#cb40-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-584"><a href="#cb40-584" aria-hidden="true" tabindex="-1"></a>After 50000 meetings, the distribution of probabilities in the population looks like this.</span>
<span id="cb40-585"><a href="#cb40-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-588"><a href="#cb40-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-589"><a href="#cb40-589" aria-hidden="true" tabindex="-1"></a>Fig06</span>
<span id="cb40-590"><a href="#cb40-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-591"><a href="#cb40-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-592"><a href="#cb40-592" aria-hidden="true" tabindex="-1"></a>It seems that the probability of ending up above the median rises back to 0.5. However, the probability of ending up above the mean remains low.</span>
<span id="cb40-593"><a href="#cb40-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-594"><a href="#cb40-594" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilities over Time</span></span>
<span id="cb40-595"><a href="#cb40-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-598"><a href="#cb40-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-599"><a href="#cb40-599" aria-hidden="true" tabindex="-1"></a>ProbNormt <span class="ot">&lt;-</span> <span class="fu">calc_p_t</span>(sNorm<span class="sc">$</span>Timeline)</span>
<span id="cb40-600"><a href="#cb40-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-601"><a href="#cb40-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-602"><a href="#cb40-602" aria-hidden="true" tabindex="-1"></a>This can be seen even better when looking at the said probabilities over time.</span>
<span id="cb40-603"><a href="#cb40-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-606"><a href="#cb40-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-607"><a href="#cb40-607" aria-hidden="true" tabindex="-1"></a>Fig07 <span class="ot">&lt;-</span><span class="fu">figProb_t</span>(ProbNormt, <span class="st">"Probability to ... of Money - Timeline"</span>)</span>
<span id="cb40-608"><a href="#cb40-608" aria-hidden="true" tabindex="-1"></a>Fig07</span>
<span id="cb40-609"><a href="#cb40-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-610"><a href="#cb40-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-611"><a href="#cb40-611" aria-hidden="true" tabindex="-1"></a><span class="fu">## Equal Population</span></span>
<span id="cb40-612"><a href="#cb40-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-613"><a href="#cb40-613" aria-hidden="true" tabindex="-1"></a>Simulation for 50000 exchanges with output after every 250th exchange.</span>
<span id="cb40-614"><a href="#cb40-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-617"><a href="#cb40-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-618"><a href="#cb40-618" aria-hidden="true" tabindex="-1"></a>eNorm <span class="ot">&lt;-</span> <span class="fu">ecosim</span>(<span class="dv">50000</span>, PopEqual<span class="sc">$</span>Money, <span class="at">TL =</span> <span class="dv">250</span>)</span>
<span id="cb40-619"><a href="#cb40-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-620"><a href="#cb40-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-621"><a href="#cb40-621" aria-hidden="true" tabindex="-1"></a><span class="fu">### Presentation of the end results</span></span>
<span id="cb40-622"><a href="#cb40-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-623"><a href="#cb40-623" aria-hidden="true" tabindex="-1"></a>At first glance, it seems illogical that a population where everyone starts with the same amount of money would result in a similar final distribution of money. However, the simulation proves this.</span>
<span id="cb40-624"><a href="#cb40-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-627"><a href="#cb40-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-628"><a href="#cb40-628" aria-hidden="true" tabindex="-1"></a>Fig08 <span class="ot">&lt;-</span> <span class="fu">figHist</span>(eNorm<span class="sc">$</span>Sum)</span>
<span id="cb40-629"><a href="#cb40-629" aria-hidden="true" tabindex="-1"></a>Fig08</span>
<span id="cb40-630"><a href="#cb40-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-631"><a href="#cb40-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-632"><a href="#cb40-632" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilities for specific Timesteps</span></span>
<span id="cb40-633"><a href="#cb40-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-636"><a href="#cb40-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-637"><a href="#cb40-637" aria-hidden="true" tabindex="-1"></a>Fig09 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(eNorm<span class="sc">$</span>Timeline[,<span class="dv">1</span>]), </span>
<span id="cb40-638"><a href="#cb40-638" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability at Beginning"</span>, <span class="dv">850</span>)</span>
<span id="cb40-639"><a href="#cb40-639" aria-hidden="true" tabindex="-1"></a>Fig10 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(eNorm<span class="sc">$</span>Timeline[,<span class="dv">3</span>]), </span>
<span id="cb40-640"><a href="#cb40-640" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability after 500 exchanges"</span>, <span class="dv">850</span>)</span>
<span id="cb40-641"><a href="#cb40-641" aria-hidden="true" tabindex="-1"></a>Fig11 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(eNorm<span class="sc">$</span>Timeline[,<span class="dv">5</span>]), </span>
<span id="cb40-642"><a href="#cb40-642" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability after 1000 exchanges"</span>, <span class="dv">850</span>)</span>
<span id="cb40-643"><a href="#cb40-643" aria-hidden="true" tabindex="-1"></a>Fig12 <span class="ot">&lt;-</span> <span class="fu">figProb</span>(<span class="fu">calc_p</span>(eNorm<span class="sc">$</span>Timeline[,<span class="fu">NCOL</span>(eNorm<span class="sc">$</span>Timeline)]), </span>
<span id="cb40-644"><a href="#cb40-644" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Probability at the End"</span>, <span class="dv">850</span>)</span>
<span id="cb40-645"><a href="#cb40-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-646"><a href="#cb40-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-647"><a href="#cb40-647" aria-hidden="true" tabindex="-1"></a>At the beginning, all probabilities are exactly 0.5.</span>
<span id="cb40-648"><a href="#cb40-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-651"><a href="#cb40-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-652"><a href="#cb40-652" aria-hidden="true" tabindex="-1"></a>Fig09</span>
<span id="cb40-653"><a href="#cb40-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-654"><a href="#cb40-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-655"><a href="#cb40-655" aria-hidden="true" tabindex="-1"></a>However, the same mechanism applies here. With each exchange, a rich and a poor agent are created.</span>
<span id="cb40-656"><a href="#cb40-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-659"><a href="#cb40-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-660"><a href="#cb40-660" aria-hidden="true" tabindex="-1"></a>Fig10</span>
<span id="cb40-661"><a href="#cb40-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-662"><a href="#cb40-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-663"><a href="#cb40-663" aria-hidden="true" tabindex="-1"></a>Therefore, the probability of meeting a rich agent in the future also decreases here. As a result, the probability of ending up above the median or the mean decreases here as well.</span>
<span id="cb40-664"><a href="#cb40-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-667"><a href="#cb40-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-668"><a href="#cb40-668" aria-hidden="true" tabindex="-1"></a>Fig11</span>
<span id="cb40-669"><a href="#cb40-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-670"><a href="#cb40-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-671"><a href="#cb40-671" aria-hidden="true" tabindex="-1"></a>After 50000 meetings, the distribution of probabilities in this population looks almost identical.</span>
<span id="cb40-672"><a href="#cb40-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-675"><a href="#cb40-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-676"><a href="#cb40-676" aria-hidden="true" tabindex="-1"></a>Fig12</span>
<span id="cb40-677"><a href="#cb40-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-678"><a href="#cb40-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-679"><a href="#cb40-679" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilities over Time</span></span>
<span id="cb40-680"><a href="#cb40-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-681"><a href="#cb40-681" aria-hidden="true" tabindex="-1"></a>This is even more evident over time.</span>
<span id="cb40-682"><a href="#cb40-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-685"><a href="#cb40-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-686"><a href="#cb40-686" aria-hidden="true" tabindex="-1"></a>ProbEqualt <span class="ot">&lt;-</span> <span class="fu">calc_p_t</span>(eNorm<span class="sc">$</span>Timeline)</span>
<span id="cb40-687"><a href="#cb40-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-688"><a href="#cb40-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-689"><a href="#cb40-689" aria-hidden="true" tabindex="-1"></a>However, it seems that the median amount of money remains stable a bit longer.</span>
<span id="cb40-690"><a href="#cb40-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-693"><a href="#cb40-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-694"><a href="#cb40-694" aria-hidden="true" tabindex="-1"></a>Fig13 <span class="ot">&lt;-</span> <span class="fu">figProb_t</span>(ProbEqualt, <span class="st">"Probability to ... of Money - Timeline"</span>)</span>
<span id="cb40-695"><a href="#cb40-695" aria-hidden="true" tabindex="-1"></a>Fig13</span>
<span id="cb40-696"><a href="#cb40-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-697"><a href="#cb40-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-698"><a href="#cb40-698" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparison</span></span>
<span id="cb40-699"><a href="#cb40-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-700"><a href="#cb40-700" aria-hidden="true" tabindex="-1"></a>To better compare the two populations, two new simulations are conducted. The number is restricted to the interesting initial range, and the time resolution is increased.</span>
<span id="cb40-701"><a href="#cb40-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-704"><a href="#cb40-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-705"><a href="#cb40-705" aria-hidden="true" tabindex="-1"></a>sNorms <span class="ot">&lt;-</span> <span class="fu">ecosim</span>(<span class="dv">8000</span>, PopNorm<span class="sc">$</span>Money, <span class="at">TL =</span> <span class="dv">50</span>)</span>
<span id="cb40-706"><a href="#cb40-706" aria-hidden="true" tabindex="-1"></a>ProbNormts <span class="ot">&lt;-</span> <span class="fu">calc_p_t</span>(sNorms<span class="sc">$</span>Timeline)</span>
<span id="cb40-707"><a href="#cb40-707" aria-hidden="true" tabindex="-1"></a>eNorms <span class="ot">&lt;-</span> <span class="fu">ecosim</span>(<span class="dv">8000</span>, PopEqual<span class="sc">$</span>Money, <span class="at">TL =</span> <span class="dv">50</span>)</span>
<span id="cb40-708"><a href="#cb40-708" aria-hidden="true" tabindex="-1"></a>ProbEqualts <span class="ot">&lt;-</span> <span class="fu">calc_p_t</span>(eNorms<span class="sc">$</span>Timeline)</span>
<span id="cb40-709"><a href="#cb40-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-710"><a href="#cb40-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-711"><a href="#cb40-711" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilities over Time</span></span>
<span id="cb40-712"><a href="#cb40-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-715"><a href="#cb40-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-716"><a href="#cb40-716" aria-hidden="true" tabindex="-1"></a>Fig14 <span class="ot">&lt;-</span> <span class="fu">figProb_t</span>(ProbNormts, </span>
<span id="cb40-717"><a href="#cb40-717" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Probability to ... of Money</span><span class="sc">\n</span><span class="st">Timeline for the Norm Population"</span>)</span>
<span id="cb40-718"><a href="#cb40-718" aria-hidden="true" tabindex="-1"></a>Fig15 <span class="ot">&lt;-</span> <span class="fu">figProb_t</span>(ProbEqualts, </span>
<span id="cb40-719"><a href="#cb40-719" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Probability to ... of Money</span><span class="sc">\n</span><span class="st">Timeline for a equal Population"</span>)</span>
<span id="cb40-720"><a href="#cb40-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-721"><a href="#cb40-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-722"><a href="#cb40-722" aria-hidden="true" tabindex="-1"></a>It actually shows that in the population with the normal distribution, the probabilities for the median and the mean separate earlier.</span>
<span id="cb40-723"><a href="#cb40-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-726"><a href="#cb40-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-727"><a href="#cb40-727" aria-hidden="true" tabindex="-1"></a>Fig14</span>
<span id="cb40-728"><a href="#cb40-728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-729"><a href="#cb40-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-730"><a href="#cb40-730" aria-hidden="true" tabindex="-1"></a>In the population with the same initial amount of money, the two lines remain very close together, meaning that the median and mean amounts of money remain almost identical.</span>
<span id="cb40-731"><a href="#cb40-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-734"><a href="#cb40-734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-735"><a href="#cb40-735" aria-hidden="true" tabindex="-1"></a>Fig15</span>
<span id="cb40-736"><a href="#cb40-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-737"><a href="#cb40-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-738"><a href="#cb40-738" aria-hidden="true" tabindex="-1"></a>This makes sense because the meetings are random, and therefore some agents keep their starting balance of 100 longer. After 2500 meetings, or about two meetings per agent, this becomes increasingly unlikely.</span>
<span id="cb40-739"><a href="#cb40-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-740"><a href="#cb40-740" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploration</span></span>
<span id="cb40-741"><a href="#cb40-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-742"><a href="#cb40-742" aria-hidden="true" tabindex="-1"></a>Since I have not yet used the Gini coefficient described in the article, it is now plotted over time for the two populations.</span>
<span id="cb40-743"><a href="#cb40-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-746"><a href="#cb40-746" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-747"><a href="#cb40-747" aria-hidden="true" tabindex="-1"></a>Fig16 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Time =</span> ProbNormts[ProbNormts<span class="sc">$</span>Res <span class="sc">==</span> <span class="st">"Money"</span>,<span class="fu">c</span>(<span class="st">"Time"</span>)],</span>
<span id="cb40-748"><a href="#cb40-748" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Norm =</span> <span class="fu">gini_t</span>(sNorms<span class="sc">$</span>Timeline),</span>
<span id="cb40-749"><a href="#cb40-749" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Equal =</span> <span class="fu">gini_t</span>(eNorms<span class="sc">$</span>Timeline)</span>
<span id="cb40-750"><a href="#cb40-750" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb40-751"><a href="#cb40-751" aria-hidden="true" tabindex="-1"></a>Fig16 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="fu">data.frame</span>(Fig16),</span>
<span id="cb40-752"><a href="#cb40-752" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cols =</span> <span class="sc">!</span><span class="fu">matches</span>(<span class="st">"Time"</span>),</span>
<span id="cb40-753"><a href="#cb40-753" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"Pop"</span>,</span>
<span id="cb40-754"><a href="#cb40-754" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"Gini"</span></span>
<span id="cb40-755"><a href="#cb40-755" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb40-756"><a href="#cb40-756" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb40-757"><a href="#cb40-757" aria-hidden="true" tabindex="-1"></a>Fig16p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> Fig16, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Gini, <span class="at">color =</span> Pop)) <span class="sc">+</span></span>
<span id="cb40-758"><a href="#cb40-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-759"><a href="#cb40-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Start Population"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb40-760"><a href="#cb40-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Gini-Faktor - Timeline"</span>) <span class="sc">+</span></span>
<span id="cb40-761"><a href="#cb40-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"number of exchanges"</span>) <span class="sc">+</span></span>
<span id="cb40-762"><a href="#cb40-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Gini"</span>) <span class="sc">+</span></span>
<span id="cb40-763"><a href="#cb40-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb40-764"><a href="#cb40-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb40-765"><a href="#cb40-765" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-766"><a href="#cb40-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-767"><a href="#cb40-767" aria-hidden="true" tabindex="-1"></a>Fig16p</span>
<span id="cb40-768"><a href="#cb40-768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-769"><a href="#cb40-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-770"><a href="#cb40-770" aria-hidden="true" tabindex="-1"></a>It seems that the course is quite similar to the course of the probability of ending up above the mean of the distribution. A closer look shows that the reciprocal of the Gini coefficient matches quite well with the probability of ending up above the mean of the distribution.</span>
<span id="cb40-771"><a href="#cb40-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-774"><a href="#cb40-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-775"><a href="#cb40-775" aria-hidden="true" tabindex="-1"></a>Fig17 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Time =</span> ProbNormts[ProbNormts<span class="sc">$</span>Res <span class="sc">==</span> <span class="st">"Money"</span>,<span class="fu">c</span>(<span class="st">"Time"</span>)],</span>
<span id="cb40-776"><a href="#cb40-776" aria-hidden="true" tabindex="-1"></a>                    <span class="at">GNorm =</span> (<span class="dv">1</span><span class="sc">-</span>Fig16[Fig16<span class="sc">$</span>Pop <span class="sc">==</span> <span class="st">"Norm"</span>,<span class="st">"Gini"</span>]),</span>
<span id="cb40-777"><a href="#cb40-777" aria-hidden="true" tabindex="-1"></a>                    <span class="at">PNorm =</span> ProbNormts[ProbNormts<span class="sc">$</span>Res <span class="sc">==</span> <span class="st">"probmean"</span>,<span class="fu">c</span>(<span class="st">"mean"</span>)],</span>
<span id="cb40-778"><a href="#cb40-778" aria-hidden="true" tabindex="-1"></a>                    <span class="at">GEqual =</span> <span class="dv">1</span><span class="sc">-</span>Fig16[Fig16<span class="sc">$</span>Pop <span class="sc">==</span> <span class="st">"Equal"</span>,<span class="st">"Gini"</span>],</span>
<span id="cb40-779"><a href="#cb40-779" aria-hidden="true" tabindex="-1"></a>                    <span class="at">PEqual =</span> ProbEqualts[ProbEqualts<span class="sc">$</span>Res <span class="sc">==</span> <span class="st">"probmean"</span>,<span class="fu">c</span>(<span class="st">"mean"</span>)]</span>
<span id="cb40-780"><a href="#cb40-780" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb40-781"><a href="#cb40-781" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Fig17) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Time"</span>, <span class="st">"GNorm"</span>, <span class="st">"PNorm"</span>, <span class="st">"GEqual"</span>, <span class="st">"PEqual"</span>)</span>
<span id="cb40-782"><a href="#cb40-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-783"><a href="#cb40-783" aria-hidden="true" tabindex="-1"></a>Fig17<span class="sc">$</span>Faktn <span class="ot">&lt;-</span> Fig17<span class="sc">$</span>GNorm<span class="sc">/</span>Fig17<span class="sc">$</span>PNorm</span>
<span id="cb40-784"><a href="#cb40-784" aria-hidden="true" tabindex="-1"></a>Fig17<span class="sc">$</span>Fakte <span class="ot">&lt;-</span> Fig17<span class="sc">$</span>GEqual<span class="sc">/</span>Fig17<span class="sc">$</span>PEqual</span>
<span id="cb40-785"><a href="#cb40-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-786"><a href="#cb40-786" aria-hidden="true" tabindex="-1"></a>Fig17 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="fu">data.frame</span>(Fig17),</span>
<span id="cb40-787"><a href="#cb40-787" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"F"</span>),</span>
<span id="cb40-788"><a href="#cb40-788" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"Pop"</span>,</span>
<span id="cb40-789"><a href="#cb40-789" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"Fakt"</span></span>
<span id="cb40-790"><a href="#cb40-790" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb40-791"><a href="#cb40-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-792"><a href="#cb40-792" aria-hidden="true" tabindex="-1"></a>Fig17p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> Fig17, </span>
<span id="cb40-793"><a href="#cb40-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Fakt, <span class="at">color =</span> Pop, <span class="at">linetype =</span> Pop)) <span class="sc">+</span></span>
<span id="cb40-794"><a href="#cb40-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-795"><a href="#cb40-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Start Population"</span>, </span>
<span id="cb40-796"><a href="#cb40-796" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb40-797"><a href="#cb40-797" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Equal"</span>, <span class="st">"Norm"</span>)) <span class="sc">+</span></span>
<span id="cb40-798"><a href="#cb40-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="st">"Start Population"</span>,</span>
<span id="cb40-799"><a href="#cb40-799" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dashed"</span>),</span>
<span id="cb40-800"><a href="#cb40-800" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Equal"</span>, <span class="st">"Norm"</span>)) <span class="sc">+</span></span>
<span id="cb40-801"><a href="#cb40-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Relation between</span><span class="sc">\n</span><span class="st"> </span></span>
<span id="cb40-802"><a href="#cb40-802" aria-hidden="true" tabindex="-1"></a><span class="st">          Probability to gain more than the Mean</span><span class="sc">\n</span></span>
<span id="cb40-803"><a href="#cb40-803" aria-hidden="true" tabindex="-1"></a><span class="st">          and (1-Gini) - Timeline"</span>) <span class="sc">+</span></span>
<span id="cb40-804"><a href="#cb40-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"number of exchanges"</span>) <span class="sc">+</span></span>
<span id="cb40-805"><a href="#cb40-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Faktor"</span>) <span class="sc">+</span></span>
<span id="cb40-806"><a href="#cb40-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb40-807"><a href="#cb40-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb40-808"><a href="#cb40-808" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-809"><a href="#cb40-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-810"><a href="#cb40-810" aria-hidden="true" tabindex="-1"></a>Fig17p</span>
<span id="cb40-811"><a href="#cb40-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-812"><a href="#cb40-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-813"><a href="#cb40-813" aria-hidden="true" tabindex="-1"></a>***This could potentially allow for the development of a mathematical model for this mechanism. However, this exceeds my abilities and will be left to more capable individuals.***</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>