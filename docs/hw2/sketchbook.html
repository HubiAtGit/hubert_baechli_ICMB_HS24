<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hubert Baechli">
<title>Sketchbook – Hubert Baechli: ICMB portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../hw2/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Hubert Baechli: ICMB portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../hw2/index.html">Assignment 2: <br>Economic Simulation</a></li><li class="breadcrumb-item"><a href="../hw2/sketchbook.html">Sketchbook</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">hubert_baechli_ICMB_HS24</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1: <br>Hello World</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../hw2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2: <br>Economic Simulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2/sketchbook.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Sketchbook</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#my-first-attempt" id="toc-my-first-attempt" class="nav-link active" data-scroll-target="#my-first-attempt">My first attempt</a>
  <ul class="collapse">
<li><a href="#first-of-all" id="toc-first-of-all" class="nav-link" data-scroll-target="#first-of-all">First of all,</a></li>
  <li>
<a href="#the-next-step" id="toc-the-next-step" class="nav-link" data-scroll-target="#the-next-step">The next step</a>
  <ul class="collapse">
<li><a href="#i-am-very-surprised" id="toc-i-am-very-surprised" class="nav-link" data-scroll-target="#i-am-very-surprised">I am very surprised!</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#but-why" id="toc-but-why" class="nav-link" data-scroll-target="#but-why">But why??????????</a>
  <ul class="collapse">
<li><a href="#idea-from-a-proverb" id="toc-idea-from-a-proverb" class="nav-link" data-scroll-target="#idea-from-a-proverb">Idea from a proverb</a></li>
  <li><a href="#back-to-a-more-restrictive-simulation" id="toc-back-to-a-more-restrictive-simulation" class="nav-link" data-scroll-target="#back-to-a-more-restrictive-simulation">Back to a more restrictive Simulation</a></li>
  <li>
<a href="#simple-timehistory" id="toc-simple-timehistory" class="nav-link" data-scroll-target="#simple-timehistory">Simple Timehistory</a>
  <ul class="collapse">
<li><a href="#after-the-first-change-for-all-agents" id="toc-after-the-first-change-for-all-agents" class="nav-link" data-scroll-target="#after-the-first-change-for-all-agents">After the first change for all Agents</a></li>
  <li><a href="#after-the-second-change-for-all-agents" id="toc-after-the-second-change-for-all-agents" class="nav-link" data-scroll-target="#after-the-second-change-for-all-agents">After the second change for all Agents</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#eureka" id="toc-eureka" class="nav-link" data-scroll-target="#eureka">Eureka!</a>
  <ul class="collapse">
<li><a href="#first-exchange" id="toc-first-exchange" class="nav-link" data-scroll-target="#first-exchange">First Exchange</a></li>
  <li><a href="#second-exchange" id="toc-second-exchange" class="nav-link" data-scroll-target="#second-exchange">Second Exchange</a></li>
  <li><a href="#third-exchange" id="toc-third-exchange" class="nav-link" data-scroll-target="#third-exchange">Third Exchange</a></li>
  </ul>
</li>
  <li>
<a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a>
  <ul class="collapse">
<li><a href="#computing-the-probability" id="toc-computing-the-probability" class="nav-link" data-scroll-target="#computing-the-probability">Computing the Probability</a></li>
  <li><a href="#testing" id="toc-testing" class="nav-link" data-scroll-target="#testing">Testing</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../hw2/index.html">Assignment 2: <br>Economic Simulation</a></li><li class="breadcrumb-item"><a href="../hw2/sketchbook.html">Sketchbook</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Sketchbook</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hubert Baechli </p>
          </div>
  </div>
    
  
    
  </div>
  


</header><section id="my-first-attempt" class="level1"><h1>My first attempt</h1>
<p>at an agent model with the information from the lesson</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SplitHalve</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">nAgent</span>, <span class="va">maxExchange</span>, <span class="va">Money_mean</span><span class="op">=</span><span class="fl">1000</span>, <span class="va">Money_sd</span><span class="op">=</span><span class="fl">300</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nAgent</span><span class="op">)</span>,</span>
<span>                   nE<span class="op">=</span><span class="fl">0</span>,</span>
<span>                   Ms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nAgent</span>, mean <span class="op">=</span> <span class="va">Money_mean</span>, sd <span class="op">=</span> <span class="va">Money_sd</span><span class="op">)</span>,</span>
<span>                   MT<span class="op">=</span><span class="fl">0</span>,Me<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">Me</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Ms</span></span>
<span>  <span class="va">iE</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">iE</span> <span class="op">&lt;=</span> <span class="va">maxExchange</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">MT</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Me</span></span>
<span>    <span class="va">rdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">nE</span> <span class="op">&lt;</span> <span class="va">iE</span>,<span class="st">"ID"</span><span class="op">]</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"Me"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"MT"</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">nE</span> <span class="op">&lt;</span> <span class="va">iE</span>,<span class="st">"ID"</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">iE</span> <span class="op">&lt;-</span> <span class="va">iE</span><span class="op">+</span><span class="fl">1</span></span>
<span>      <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Presentation of the results</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">SplitHalve</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       ID               nE           Ms                MT             Me      
 Min.   :   1.0   Min.   :30   Min.   : -37.88   Min.   :1014   Min.   :1014  
 1st Qu.: 250.8   1st Qu.:30   1st Qu.: 806.68   1st Qu.:1014   1st Qu.:1014  
 Median : 500.5   Median :30   Median :1016.58   Median :1014   Median :1014  
 Mean   : 500.5   Mean   :30   Mean   :1014.29   Mean   :1014   Mean   :1014  
 3rd Qu.: 750.2   3rd Qu.:30   3rd Qu.:1215.53   3rd Qu.:1014   3rd Qu.:1014  
 Max.   :1000.0   Max.   :30   Max.   :2049.86   Max.   :1014   Max.   :1014  </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-halve"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>,<span class="va">df</span><span class="op">$</span><span class="va">nE</span>,main<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"ID"</span>,ylab<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>After looking at the code on <a href="https://github.com/norvig/pytudes/blob/main/ipynb/Economics.ipynb#js-repo-pjax-container" class="uri">https://github.com/norvig/pytudes/blob/main/ipynb/Economics.ipynb#js-repo-pjax-container</a> there are some differences between my idea and the paper! These will now be adapted step by step.</p>
<section id="first-of-all" class="level2"><h2 class="anchored" data-anchor-id="first-of-all">First of all,</h2>
<p>the restriction that everyone finds an change partner at the same time will be lifted. In addition, the number and order of changes will also be removed.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SplitHalve2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nAgent</span>,<span class="va">maxExchange</span>,<span class="va">Money_mean</span><span class="op">=</span><span class="fl">1000</span>,<span class="va">Money_sd</span><span class="op">=</span><span class="fl">300</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nAgent</span><span class="op">)</span>,</span>
<span>                   nE<span class="op">=</span><span class="fl">0</span>,</span>
<span>                   Ms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nAgent</span>, mean <span class="op">=</span> <span class="va">Money_mean</span>, sd <span class="op">=</span> <span class="va">Money_sd</span><span class="op">)</span>,</span>
<span>                   MT<span class="op">=</span><span class="fl">0</span>,Me<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">Me</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Ms</span></span>
<span>  <span class="va">iE</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">iE</span> <span class="op">&lt;=</span> <span class="va">maxExchange</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">MT</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Me</span></span>
<span>    <span class="va">rdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"Me"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"MT"</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>    <span class="va">iE</span> <span class="op">&lt;-</span> <span class="va">iE</span><span class="op">+</span><span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Presentation of the results</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">SplitHalve2</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">15000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       ID               nE           Ms                MT       
 Min.   :   1.0   Min.   :16   Min.   : -46.16   Min.   :994.9  
 1st Qu.: 250.8   1st Qu.:26   1st Qu.: 779.75   1st Qu.:995.6  
 Median : 500.5   Median :30   Median : 991.46   Median :995.7  
 Mean   : 500.5   Mean   :30   Mean   : 995.70   Mean   :995.7  
 3rd Qu.: 750.2   3rd Qu.:34   3rd Qu.:1212.24   3rd Qu.:995.8  
 Max.   :1000.0   Max.   :47   Max.   :2107.43   Max.   :997.0  
       Me       
 Min.   :994.9  
 1st Qu.:995.6  
 Median :995.7  
 Mean   :995.7  
 3rd Qu.:995.8  
 Max.   :997.0  </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-halve"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>,<span class="va">df</span><span class="op">$</span><span class="va">nE</span>,main<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"ID"</span>,ylab<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="the-next-step" class="level2"><h2 class="anchored" data-anchor-id="the-next-step">The next step</h2>
<p>is to change from a half-split to a random-split. In the hope that this can reflect the results of the paper</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SplitRandom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nAgent</span>,<span class="va">maxExchange</span>,<span class="va">Money_mean</span><span class="op">=</span><span class="fl">1000</span>,<span class="va">Money_sd</span><span class="op">=</span><span class="fl">300</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nAgent</span><span class="op">)</span>,</span>
<span>                   nE<span class="op">=</span><span class="fl">0</span>,</span>
<span>                   Ms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nAgent</span>, mean <span class="op">=</span> <span class="va">Money_mean</span>, sd <span class="op">=</span> <span class="va">Money_sd</span><span class="op">)</span>,</span>
<span>                   MT<span class="op">=</span><span class="fl">0</span>,Me<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">Me</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Ms</span></span>
<span>  <span class="va">iE</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">iE</span> <span class="op">&lt;=</span> <span class="va">maxExchange</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">MT</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Me</span></span>
<span>    <span class="va">rdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">rds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"Me"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"MT"</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rds</span>,<span class="fl">1</span><span class="op">-</span><span class="va">rds</span><span class="op">)</span></span>
<span>    <span class="va">iE</span> <span class="op">&lt;-</span> <span class="va">iE</span><span class="op">+</span><span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="i-am-very-surprised" class="level3"><h3 class="anchored" data-anchor-id="i-am-very-surprised">I am very surprised!</h3>
<p>here are the results for the random-split</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">SplitRandom</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">15000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       ID               nE           Ms               MT        
 Min.   :   1.0   Min.   :15   Min.   : 119.1   Min.   :   0.0  
 1st Qu.: 250.8   1st Qu.:26   1st Qu.: 803.9   1st Qu.: 299.2  
 Median : 500.5   Median :30   Median : 996.0   Median : 690.7  
 Mean   : 500.5   Mean   :30   Mean   :1000.2   Mean   :1000.2  
 3rd Qu.: 750.2   3rd Qu.:34   3rd Qu.:1197.8   3rd Qu.:1361.5  
 Max.   :1000.0   Max.   :51   Max.   :1994.2   Max.   :6565.6  
       Me        
 Min.   :   0.0  
 1st Qu.: 299.2  
 Median : 691.6  
 Mean   :1000.2  
 3rd Qu.:1357.2  
 Max.   :6565.6  </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>,<span class="va">df</span><span class="op">$</span><span class="va">nE</span>,main<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"ID"</span>,ylab<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="but-why" class="level1"><h1>But why??????????</h1>
<p>there seems to be no correlation to the number of meetings, to the money at the beginning or the ID (position in the matrix)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">nE</span>,<span class="va">df</span><span class="op">$</span><span class="va">Me</span>,main<span class="op">=</span><span class="st">"Correlation to the Number of Changes"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Number of Changes"</span>,ylab<span class="op">=</span><span class="st">"Money at the End"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>,<span class="va">df</span><span class="op">$</span><span class="va">Me</span>,main<span class="op">=</span><span class="st">"Correlation to the Money at the Beginning"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Money at the Beginning"</span>,ylab<span class="op">=</span><span class="st">"Money at the End"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>,<span class="va">df</span><span class="op">$</span><span class="va">Me</span>,main<span class="op">=</span><span class="st">"Correlation to the ID"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"ID"</span>,ylab<span class="op">=</span><span class="st">"Money at the End"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="idea-from-a-proverb" class="level2"><h2 class="anchored" data-anchor-id="idea-from-a-proverb">Idea from a proverb</h2>
<p>can it be that it is harder to get money back once you have lost all the money <em>“money goes to money”</em>?</p>
<p>as a first attempt, the random function is limited between 30% and 70%</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SplitRandom2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nAgent</span>,<span class="va">maxExchange</span>,<span class="va">Money_mean</span><span class="op">=</span><span class="fl">1000</span>,<span class="va">Money_sd</span><span class="op">=</span><span class="fl">300</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nAgent</span><span class="op">)</span>,</span>
<span>                   nE<span class="op">=</span><span class="fl">0</span>,</span>
<span>                   Ms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nAgent</span>, mean <span class="op">=</span> <span class="va">Money_mean</span>, sd <span class="op">=</span> <span class="va">Money_sd</span><span class="op">)</span>,</span>
<span>                   MT<span class="op">=</span><span class="fl">0</span>,Me<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">Me</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Ms</span></span>
<span>  <span class="va">iE</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">iE</span> <span class="op">&lt;=</span> <span class="va">maxExchange</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">MT</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Me</span></span>
<span>    <span class="va">rdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">rds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">30</span><span class="op">:</span><span class="fl">70</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"Me"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"MT"</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rds</span>,<span class="fl">1</span><span class="op">-</span><span class="va">rds</span><span class="op">)</span></span>
<span>    <span class="va">iE</span> <span class="op">&lt;-</span> <span class="va">iE</span><span class="op">+</span><span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>the distribution seems to remain the same as the results here show,</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">SplitRandom2</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">15000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       ID               nE           Ms                MT        
 Min.   :   1.0   Min.   :13   Min.   :  55.18   Min.   : 298.8  
 1st Qu.: 250.8   1st Qu.:26   1st Qu.: 785.83   1st Qu.: 732.5  
 Median : 500.5   Median :30   Median : 977.53   Median : 937.5  
 Mean   : 500.5   Mean   :30   Mean   : 985.86   Mean   : 985.9  
 3rd Qu.: 750.2   3rd Qu.:33   3rd Qu.:1194.89   3rd Qu.:1202.6  
 Max.   :1000.0   Max.   :49   Max.   :1923.52   Max.   :2756.2  
       Me        
 Min.   : 298.8  
 1st Qu.: 732.3  
 Median : 937.5  
 Mean   : 985.9  
 3rd Qu.:1202.6  
 Max.   :2756.2  </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random (30%-70%)"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On closer inspection, however, this does not help to understand the problem.</p>
</section><section id="back-to-a-more-restrictive-simulation" class="level2"><h2 class="anchored" data-anchor-id="back-to-a-more-restrictive-simulation">Back to a more restrictive Simulation</h2>
<p>That’s why I’m going back to my more restrictive Simulation where everyone has to have a meeting first so that someone can have a second meeting. This should help to understand how the timing of the meetings could have an influence…</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">SplitRandomR</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nAgent</span>,<span class="va">maxExchange</span>,<span class="va">Money_mean</span><span class="op">=</span><span class="fl">1000</span>,<span class="va">Money_sd</span><span class="op">=</span><span class="fl">300</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nAgent</span><span class="op">)</span>,</span>
<span>                   nE<span class="op">=</span><span class="fl">0</span>,</span>
<span>                   Ms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">nAgent</span>, mean <span class="op">=</span> <span class="va">Money_mean</span>, sd <span class="op">=</span> <span class="va">Money_sd</span><span class="op">)</span>,</span>
<span>                   MT<span class="op">=</span><span class="fl">0</span>,Me<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">Me</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Ms</span></span>
<span>  <span class="va">iE</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">iE</span> <span class="op">&lt;=</span> <span class="va">maxExchange</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">MT</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Me</span></span>
<span>    <span class="va">rdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">nE</span> <span class="op">&lt;</span> <span class="va">iE</span>,<span class="st">"ID"</span><span class="op">]</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">rds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"nE"</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"Me"</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">rdf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">"MT"</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rds</span>,<span class="fl">1</span><span class="op">-</span><span class="va">rds</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">nE</span> <span class="op">&lt;</span> <span class="va">iE</span>,<span class="st">"ID"</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">iE</span> <span class="op">&lt;-</span> <span class="va">iE</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Time does not seem to have any effect either</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">SplitRandomR</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       ID               nE           Ms                 MT        
 Min.   :   1.0   Min.   :30   Min.   :  -6.583   Min.   :   0.0  
 1st Qu.: 250.8   1st Qu.:30   1st Qu.: 784.234   1st Qu.: 280.6  
 Median : 500.5   Median :30   Median : 990.719   Median : 651.0  
 Mean   : 500.5   Mean   :30   Mean   : 975.880   Mean   : 975.9  
 3rd Qu.: 750.2   3rd Qu.:30   3rd Qu.:1171.659   3rd Qu.:1358.7  
 Max.   :1000.0   Max.   :30   Max.   :1906.833   Max.   :8596.2  
       Me        
 Min.   :   0.0  
 1st Qu.: 280.6  
 Median : 649.9  
 Mean   : 975.9  
 3rd Qu.:1362.6  
 Max.   :8596.2  </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span>,<span class="va">df</span><span class="op">$</span><span class="va">nE</span>,main<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"ID"</span>,ylab<span class="op">=</span><span class="st">"Number of Changes"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>But still why???</strong></p>
<p>I think I need a simulation where I can save the money history!</p>
</section><section id="simple-timehistory" class="level2"><h2 class="anchored" data-anchor-id="simple-timehistory">Simple Timehistory</h2>
<section id="after-the-first-change-for-all-agents" class="level3"><h3 class="anchored" data-anchor-id="after-the-first-change-for-all-agents">After the first change for all Agents</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">SplitRandomR</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="after-the-second-change-for-all-agents" class="level3"><h3 class="anchored" data-anchor-id="after-the-second-change-for-all-agents">After the second change for all Agents</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">SplitRandomR</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="eureka" class="level1"><h1>Eureka!</h1>
<p><strong>Sleeping on it always helps!</strong></p>
<p>I think the easiest way to understand the mechanism is to have all agents start with the same amount of money. I will do this here quick and durty with my restrictive simulation and a starting distribution with a mean of 1000 and a standard deviation of 0.</p>
<section id="first-exchange" class="level2"><h2 class="anchored" data-anchor-id="first-exchange">First Exchange</h2>
<p>In the first run in this simplified scenario, all agents have the same chance of being above or below 1000.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df1_even</span> <span class="op">&lt;-</span> <span class="fu">SplitRandomR</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">1</span>,<span class="fl">1000</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df1_even</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df1_even</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In other words, the average value of Money is still 1000. Also the Median. So there should be about 50% agents with more than 1000</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df1_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Mean"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span>,</span>
<span>                          <span class="st">"Median"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span>,</span>
<span>                          <span class="st">"nAover1000"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df1_even</span><span class="op">[</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Me</span><span class="op">&gt;</span><span class="fl">1000</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>                          <span class="co"># number of Agents with more than 1000</span></span>
<span><span class="va">df1_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Mean Median nAover1000
1 1000   1000        496</code></pre>
</div>
</div>
</section><section id="second-exchange" class="level2"><h2 class="anchored" data-anchor-id="second-exchange">Second Exchange</h2>
<p>But what happens now with the second swap!</p>
<p>to get above 1000 or to stay there you “need” two conditions:</p>
<ol type="1">
<li><p>you have to meet someone who has over 1000 (p~0.5)</p></li>
<li><p>you must also emerge from the meeting as the winner (p~0.5)</p></li>
</ol>
<p>The chance of staying or getting above 1000 is only around 25%.</p>
<p><strong><em>I know this isn’t formally correct, but it should explain the mechanism!</em></strong></p>
<p><strong>The real value should be under 50% (see conclusion)</strong></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2_even</span> <span class="op">&lt;-</span> <span class="fu">SplitRandomR</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span>,<span class="fl">1000</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df2_even</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df2_even</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df2_even</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df2_even</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df2_even</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>after the second round, the mean value is still 1000, but the median is now lower!</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Mean"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df2_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span>,</span>
<span>                          <span class="st">"Median"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">df2_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span>,</span>
<span>                          <span class="st">"nAover1000"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df2_even</span><span class="op">[</span><span class="va">df2_even</span><span class="op">$</span><span class="va">Me</span><span class="op">&gt;</span><span class="fl">1000</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>                          <span class="co"># number of Agents with more than 1000</span></span>
<span><span class="va">df2_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Mean Median nAover1000
1 1000  823.8        423</code></pre>
</div>
</div>
<p>in other words, meeting someone who has over 1000 is now even smaller for the next round.</p>
</section><section id="third-exchange" class="level2"><h2 class="anchored" data-anchor-id="third-exchange">Third Exchange</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df3_even</span> <span class="op">&lt;-</span> <span class="fu">SplitRandomR</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">3</span>,<span class="fl">1000</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df3_even</span><span class="op">$</span><span class="va">Ms</span>, xlab<span class="op">=</span><span class="st">"Money"</span>,main<span class="op">=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df3_even</span><span class="op">$</span><span class="va">Me</span>,<span class="va">df3_even</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df3_even</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df3_even</span><span class="op">$</span><span class="va">Me</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>     add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Money befor'</span>, <span class="st">'Money after'</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As assumed, the median is again smaller, as is the number of agents with more than 1000</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df3_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Mean"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df3_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span>,</span>
<span>                          <span class="st">"Median"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">df3_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span>,</span>
<span>                          <span class="st">"nAover1000"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df3_even</span><span class="op">[</span><span class="va">df3_even</span><span class="op">$</span><span class="va">Me</span><span class="op">&gt;</span><span class="fl">1000</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>                          <span class="co"># number of Agents with more than 1000</span></span>
<span><span class="va">df3_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Mean  Median nAover1000
1 1000 784.574        401</code></pre>
</div>
</div>
<p>from here on it seems clear that it tends towards the distribution with further steps</p>
</section></section><section id="conclusion" class="level1"><h1>Conclusion</h1>
<p>I must have made something like a conjunction error here. the conditional probability for winning of 50% is only given if everyone has the same amount of money. Otherwise the chance of getting over the Median of the distribusion is always smaller (conjunction of two probability’s), which means that there are more and more poor and only a few rich agents in this game.</p>
<section id="computing-the-probability" class="level2"><h2 class="anchored" data-anchor-id="computing-the-probability">Computing the Probability</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">win_stab_prob</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">Moneyvec</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Money<span class="op">=</span><span class="va">Moneyvec</span>,</span>
<span>                   winprobability<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">MMA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">MA</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">MoA</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">WP</span> <span class="op">&lt;-</span> <span class="va">MoA</span><span class="op">*</span><span class="fl">0</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">MoA</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">Sum_M</span> <span class="op">&lt;-</span> <span class="va">MA</span> <span class="op">+</span> <span class="va">MoA</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">Sum_M</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">WP</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.00</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">WP</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">WP</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">MMA</span><span class="op">/</span><span class="va">Sum_M</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">df</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">WP</span><span class="op">)</span>, digits <span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="testing" class="level2"><h2 class="anchored" data-anchor-id="testing">Testing</h2>
<p>Before the first Exchange it should be 0.5 for all Agents</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob_start</span> <span class="op">&lt;-</span> <span class="fu">win_stab_prob</span><span class="op">(</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Ms</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prob_start</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     lwd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Getting over the Median"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"ID"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Probability"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>after that first round it depends from the Money of the Agent.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob_after1</span> <span class="op">&lt;-</span> <span class="fu">win_stab_prob</span><span class="op">(</span><span class="va">df1_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span></span>
<span><span class="va">prob_after1</span> <span class="op">&lt;-</span> <span class="va">prob_after1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">prob_after1</span><span class="op">$</span><span class="va">Money</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">popMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prob_after1</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Money_Med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">prob_after1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prob_after1</span>,</span>
<span>     lwd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Populationmean"</span>, <span class="va">popMean</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Money"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Probability"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">popMean</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">Money_Med</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>after the second round</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob_after2</span> <span class="op">&lt;-</span> <span class="fu">win_stab_prob</span><span class="op">(</span><span class="va">df2_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span></span>
<span><span class="va">prob_after2</span> <span class="op">&lt;-</span> <span class="va">prob_after2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">prob_after2</span><span class="op">$</span><span class="va">Money</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">popMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prob_after2</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Money_Med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">prob_after2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prob_after2</span>,</span>
<span>     lwd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Populationmean"</span>, <span class="va">popMean</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Money"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Probability"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">popMean</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">Money_Med</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>… third</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob_after3</span> <span class="op">&lt;-</span> <span class="fu">win_stab_prob</span><span class="op">(</span><span class="va">df3_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span></span>
<span><span class="va">prob_after3</span> <span class="op">&lt;-</span> <span class="va">prob_after3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">prob_after3</span><span class="op">$</span><span class="va">Money</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">popMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prob_after3</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Money_Med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">prob_after3</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prob_after3</span>,</span>
<span>     lwd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Populationmean"</span>, <span class="va">popMean</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Money"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Probability"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">popMean</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">Money_Med</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>…15th</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df15_even</span> <span class="op">&lt;-</span> <span class="fu">SplitRandomR</span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">15</span>,<span class="fl">1000</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prob_after15</span> <span class="op">&lt;-</span> <span class="fu">win_stab_prob</span><span class="op">(</span><span class="va">df15_even</span><span class="op">$</span><span class="va">Me</span><span class="op">)</span></span>
<span><span class="va">prob_after15</span> <span class="op">&lt;-</span> <span class="va">prob_after15</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">prob_after15</span><span class="op">$</span><span class="va">Money</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">popMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prob_after15</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Money_Med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">prob_after15</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prob_after15</span>,</span>
<span>     lwd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Populationmean"</span>, <span class="va">popMean</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Money"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Probability"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">popMean</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">Money_Med</span>,</span>
<span>            col <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="sketchbook_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../hw2/index.html" class="pagination-link" aria-label="Assignment 2: <br>Economic Simulation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assignment 2: <br>Economic Simulation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb45" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Sketchbook"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Hubert Baechli"</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu"># My first attempt</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>at an agent model with the information from the lesson</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>SplitHalve <span class="ot">&lt;-</span> <span class="cf">function</span> (nAgent, maxExchange, <span class="at">Money_mean=</span><span class="dv">1000</span>, <span class="at">Money_sd=</span><span class="dv">300</span>) {</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">seq</span>(<span class="dv">1</span>,nAgent),</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nE=</span><span class="dv">0</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ms=</span><span class="fu">rnorm</span>(nAgent, <span class="at">mean =</span> Money_mean, <span class="at">sd =</span> Money_sd),</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">MT=</span><span class="dv">0</span>,<span class="at">Me=</span><span class="dv">0</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Me <span class="ot">&lt;-</span> df<span class="sc">$</span>Ms</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  iE <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (iE <span class="sc">&lt;=</span> maxExchange) {</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>MT <span class="ot">&lt;-</span> df<span class="sc">$</span>Me</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    rdf <span class="ot">&lt;-</span> <span class="fu">sample</span>(df[df<span class="sc">$</span>nE <span class="sc">&lt;</span> iE,<span class="st">"ID"</span>], <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>      df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"Me"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"MT"</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">NROW</span>(df[df<span class="sc">$</span>nE <span class="sc">&lt;</span> iE,<span class="st">"ID"</span>]) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>      iE <span class="ot">&lt;-</span> iE<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>Presentation of the results</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">SplitHalve</span>(<span class="dv">1000</span>,<span class="dv">30</span>)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-halve"</span>,</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df<span class="sc">$</span>Me,df<span class="sc">$</span>Ms)<span class="sc">*</span><span class="fl">1.1</span>)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>ID,df<span class="sc">$</span>nE,<span class="at">main=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"ID"</span>,<span class="at">ylab=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>After looking at the code on <span class="ot">&lt;https://github.com/norvig/pytudes/blob/main/ipynb/Economics.ipynb#js-repo-pjax-container&gt;</span> there are some differences between my idea and the paper! These will now be adapted step by step.</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## First of all,</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>the restriction that everyone finds an change partner at the same time will be lifted. In addition, the number and order of changes will also be removed.</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>SplitHalve2 <span class="ot">&lt;-</span> <span class="cf">function</span>(nAgent,maxExchange,<span class="at">Money_mean=</span><span class="dv">1000</span>,<span class="at">Money_sd=</span><span class="dv">300</span>) {</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">seq</span>(<span class="dv">1</span>,nAgent),</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nE=</span><span class="dv">0</span>,</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ms=</span><span class="fu">rnorm</span>(nAgent, <span class="at">mean =</span> Money_mean, <span class="at">sd =</span> Money_sd),</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>                   <span class="at">MT=</span><span class="dv">0</span>,<span class="at">Me=</span><span class="dv">0</span>)</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Me <span class="ot">&lt;-</span> df<span class="sc">$</span>Ms</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>  iE <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (iE <span class="sc">&lt;=</span> maxExchange) {</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>MT <span class="ot">&lt;-</span> df<span class="sc">$</span>Me</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>    rdf <span class="ot">&lt;-</span> <span class="fu">sample</span>(df<span class="sc">$</span>ID, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>      df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"Me"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"MT"</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>    iE <span class="ot">&lt;-</span> iE<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>Presentation of the results</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">SplitHalve2</span>(<span class="dv">1000</span>,<span class="dv">15000</span>)</span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-halve"</span>,</span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df<span class="sc">$</span>Me,df<span class="sc">$</span>Ms)<span class="sc">*</span><span class="fl">1.1</span>))<span class="sc">*</span><span class="fl">1.1</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>ID,df<span class="sc">$</span>nE,<span class="at">main=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"ID"</span>,<span class="at">ylab=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## The next step</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a>is to change from a half-split to a random-split. In the hope that this can reflect the results of the paper</span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a>SplitRandom <span class="ot">&lt;-</span> <span class="cf">function</span>(nAgent,maxExchange,<span class="at">Money_mean=</span><span class="dv">1000</span>,<span class="at">Money_sd=</span><span class="dv">300</span>) {</span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">seq</span>(<span class="dv">1</span>,nAgent),</span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nE=</span><span class="dv">0</span>,</span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ms=</span><span class="fu">rnorm</span>(nAgent, <span class="at">mean =</span> Money_mean, <span class="at">sd =</span> Money_sd),</span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a>                   <span class="at">MT=</span><span class="dv">0</span>,<span class="at">Me=</span><span class="dv">0</span>)</span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Me <span class="ot">&lt;-</span> df<span class="sc">$</span>Ms</span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a>  iE <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (iE <span class="sc">&lt;=</span> maxExchange) {</span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>MT <span class="ot">&lt;-</span> df<span class="sc">$</span>Me</span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a>    rdf <span class="ot">&lt;-</span> <span class="fu">sample</span>(df<span class="sc">$</span>ID, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a>    rds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a>      df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"Me"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"MT"</span>])<span class="sc">*</span><span class="fu">c</span>(rds,<span class="dv">1</span><span class="sc">-</span>rds)</span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a>    iE <span class="ot">&lt;-</span> iE<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a><span class="fu">### I am very surprised!</span></span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a>here are the results for the random-split</span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-143"><a href="#cb45-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-144"><a href="#cb45-144" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">SplitRandom</span>(<span class="dv">1000</span>,<span class="dv">15000</span>)</span>
<span id="cb45-145"><a href="#cb45-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-146"><a href="#cb45-146" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb45-147"><a href="#cb45-147" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random"</span>,</span>
<span id="cb45-148"><a href="#cb45-148" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-149"><a href="#cb45-149" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df<span class="sc">$</span>Me,df<span class="sc">$</span>Ms)<span class="sc">*</span><span class="fl">1.1</span>)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-150"><a href="#cb45-150" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-151"><a href="#cb45-151" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-152"><a href="#cb45-152" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-153"><a href="#cb45-153" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-154"><a href="#cb45-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-155"><a href="#cb45-155" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>ID,df<span class="sc">$</span>nE,<span class="at">main=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-156"><a href="#cb45-156" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"ID"</span>,<span class="at">ylab=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-157"><a href="#cb45-157" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb45-158"><a href="#cb45-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-159"><a href="#cb45-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-160"><a href="#cb45-160" aria-hidden="true" tabindex="-1"></a><span class="fu"># But why??????????</span></span>
<span id="cb45-161"><a href="#cb45-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-162"><a href="#cb45-162" aria-hidden="true" tabindex="-1"></a>there seems to be no correlation to the number of meetings, to the money at the beginning or the ID (position in the matrix)</span>
<span id="cb45-163"><a href="#cb45-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-166"><a href="#cb45-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-167"><a href="#cb45-167" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>nE,df<span class="sc">$</span>Me,<span class="at">main=</span><span class="st">"Correlation to the Number of Changes"</span>,</span>
<span id="cb45-168"><a href="#cb45-168" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of Changes"</span>,<span class="at">ylab=</span><span class="st">"Money at the End"</span>,</span>
<span id="cb45-169"><a href="#cb45-169" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb45-170"><a href="#cb45-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-171"><a href="#cb45-171" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>Ms,df<span class="sc">$</span>Me,<span class="at">main=</span><span class="st">"Correlation to the Money at the Beginning"</span>,</span>
<span id="cb45-172"><a href="#cb45-172" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Money at the Beginning"</span>,<span class="at">ylab=</span><span class="st">"Money at the End"</span>,</span>
<span id="cb45-173"><a href="#cb45-173" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb45-174"><a href="#cb45-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-175"><a href="#cb45-175" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>ID,df<span class="sc">$</span>Me,<span class="at">main=</span><span class="st">"Correlation to the ID"</span>,</span>
<span id="cb45-176"><a href="#cb45-176" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"ID"</span>,<span class="at">ylab=</span><span class="st">"Money at the End"</span>,</span>
<span id="cb45-177"><a href="#cb45-177" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb45-178"><a href="#cb45-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-179"><a href="#cb45-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-180"><a href="#cb45-180" aria-hidden="true" tabindex="-1"></a><span class="fu">## Idea from a proverb</span></span>
<span id="cb45-181"><a href="#cb45-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-182"><a href="#cb45-182" aria-hidden="true" tabindex="-1"></a>can it be that it is harder to get money back once you have lost all the money *“money goes to money”*?</span>
<span id="cb45-183"><a href="#cb45-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-184"><a href="#cb45-184" aria-hidden="true" tabindex="-1"></a>as a first attempt, the random function is limited between 30% and 70%</span>
<span id="cb45-185"><a href="#cb45-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-188"><a href="#cb45-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-189"><a href="#cb45-189" aria-hidden="true" tabindex="-1"></a>SplitRandom2 <span class="ot">&lt;-</span> <span class="cf">function</span>(nAgent,maxExchange,<span class="at">Money_mean=</span><span class="dv">1000</span>,<span class="at">Money_sd=</span><span class="dv">300</span>) {</span>
<span id="cb45-190"><a href="#cb45-190" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">seq</span>(<span class="dv">1</span>,nAgent),</span>
<span id="cb45-191"><a href="#cb45-191" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nE=</span><span class="dv">0</span>,</span>
<span id="cb45-192"><a href="#cb45-192" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ms=</span><span class="fu">rnorm</span>(nAgent, <span class="at">mean =</span> Money_mean, <span class="at">sd =</span> Money_sd),</span>
<span id="cb45-193"><a href="#cb45-193" aria-hidden="true" tabindex="-1"></a>                   <span class="at">MT=</span><span class="dv">0</span>,<span class="at">Me=</span><span class="dv">0</span>)</span>
<span id="cb45-194"><a href="#cb45-194" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Me <span class="ot">&lt;-</span> df<span class="sc">$</span>Ms</span>
<span id="cb45-195"><a href="#cb45-195" aria-hidden="true" tabindex="-1"></a>  iE <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-196"><a href="#cb45-196" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (iE <span class="sc">&lt;=</span> maxExchange) {</span>
<span id="cb45-197"><a href="#cb45-197" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>MT <span class="ot">&lt;-</span> df<span class="sc">$</span>Me</span>
<span id="cb45-198"><a href="#cb45-198" aria-hidden="true" tabindex="-1"></a>    rdf <span class="ot">&lt;-</span> <span class="fu">sample</span>(df<span class="sc">$</span>ID, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb45-199"><a href="#cb45-199" aria-hidden="true" tabindex="-1"></a>    rds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">70</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb45-200"><a href="#cb45-200" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-201"><a href="#cb45-201" aria-hidden="true" tabindex="-1"></a>      df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-202"><a href="#cb45-202" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"Me"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-203"><a href="#cb45-203" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"MT"</span>])<span class="sc">*</span><span class="fu">c</span>(rds,<span class="dv">1</span><span class="sc">-</span>rds)</span>
<span id="cb45-204"><a href="#cb45-204" aria-hidden="true" tabindex="-1"></a>    iE <span class="ot">&lt;-</span> iE<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-205"><a href="#cb45-205" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-206"><a href="#cb45-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb45-207"><a href="#cb45-207" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-208"><a href="#cb45-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-209"><a href="#cb45-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-210"><a href="#cb45-210" aria-hidden="true" tabindex="-1"></a>the distribution seems to remain the same as the results here show,</span>
<span id="cb45-211"><a href="#cb45-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-214"><a href="#cb45-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-215"><a href="#cb45-215" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">SplitRandom2</span>(<span class="dv">1000</span>,<span class="dv">15000</span>)</span>
<span id="cb45-216"><a href="#cb45-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-217"><a href="#cb45-217" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb45-218"><a href="#cb45-218" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random (30%-70%)"</span>,</span>
<span id="cb45-219"><a href="#cb45-219" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-220"><a href="#cb45-220" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df<span class="sc">$</span>Me,df<span class="sc">$</span>Ms)<span class="sc">*</span><span class="fl">1.1</span>)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-221"><a href="#cb45-221" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-222"><a href="#cb45-222" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-223"><a href="#cb45-223" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-224"><a href="#cb45-224" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-225"><a href="#cb45-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-226"><a href="#cb45-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-227"><a href="#cb45-227" aria-hidden="true" tabindex="-1"></a>On closer inspection, however, this does not help to understand the problem.</span>
<span id="cb45-228"><a href="#cb45-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-229"><a href="#cb45-229" aria-hidden="true" tabindex="-1"></a><span class="fu">## Back to a more restrictive Simulation</span></span>
<span id="cb45-230"><a href="#cb45-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-231"><a href="#cb45-231" aria-hidden="true" tabindex="-1"></a>That's why I'm going back to my more restrictive Simulation where everyone has to have a meeting first so that someone can have a second meeting. This should help to understand how the timing of the meetings could have an influence...</span>
<span id="cb45-232"><a href="#cb45-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-235"><a href="#cb45-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-236"><a href="#cb45-236" aria-hidden="true" tabindex="-1"></a>SplitRandomR <span class="ot">&lt;-</span> <span class="cf">function</span>(nAgent,maxExchange,<span class="at">Money_mean=</span><span class="dv">1000</span>,<span class="at">Money_sd=</span><span class="dv">300</span>) {</span>
<span id="cb45-237"><a href="#cb45-237" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">seq</span>(<span class="dv">1</span>,nAgent),</span>
<span id="cb45-238"><a href="#cb45-238" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nE=</span><span class="dv">0</span>,</span>
<span id="cb45-239"><a href="#cb45-239" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ms=</span><span class="fu">rnorm</span>(nAgent, <span class="at">mean =</span> Money_mean, <span class="at">sd =</span> Money_sd),</span>
<span id="cb45-240"><a href="#cb45-240" aria-hidden="true" tabindex="-1"></a>                   <span class="at">MT=</span><span class="dv">0</span>,<span class="at">Me=</span><span class="dv">0</span>)</span>
<span id="cb45-241"><a href="#cb45-241" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Me <span class="ot">&lt;-</span> df<span class="sc">$</span>Ms</span>
<span id="cb45-242"><a href="#cb45-242" aria-hidden="true" tabindex="-1"></a>  iE <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-243"><a href="#cb45-243" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (iE <span class="sc">&lt;=</span> maxExchange) {</span>
<span id="cb45-244"><a href="#cb45-244" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>MT <span class="ot">&lt;-</span> df<span class="sc">$</span>Me</span>
<span id="cb45-245"><a href="#cb45-245" aria-hidden="true" tabindex="-1"></a>    rdf <span class="ot">&lt;-</span> <span class="fu">sample</span>(df[df<span class="sc">$</span>nE <span class="sc">&lt;</span> iE,<span class="st">"ID"</span>], <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb45-246"><a href="#cb45-246" aria-hidden="true" tabindex="-1"></a>    rds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb45-247"><a href="#cb45-247" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-248"><a href="#cb45-248" aria-hidden="true" tabindex="-1"></a>      df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"nE"</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-249"><a href="#cb45-249" aria-hidden="true" tabindex="-1"></a>    df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"Me"</span>] <span class="ot">&lt;-</span></span>
<span id="cb45-250"><a href="#cb45-250" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(df[(df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">1</span>] <span class="sc">|</span> df<span class="sc">$</span>ID <span class="sc">==</span> rdf[<span class="dv">2</span>]),<span class="st">"MT"</span>])<span class="sc">*</span><span class="fu">c</span>(rds,<span class="dv">1</span><span class="sc">-</span>rds)</span>
<span id="cb45-251"><a href="#cb45-251" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">NROW</span>(df[df<span class="sc">$</span>nE <span class="sc">&lt;</span> iE,<span class="st">"ID"</span>]) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb45-252"><a href="#cb45-252" aria-hidden="true" tabindex="-1"></a>      iE <span class="ot">&lt;-</span> iE<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-253"><a href="#cb45-253" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-254"><a href="#cb45-254" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-255"><a href="#cb45-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb45-256"><a href="#cb45-256" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-257"><a href="#cb45-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-258"><a href="#cb45-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-259"><a href="#cb45-259" aria-hidden="true" tabindex="-1"></a>Time does not seem to have any effect either</span>
<span id="cb45-260"><a href="#cb45-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-263"><a href="#cb45-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-264"><a href="#cb45-264" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">SplitRandomR</span>(<span class="dv">1000</span>,<span class="dv">30</span>)</span>
<span id="cb45-265"><a href="#cb45-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-266"><a href="#cb45-266" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb45-267"><a href="#cb45-267" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span id="cb45-268"><a href="#cb45-268" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-269"><a href="#cb45-269" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df<span class="sc">$</span>Me,df<span class="sc">$</span>Ms)<span class="sc">*</span><span class="fl">1.1</span>)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-270"><a href="#cb45-270" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-271"><a href="#cb45-271" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-272"><a href="#cb45-272" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-273"><a href="#cb45-273" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-274"><a href="#cb45-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-275"><a href="#cb45-275" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>ID,df<span class="sc">$</span>nE,<span class="at">main=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-276"><a href="#cb45-276" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"ID"</span>,<span class="at">ylab=</span><span class="st">"Number of Changes"</span>,</span>
<span id="cb45-277"><a href="#cb45-277" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb45-278"><a href="#cb45-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-279"><a href="#cb45-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-280"><a href="#cb45-280" aria-hidden="true" tabindex="-1"></a>**But still why???**</span>
<span id="cb45-281"><a href="#cb45-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-282"><a href="#cb45-282" aria-hidden="true" tabindex="-1"></a>I think I need a simulation where I can save the money history!</span>
<span id="cb45-283"><a href="#cb45-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-284"><a href="#cb45-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple Timehistory</span></span>
<span id="cb45-285"><a href="#cb45-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-286"><a href="#cb45-286" aria-hidden="true" tabindex="-1"></a><span class="fu">### After the first change for all Agents</span></span>
<span id="cb45-287"><a href="#cb45-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-290"><a href="#cb45-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-291"><a href="#cb45-291" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">SplitRandomR</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb45-292"><a href="#cb45-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-293"><a href="#cb45-293" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span id="cb45-294"><a href="#cb45-294" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-295"><a href="#cb45-295" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df<span class="sc">$</span>Me,df<span class="sc">$</span>Ms))<span class="sc">*</span><span class="fl">1.1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-296"><a href="#cb45-296" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-297"><a href="#cb45-297" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-298"><a href="#cb45-298" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-299"><a href="#cb45-299" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-300"><a href="#cb45-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-301"><a href="#cb45-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-302"><a href="#cb45-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-303"><a href="#cb45-303" aria-hidden="true" tabindex="-1"></a><span class="fu">### After the second change for all Agents</span></span>
<span id="cb45-304"><a href="#cb45-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-307"><a href="#cb45-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-308"><a href="#cb45-308" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">SplitRandomR</span>(<span class="dv">1000</span>,<span class="dv">2</span>)</span>
<span id="cb45-309"><a href="#cb45-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-310"><a href="#cb45-310" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span id="cb45-311"><a href="#cb45-311" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-312"><a href="#cb45-312" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df<span class="sc">$</span>Me,df<span class="sc">$</span>Ms)))<span class="sc">*</span><span class="fl">1.1</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-313"><a href="#cb45-313" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-314"><a href="#cb45-314" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-315"><a href="#cb45-315" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-316"><a href="#cb45-316" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-317"><a href="#cb45-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-318"><a href="#cb45-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-319"><a href="#cb45-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-320"><a href="#cb45-320" aria-hidden="true" tabindex="-1"></a><span class="fu"># Eureka!</span></span>
<span id="cb45-321"><a href="#cb45-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-322"><a href="#cb45-322" aria-hidden="true" tabindex="-1"></a>**Sleeping on it always helps!**</span>
<span id="cb45-323"><a href="#cb45-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-324"><a href="#cb45-324" aria-hidden="true" tabindex="-1"></a>I think the easiest way to understand the mechanism is to have all agents start with the same amount of money. I will do this here quick and durty with my restrictive simulation and a starting distribution with a mean of 1000 and a standard deviation of 0.</span>
<span id="cb45-325"><a href="#cb45-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-326"><a href="#cb45-326" aria-hidden="true" tabindex="-1"></a><span class="fu">## First Exchange</span></span>
<span id="cb45-327"><a href="#cb45-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-328"><a href="#cb45-328" aria-hidden="true" tabindex="-1"></a>In the first run in this simplified scenario, all agents have the same chance of being above or below 1000.</span>
<span id="cb45-329"><a href="#cb45-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-332"><a href="#cb45-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-333"><a href="#cb45-333" aria-hidden="true" tabindex="-1"></a>df1_even <span class="ot">&lt;-</span> <span class="fu">SplitRandomR</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">1000</span>,<span class="dv">0</span>)</span>
<span id="cb45-334"><a href="#cb45-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-335"><a href="#cb45-335" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df1_even<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span id="cb45-336"><a href="#cb45-336" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-337"><a href="#cb45-337" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df1_even<span class="sc">$</span>Me,df1_even<span class="sc">$</span>Ms))<span class="sc">*</span><span class="fl">1.1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df1_even)))</span>
<span id="cb45-338"><a href="#cb45-338" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df1_even<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-339"><a href="#cb45-339" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-340"><a href="#cb45-340" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-341"><a href="#cb45-341" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-342"><a href="#cb45-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-343"><a href="#cb45-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-344"><a href="#cb45-344" aria-hidden="true" tabindex="-1"></a>In other words, the average value of Money is still 1000. Also the Median. So there should be about 50% agents with more than 1000</span>
<span id="cb45-345"><a href="#cb45-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-348"><a href="#cb45-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-349"><a href="#cb45-349" aria-hidden="true" tabindex="-1"></a>df1_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Mean"</span><span class="ot">=</span><span class="fu">mean</span>(df1_even<span class="sc">$</span>Me),</span>
<span id="cb45-350"><a href="#cb45-350" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Median"</span><span class="ot">=</span><span class="fu">median</span>(df1_even<span class="sc">$</span>Me),</span>
<span id="cb45-351"><a href="#cb45-351" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"nAover1000"</span><span class="ot">=</span><span class="fu">nrow</span>(df1_even[df1_even<span class="sc">$</span>Me<span class="sc">&gt;</span><span class="dv">1000</span>,])) </span>
<span id="cb45-352"><a href="#cb45-352" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># number of Agents with more than 1000</span></span>
<span id="cb45-353"><a href="#cb45-353" aria-hidden="true" tabindex="-1"></a>df1_summary</span>
<span id="cb45-354"><a href="#cb45-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-355"><a href="#cb45-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-356"><a href="#cb45-356" aria-hidden="true" tabindex="-1"></a><span class="fu">## Second Exchange</span></span>
<span id="cb45-357"><a href="#cb45-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-358"><a href="#cb45-358" aria-hidden="true" tabindex="-1"></a>But what happens now with the second swap!</span>
<span id="cb45-359"><a href="#cb45-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-360"><a href="#cb45-360" aria-hidden="true" tabindex="-1"></a>to get above 1000 or to stay there you "need" two conditions:</span>
<span id="cb45-361"><a href="#cb45-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-362"><a href="#cb45-362" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>you have to meet someone who has over 1000 (p\~0.5)</span>
<span id="cb45-363"><a href="#cb45-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-364"><a href="#cb45-364" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>you must also emerge from the meeting as the winner (p\~0.5)</span>
<span id="cb45-365"><a href="#cb45-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-366"><a href="#cb45-366" aria-hidden="true" tabindex="-1"></a>The chance of staying or getting above 1000 is only around 25%.</span>
<span id="cb45-367"><a href="#cb45-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-368"><a href="#cb45-368" aria-hidden="true" tabindex="-1"></a>***I know this isn't formally correct, but it should explain the mechanism!***</span>
<span id="cb45-369"><a href="#cb45-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-370"><a href="#cb45-370" aria-hidden="true" tabindex="-1"></a>**The real value should be under 50% (see conclusion)**</span>
<span id="cb45-371"><a href="#cb45-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-374"><a href="#cb45-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-375"><a href="#cb45-375" aria-hidden="true" tabindex="-1"></a>df2_even <span class="ot">&lt;-</span> <span class="fu">SplitRandomR</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">1000</span>,<span class="dv">0</span>)</span>
<span id="cb45-376"><a href="#cb45-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-377"><a href="#cb45-377" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df2_even<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span id="cb45-378"><a href="#cb45-378" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-379"><a href="#cb45-379" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df2_even<span class="sc">$</span>Me,df2_even<span class="sc">$</span>Ms))<span class="sc">*</span><span class="fl">1.1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df2_even)))</span>
<span id="cb45-380"><a href="#cb45-380" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df2_even<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-381"><a href="#cb45-381" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-382"><a href="#cb45-382" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-383"><a href="#cb45-383" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-384"><a href="#cb45-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-385"><a href="#cb45-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-386"><a href="#cb45-386" aria-hidden="true" tabindex="-1"></a>after the second round, the mean value is still 1000, but the median is now lower!</span>
<span id="cb45-387"><a href="#cb45-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-390"><a href="#cb45-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-391"><a href="#cb45-391" aria-hidden="true" tabindex="-1"></a>df2_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Mean"</span><span class="ot">=</span><span class="fu">mean</span>(df2_even<span class="sc">$</span>Me),</span>
<span id="cb45-392"><a href="#cb45-392" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Median"</span><span class="ot">=</span><span class="fu">median</span>(df2_even<span class="sc">$</span>Me),</span>
<span id="cb45-393"><a href="#cb45-393" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"nAover1000"</span><span class="ot">=</span><span class="fu">nrow</span>(df2_even[df2_even<span class="sc">$</span>Me<span class="sc">&gt;</span><span class="dv">1000</span>,])) </span>
<span id="cb45-394"><a href="#cb45-394" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># number of Agents with more than 1000</span></span>
<span id="cb45-395"><a href="#cb45-395" aria-hidden="true" tabindex="-1"></a>df2_summary</span>
<span id="cb45-396"><a href="#cb45-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-397"><a href="#cb45-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-398"><a href="#cb45-398" aria-hidden="true" tabindex="-1"></a>in other words, meeting someone who has over 1000 is now even smaller for the next round.</span>
<span id="cb45-399"><a href="#cb45-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-400"><a href="#cb45-400" aria-hidden="true" tabindex="-1"></a><span class="fu">## Third Exchange</span></span>
<span id="cb45-401"><a href="#cb45-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-404"><a href="#cb45-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-405"><a href="#cb45-405" aria-hidden="true" tabindex="-1"></a>df3_even <span class="ot">&lt;-</span> <span class="fu">SplitRandomR</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1000</span>,<span class="dv">0</span>)</span>
<span id="cb45-406"><a href="#cb45-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-407"><a href="#cb45-407" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df3_even<span class="sc">$</span>Ms, <span class="at">xlab=</span><span class="st">"Money"</span>,<span class="at">main=</span><span class="st">"Histogram for split-random Restricted"</span>,</span>
<span id="cb45-408"><a href="#cb45-408" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-409"><a href="#cb45-409" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">c</span>(df3_even<span class="sc">$</span>Me,df3_even<span class="sc">$</span>Ms))<span class="sc">*</span><span class="fl">1.1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(df3_even)))</span>
<span id="cb45-410"><a href="#cb45-410" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df3_even<span class="sc">$</span>Me, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb45-411"><a href="#cb45-411" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-412"><a href="#cb45-412" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'Money befor'</span>, <span class="st">'Money after'</span>),</span>
<span id="cb45-413"><a href="#cb45-413" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)))</span>
<span id="cb45-414"><a href="#cb45-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-415"><a href="#cb45-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-416"><a href="#cb45-416" aria-hidden="true" tabindex="-1"></a>As assumed, the median is again smaller, as is the number of agents with more than 1000</span>
<span id="cb45-417"><a href="#cb45-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-420"><a href="#cb45-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-421"><a href="#cb45-421" aria-hidden="true" tabindex="-1"></a>df3_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Mean"</span><span class="ot">=</span><span class="fu">mean</span>(df3_even<span class="sc">$</span>Me),</span>
<span id="cb45-422"><a href="#cb45-422" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Median"</span><span class="ot">=</span><span class="fu">median</span>(df3_even<span class="sc">$</span>Me),</span>
<span id="cb45-423"><a href="#cb45-423" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"nAover1000"</span><span class="ot">=</span><span class="fu">nrow</span>(df3_even[df3_even<span class="sc">$</span>Me<span class="sc">&gt;</span><span class="dv">1000</span>,])) </span>
<span id="cb45-424"><a href="#cb45-424" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># number of Agents with more than 1000</span></span>
<span id="cb45-425"><a href="#cb45-425" aria-hidden="true" tabindex="-1"></a>df3_summary</span>
<span id="cb45-426"><a href="#cb45-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-427"><a href="#cb45-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-428"><a href="#cb45-428" aria-hidden="true" tabindex="-1"></a>from here on it seems clear that it tends towards the distribution with further steps</span>
<span id="cb45-429"><a href="#cb45-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-430"><a href="#cb45-430" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb45-431"><a href="#cb45-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-432"><a href="#cb45-432" aria-hidden="true" tabindex="-1"></a>I must have made something like a conjunction error here. the conditional probability for winning of 50% is only given if everyone has the same amount of money. Otherwise the chance of getting over the Median of the distribusion is always smaller (conjunction of two probability's), which means that there are more and more poor and only a few rich agents in this game.</span>
<span id="cb45-433"><a href="#cb45-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-434"><a href="#cb45-434" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computing the Probability</span></span>
<span id="cb45-435"><a href="#cb45-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-438"><a href="#cb45-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-439"><a href="#cb45-439" aria-hidden="true" tabindex="-1"></a>win_stab_prob <span class="ot">&lt;-</span> <span class="cf">function</span>( Moneyvec ) {</span>
<span id="cb45-440"><a href="#cb45-440" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Money=</span>Moneyvec,</span>
<span id="cb45-441"><a href="#cb45-441" aria-hidden="true" tabindex="-1"></a>                   <span class="at">winprobability=</span><span class="dv">0</span>)</span>
<span id="cb45-442"><a href="#cb45-442" aria-hidden="true" tabindex="-1"></a>  MMA <span class="ot">&lt;-</span> <span class="fu">median</span>(df[, <span class="dv">1</span>])</span>
<span id="cb45-443"><a href="#cb45-443" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)) {</span>
<span id="cb45-444"><a href="#cb45-444" aria-hidden="true" tabindex="-1"></a>    MA <span class="ot">&lt;-</span> df[i,<span class="dv">1</span>]</span>
<span id="cb45-445"><a href="#cb45-445" aria-hidden="true" tabindex="-1"></a>    MoA <span class="ot">&lt;-</span> df[<span class="fu">c</span>(<span class="sc">-</span>i),<span class="dv">1</span>]</span>
<span id="cb45-446"><a href="#cb45-446" aria-hidden="true" tabindex="-1"></a>    WP <span class="ot">&lt;-</span> MoA<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb45-447"><a href="#cb45-447" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(ii <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(MoA)) {</span>
<span id="cb45-448"><a href="#cb45-448" aria-hidden="true" tabindex="-1"></a>      Sum_M <span class="ot">&lt;-</span> MA <span class="sc">+</span> MoA[ii]</span>
<span id="cb45-449"><a href="#cb45-449" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (Sum_M <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb45-450"><a href="#cb45-450" aria-hidden="true" tabindex="-1"></a>        WP[ii] <span class="ot">&lt;-</span> <span class="fl">1.00</span></span>
<span id="cb45-451"><a href="#cb45-451" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb45-452"><a href="#cb45-452" aria-hidden="true" tabindex="-1"></a>        WP[ii] <span class="ot">&lt;-</span> WP[ii] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">min</span>(<span class="dv">1</span>, MMA<span class="sc">/</span>Sum_M)</span>
<span id="cb45-453"><a href="#cb45-453" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb45-454"><a href="#cb45-454" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-455"><a href="#cb45-455" aria-hidden="true" tabindex="-1"></a>    df[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(WP), <span class="at">digits =</span><span class="dv">3</span>)</span>
<span id="cb45-456"><a href="#cb45-456" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-457"><a href="#cb45-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb45-458"><a href="#cb45-458" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-459"><a href="#cb45-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-460"><a href="#cb45-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-461"><a href="#cb45-461" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing</span></span>
<span id="cb45-462"><a href="#cb45-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-463"><a href="#cb45-463" aria-hidden="true" tabindex="-1"></a>Before the first Exchange it should be 0.5 for all Agents</span>
<span id="cb45-464"><a href="#cb45-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-467"><a href="#cb45-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-468"><a href="#cb45-468" aria-hidden="true" tabindex="-1"></a>prob_start <span class="ot">&lt;-</span> <span class="fu">win_stab_prob</span>(df1_even<span class="sc">$</span>Ms)[, <span class="dv">2</span>]</span>
<span id="cb45-469"><a href="#cb45-469" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prob_start,</span>
<span id="cb45-470"><a href="#cb45-470" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb45-471"><a href="#cb45-471" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">5</span>,</span>
<span id="cb45-472"><a href="#cb45-472" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Getting over the Median"</span>,</span>
<span id="cb45-473"><a href="#cb45-473" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"ID"</span>,</span>
<span id="cb45-474"><a href="#cb45-474" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Probability"</span>,</span>
<span id="cb45-475"><a href="#cb45-475" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb45-476"><a href="#cb45-476" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),)</span>
<span id="cb45-477"><a href="#cb45-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-478"><a href="#cb45-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-479"><a href="#cb45-479" aria-hidden="true" tabindex="-1"></a>after that first round it depends from the Money of the Agent.</span>
<span id="cb45-480"><a href="#cb45-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-483"><a href="#cb45-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-484"><a href="#cb45-484" aria-hidden="true" tabindex="-1"></a>prob_after1 <span class="ot">&lt;-</span> <span class="fu">win_stab_prob</span>(df1_even<span class="sc">$</span>Me)</span>
<span id="cb45-485"><a href="#cb45-485" aria-hidden="true" tabindex="-1"></a>prob_after1 <span class="ot">&lt;-</span> prob_after1[<span class="fu">order</span>(prob_after1<span class="sc">$</span>Money, <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb45-486"><a href="#cb45-486" aria-hidden="true" tabindex="-1"></a>popMean <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob_after1[, <span class="dv">2</span>])</span>
<span id="cb45-487"><a href="#cb45-487" aria-hidden="true" tabindex="-1"></a>Money_Med <span class="ot">&lt;-</span> <span class="fu">median</span>(prob_after1[, <span class="dv">1</span>])</span>
<span id="cb45-488"><a href="#cb45-488" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prob_after1,</span>
<span id="cb45-489"><a href="#cb45-489" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">5</span>,</span>
<span id="cb45-490"><a href="#cb45-490" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">c</span>(<span class="st">"Populationmean"</span>, popMean),</span>
<span id="cb45-491"><a href="#cb45-491" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Money"</span>,</span>
<span id="cb45-492"><a href="#cb45-492" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Probability"</span>,</span>
<span id="cb45-493"><a href="#cb45-493" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb45-494"><a href="#cb45-494" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb45-495"><a href="#cb45-495" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">h=</span>popMean,</span>
<span id="cb45-496"><a href="#cb45-496" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-497"><a href="#cb45-497" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">v=</span>Money_Med,</span>
<span id="cb45-498"><a href="#cb45-498" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-499"><a href="#cb45-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-500"><a href="#cb45-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-501"><a href="#cb45-501" aria-hidden="true" tabindex="-1"></a>after the second round</span>
<span id="cb45-502"><a href="#cb45-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-505"><a href="#cb45-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-506"><a href="#cb45-506" aria-hidden="true" tabindex="-1"></a>prob_after2 <span class="ot">&lt;-</span> <span class="fu">win_stab_prob</span>(df2_even<span class="sc">$</span>Me)</span>
<span id="cb45-507"><a href="#cb45-507" aria-hidden="true" tabindex="-1"></a>prob_after2 <span class="ot">&lt;-</span> prob_after2[<span class="fu">order</span>(prob_after2<span class="sc">$</span>Money, <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb45-508"><a href="#cb45-508" aria-hidden="true" tabindex="-1"></a>popMean <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob_after2[, <span class="dv">2</span>])</span>
<span id="cb45-509"><a href="#cb45-509" aria-hidden="true" tabindex="-1"></a>Money_Med <span class="ot">&lt;-</span> <span class="fu">median</span>(prob_after2[, <span class="dv">1</span>])</span>
<span id="cb45-510"><a href="#cb45-510" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prob_after2,</span>
<span id="cb45-511"><a href="#cb45-511" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">5</span>,</span>
<span id="cb45-512"><a href="#cb45-512" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">c</span>(<span class="st">"Populationmean"</span>, popMean),</span>
<span id="cb45-513"><a href="#cb45-513" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Money"</span>,</span>
<span id="cb45-514"><a href="#cb45-514" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Probability"</span>,</span>
<span id="cb45-515"><a href="#cb45-515" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb45-516"><a href="#cb45-516" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb45-517"><a href="#cb45-517" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">h=</span>popMean,</span>
<span id="cb45-518"><a href="#cb45-518" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-519"><a href="#cb45-519" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">v=</span>Money_Med,</span>
<span id="cb45-520"><a href="#cb45-520" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-521"><a href="#cb45-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-522"><a href="#cb45-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-523"><a href="#cb45-523" aria-hidden="true" tabindex="-1"></a>... third</span>
<span id="cb45-524"><a href="#cb45-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-527"><a href="#cb45-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-528"><a href="#cb45-528" aria-hidden="true" tabindex="-1"></a>prob_after3 <span class="ot">&lt;-</span> <span class="fu">win_stab_prob</span>(df3_even<span class="sc">$</span>Me)</span>
<span id="cb45-529"><a href="#cb45-529" aria-hidden="true" tabindex="-1"></a>prob_after3 <span class="ot">&lt;-</span> prob_after3[<span class="fu">order</span>(prob_after3<span class="sc">$</span>Money, <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb45-530"><a href="#cb45-530" aria-hidden="true" tabindex="-1"></a>popMean <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob_after3[, <span class="dv">2</span>])</span>
<span id="cb45-531"><a href="#cb45-531" aria-hidden="true" tabindex="-1"></a>Money_Med <span class="ot">&lt;-</span> <span class="fu">median</span>(prob_after3[, <span class="dv">1</span>])</span>
<span id="cb45-532"><a href="#cb45-532" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prob_after3,</span>
<span id="cb45-533"><a href="#cb45-533" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">5</span>,</span>
<span id="cb45-534"><a href="#cb45-534" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">c</span>(<span class="st">"Populationmean"</span>, popMean),</span>
<span id="cb45-535"><a href="#cb45-535" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Money"</span>,</span>
<span id="cb45-536"><a href="#cb45-536" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Probability"</span>,</span>
<span id="cb45-537"><a href="#cb45-537" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb45-538"><a href="#cb45-538" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb45-539"><a href="#cb45-539" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">h=</span>popMean,</span>
<span id="cb45-540"><a href="#cb45-540" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-541"><a href="#cb45-541" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">v=</span>Money_Med,</span>
<span id="cb45-542"><a href="#cb45-542" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-543"><a href="#cb45-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-544"><a href="#cb45-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-545"><a href="#cb45-545" aria-hidden="true" tabindex="-1"></a>...15th</span>
<span id="cb45-546"><a href="#cb45-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-549"><a href="#cb45-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-550"><a href="#cb45-550" aria-hidden="true" tabindex="-1"></a>df15_even <span class="ot">&lt;-</span> <span class="fu">SplitRandomR</span>(<span class="dv">1000</span>,<span class="dv">15</span>,<span class="dv">1000</span>,<span class="dv">0</span>)</span>
<span id="cb45-551"><a href="#cb45-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-552"><a href="#cb45-552" aria-hidden="true" tabindex="-1"></a>prob_after15 <span class="ot">&lt;-</span> <span class="fu">win_stab_prob</span>(df15_even<span class="sc">$</span>Me)</span>
<span id="cb45-553"><a href="#cb45-553" aria-hidden="true" tabindex="-1"></a>prob_after15 <span class="ot">&lt;-</span> prob_after15[<span class="fu">order</span>(prob_after15<span class="sc">$</span>Money, <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb45-554"><a href="#cb45-554" aria-hidden="true" tabindex="-1"></a>popMean <span class="ot">&lt;-</span> <span class="fu">mean</span>(prob_after15[, <span class="dv">2</span>])</span>
<span id="cb45-555"><a href="#cb45-555" aria-hidden="true" tabindex="-1"></a>Money_Med <span class="ot">&lt;-</span> <span class="fu">median</span>(prob_after15[, <span class="dv">1</span>])</span>
<span id="cb45-556"><a href="#cb45-556" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prob_after15,</span>
<span id="cb45-557"><a href="#cb45-557" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">5</span>,</span>
<span id="cb45-558"><a href="#cb45-558" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">c</span>(<span class="st">"Populationmean"</span>, popMean),</span>
<span id="cb45-559"><a href="#cb45-559" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Money"</span>,</span>
<span id="cb45-560"><a href="#cb45-560" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Probability"</span>,</span>
<span id="cb45-561"><a href="#cb45-561" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb45-562"><a href="#cb45-562" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb45-563"><a href="#cb45-563" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">h=</span>popMean,</span>
<span id="cb45-564"><a href="#cb45-564" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-565"><a href="#cb45-565" aria-hidden="true" tabindex="-1"></a>     <span class="fu">abline</span>(<span class="at">v=</span>Money_Med,</span>
<span id="cb45-566"><a href="#cb45-566" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-567"><a href="#cb45-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>